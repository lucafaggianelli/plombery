import{j as hz}from"./index-6c284eea.js";import{ak as vS,a9 as Yt,al as iL,am as dz}from"./vendor-ccd85f8c.js";var cv=function(e){return e&&e.Math==Math&&e},gt=cv(typeof globalThis=="object"&&globalThis)||cv(typeof window=="object"&&window)||cv(typeof self=="object"&&self)||cv(typeof vS=="object"&&vS)||function(){return this}()||Function("return this")(),xn={},je=function(e){try{return!!e()}catch{return!0}},vz=je,Bt=!vz(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),yz=je,wd=!yz(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),pz=wd,hv=Function.prototype.call,Gt=pz?hv.bind(hv):function(){return hv.apply(hv,arguments)},Sd={},aL={}.propertyIsEnumerable,lL=Object.getOwnPropertyDescriptor,mz=lL&&!aL.call({1:2},1);Sd.f=mz?function(t){var r=lL(this,t);return!!r&&r.enumerable}:aL;var Cd=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},sL=wd,uL=Function.prototype,yS=uL.call,gz=sL&&uL.bind.bind(yS,yS),Be=sL?gz:function(e){return function(){return yS.apply(e,arguments)}},fL=Be,bz=fL({}.toString),wz=fL("".slice),Dn=function(e){return wz(bz(e),8,-1)},Sz=Be,Cz=je,_z=Dn,Fg=Object,Oz=Sz("".split),_d=Cz(function(){return!Fg("z").propertyIsEnumerable(0)})?function(e){return _z(e)=="String"?Oz(e,""):Fg(e)}:Fg,dn=function(e){return e==null},Rz=dn,Ez=TypeError,Rr=function(e){if(Rz(e))throw Ez("Can't call method on "+e);return e},Pz=_d,Tz=Rr,Nr=function(e){return Pz(Tz(e))},pS=typeof document=="object"&&document.all,kz=typeof pS>"u"&&pS!==void 0,cL={all:pS,IS_HTMLDDA:kz},hL=cL,$z=hL.all,_t=hL.IS_HTMLDDA?function(e){return typeof e=="function"||e===$z}:function(e){return typeof e=="function"},nT=_t,dL=cL,Az=dL.all,Ft=dL.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:nT(e)||e===Az}:function(e){return typeof e=="object"?e!==null:nT(e)},Vg=gt,Iz=_t,Mz=function(e){return Iz(e)?e:void 0},xo=function(e,t){return arguments.length<2?Mz(Vg[e]):Vg[e]&&Vg[e][t]},xz=Be,bi=xz({}.isPrototypeOf),Ha=typeof navigator<"u"&&String(navigator.userAgent)||"",vL=gt,Wg=Ha,oT=vL.process,iT=vL.Deno,aT=oT&&oT.versions||iT&&iT.version,lT=aT&&aT.v8,an,op;lT&&(an=lT.split("."),op=an[0]>0&&an[0]<4?1:+(an[0]+an[1]));!op&&Wg&&(an=Wg.match(/Edge\/(\d+)/),(!an||an[1]>=74)&&(an=Wg.match(/Chrome\/(\d+)/),an&&(op=+an[1])));var Od=op,sT=Od,Dz=je,Qu=!!Object.getOwnPropertySymbols&&!Dz(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&sT&&sT<41}),Nz=Qu,yL=Nz&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Hz=xo,Lz=_t,jz=bi,Bz=yL,Fz=Object,Rd=Bz?function(e){return typeof e=="symbol"}:function(e){var t=Hz("Symbol");return Lz(t)&&jz(t.prototype,Fz(e))},Vz=String,Ju=function(e){try{return Vz(e)}catch{return"Object"}},Wz=_t,Uz=Ju,zz=TypeError,La=function(e){if(Wz(e))return e;throw zz(Uz(e)+" is not a function")},Gz=La,Yz=dn,ja=function(e,t){var r=e[t];return Yz(r)?void 0:Gz(r)},Ug=Gt,zg=_t,Gg=Ft,Kz=TypeError,pL=function(e,t){var r,n;if(t==="string"&&zg(r=e.toString)&&!Gg(n=Ug(r,e))||zg(r=e.valueOf)&&!Gg(n=Ug(r,e))||t!=="string"&&zg(r=e.toString)&&!Gg(n=Ug(r,e)))return n;throw Kz("Can't convert object to primitive value")},pi={},qz={get exports(){return pi},set exports(e){pi=e}},Xz=!1,uT=gt,Zz=Object.defineProperty,cR=function(e,t){try{Zz(uT,e,{value:t,configurable:!0,writable:!0})}catch{uT[e]=t}return t},Qz=gt,Jz=cR,fT="__core-js_shared__",eG=Qz[fT]||Jz(fT,{}),hR=eG,cT=hR;(qz.exports=function(e,t){return cT[e]||(cT[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.29.1",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.1/LICENSE",source:"https://github.com/zloirock/core-js"});var tG=Rr,rG=Object,Er=function(e){return rG(tG(e))},nG=Be,oG=Er,iG=nG({}.hasOwnProperty),$t=Object.hasOwn||function(t,r){return iG(oG(t),r)},aG=Be,lG=0,sG=Math.random(),uG=aG(1 .toString),Cm=function(e){return"Symbol("+(e===void 0?"":e)+")_"+uG(++lG+sG,36)},fG=gt,cG=pi,hT=$t,hG=Cm,dG=Qu,vG=yL,kl=fG.Symbol,Yg=cG("wks"),yG=vG?kl.for||kl:kl&&kl.withoutSetter||hG,St=function(e){return hT(Yg,e)||(Yg[e]=dG&&hT(kl,e)?kl[e]:yG("Symbol."+e)),Yg[e]},pG=Gt,dT=Ft,vT=Rd,mG=ja,gG=pL,bG=St,wG=TypeError,SG=bG("toPrimitive"),mL=function(e,t){if(!dT(e)||vT(e))return e;var r=mG(e,SG),n;if(r){if(t===void 0&&(t="default"),n=pG(r,e,t),!dT(n)||vT(n))return n;throw wG("Can't convert object to primitive value")}return t===void 0&&(t="number"),gG(e,t)},CG=mL,_G=Rd,_m=function(e){var t=CG(e,"string");return _G(t)?t:t+""},OG=gt,yT=Ft,mS=OG.document,RG=yT(mS)&&yT(mS.createElement),Om=function(e){return RG?mS.createElement(e):{}},EG=Bt,PG=je,TG=Om,gL=!EG&&!PG(function(){return Object.defineProperty(TG("div"),"a",{get:function(){return 7}}).a!=7}),kG=Bt,$G=Gt,AG=Sd,IG=Cd,MG=Nr,xG=_m,DG=$t,NG=gL,pT=Object.getOwnPropertyDescriptor;xn.f=kG?pT:function(t,r){if(t=MG(t),r=xG(r),NG)try{return pT(t,r)}catch{}if(DG(t,r))return IG(!$G(AG.f,t,r),t[r])};var mr={},HG=Bt,LG=je,bL=HG&&LG(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),jG=Ft,BG=String,FG=TypeError,Dt=function(e){if(jG(e))return e;throw FG(BG(e)+" is not an object")},VG=Bt,WG=gL,UG=bL,dv=Dt,mT=_m,zG=TypeError,Kg=Object.defineProperty,GG=Object.getOwnPropertyDescriptor,qg="enumerable",Xg="configurable",Zg="writable";mr.f=VG?UG?function(t,r,n){if(dv(t),r=mT(r),dv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Zg in n&&!n[Zg]){var o=GG(t,r);o&&o[Zg]&&(t[r]=n.value,n={configurable:Xg in n?n[Xg]:o[Xg],enumerable:qg in n?n[qg]:o[qg],writable:!1})}return Kg(t,r,n)}:Kg:function(t,r,n){if(dv(t),r=mT(r),dv(n),WG)try{return Kg(t,r,n)}catch{}if("get"in n||"set"in n)throw zG("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var YG=Bt,KG=mr,qG=Cd,Ba=YG?function(e,t,r){return KG.f(e,t,qG(1,r))}:function(e,t,r){return e[t]=r,e},ip={},XG={get exports(){return ip},set exports(e){ip=e}},gS=Bt,ZG=$t,wL=Function.prototype,QG=gS&&Object.getOwnPropertyDescriptor,dR=ZG(wL,"name"),JG=dR&&function(){}.name==="something",eY=dR&&(!gS||gS&&QG(wL,"name").configurable),Ed={EXISTS:dR,PROPER:JG,CONFIGURABLE:eY},tY=Be,rY=_t,bS=hR,nY=tY(Function.toString);rY(bS.inspectSource)||(bS.inspectSource=function(e){return nY(e)});var SL=bS.inspectSource,oY=gt,iY=_t,gT=oY.WeakMap,CL=iY(gT)&&/native code/.test(String(gT)),aY=pi,lY=Cm,bT=aY("keys"),Rm=function(e){return bT[e]||(bT[e]=lY(e))},Pd={},sY=CL,_L=gt,uY=Ft,fY=Ba,Qg=$t,Jg=hR,cY=Rm,hY=Pd,wT="Object already initialized",wS=_L.TypeError,dY=_L.WeakMap,ap,fc,lp,vY=function(e){return lp(e)?fc(e):ap(e,{})},yY=function(e){return function(t){var r;if(!uY(t)||(r=fc(t)).type!==e)throw wS("Incompatible receiver, "+e+" required");return r}};if(sY||Jg.state){var yn=Jg.state||(Jg.state=new dY);yn.get=yn.get,yn.has=yn.has,yn.set=yn.set,ap=function(e,t){if(yn.has(e))throw wS(wT);return t.facade=e,yn.set(e,t),t},fc=function(e){return yn.get(e)||{}},lp=function(e){return yn.has(e)}}else{var qa=cY("state");hY[qa]=!0,ap=function(e,t){if(Qg(e,qa))throw wS(wT);return t.facade=e,fY(e,qa,t),t},fc=function(e){return Qg(e,qa)?e[qa]:{}},lp=function(e){return Qg(e,qa)}}var Do={set:ap,get:fc,has:lp,enforce:vY,getterFor:yY},vR=Be,pY=je,mY=_t,vv=$t,SS=Bt,gY=Ed.CONFIGURABLE,bY=SL,OL=Do,wY=OL.enforce,SY=OL.get,ST=String,my=Object.defineProperty,CY=vR("".slice),_Y=vR("".replace),OY=vR([].join),RY=SS&&!pY(function(){return my(function(){},"length",{value:8}).length!==8}),EY=String(String).split("String"),PY=XG.exports=function(e,t,r){CY(ST(t),0,7)==="Symbol("&&(t="["+_Y(ST(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!vv(e,"name")||gY&&e.name!==t)&&(SS?my(e,"name",{value:t,configurable:!0}):e.name=t),RY&&r&&vv(r,"arity")&&e.length!==r.arity&&my(e,"length",{value:r.arity});try{r&&vv(r,"constructor")&&r.constructor?SS&&my(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=wY(e);return vv(n,"source")||(n.source=OY(EY,typeof t=="string"?t:"")),e};Function.prototype.toString=PY(function(){return mY(this)&&SY(this).source||bY(this)},"toString");var TY=_t,kY=mr,$Y=ip,AY=cR,qr=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(TY(r)&&$Y(r,i,n),n.global)o?e[t]=r:AY(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:kY.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Fa={},IY=Math.ceil,MY=Math.floor,xY=Math.trunc||function(t){var r=+t;return(r>0?MY:IY)(r)},DY=xY,wi=function(e){var t=+e;return t!==t||t===0?0:DY(t)},NY=wi,HY=Math.max,LY=Math.min,Td=function(e,t){var r=NY(e);return r<0?HY(r+t,0):LY(r,t)},jY=wi,BY=Math.min,Va=function(e){return e>0?BY(jY(e),9007199254740991):0},FY=Va,Xr=function(e){return FY(e.length)},VY=Nr,WY=Td,UY=Xr,CT=function(e){return function(t,r,n){var o=VY(t),i=UY(o),a=WY(n,i),l;if(e&&r!=r){for(;i>a;)if(l=o[a++],l!=l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},yR={includes:CT(!0),indexOf:CT(!1)},zY=Be,eb=$t,GY=Nr,YY=yR.indexOf,KY=Pd,_T=zY([].push),RL=function(e,t){var r=GY(e),n=0,o=[],i;for(i in r)!eb(KY,i)&&eb(r,i)&&_T(o,i);for(;t.length>n;)eb(r,i=t[n++])&&(~YY(o,i)||_T(o,i));return o},pR=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],qY=RL,XY=pR,ZY=XY.concat("length","prototype");Fa.f=Object.getOwnPropertyNames||function(t){return qY(t,ZY)};var kd={};kd.f=Object.getOwnPropertySymbols;var QY=xo,JY=Be,e3=Fa,t3=kd,r3=Dt,n3=JY([].concat),EL=QY("Reflect","ownKeys")||function(t){var r=e3.f(r3(t)),n=t3.f;return n?n3(r,n(t)):r},OT=$t,o3=EL,i3=xn,a3=mr,PL=function(e,t,r){for(var n=o3(t),o=a3.f,i=i3.f,a=0;a<n.length;a++){var l=n[a];!OT(e,l)&&!(r&&OT(r,l))&&o(e,l,i(t,l))}},l3=je,s3=_t,u3=/#|\.prototype\./,$d=function(e,t){var r=c3[f3(e)];return r==d3?!0:r==h3?!1:s3(t)?l3(t):!!t},f3=$d.normalize=function(e){return String(e).replace(u3,".").toLowerCase()},c3=$d.data={},h3=$d.NATIVE="N",d3=$d.POLYFILL="P",Em=$d,tb=gt,v3=xn.f,y3=Ba,p3=qr,m3=cR,g3=PL,b3=Em,Ae=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=tb:o?a=tb[r]||m3(r,{}):a=(tb[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=v3(a,l),s=f&&f.value):s=a[l],i=b3(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;g3(u,s)}(e.sham||s&&s.sham)&&y3(u,"sham",!0),p3(a,l,u,e)}},w3=St,S3=w3("toStringTag"),TL={};TL[S3]="z";var mR=String(TL)==="[object z]",C3=mR,_3=_t,gy=Dn,O3=St,R3=O3("toStringTag"),E3=Object,P3=gy(function(){return arguments}())=="Arguments",T3=function(e,t){try{return e[t]}catch{}},Pm=C3?gy:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=T3(t=E3(e),R3))=="string"?r:P3?gy(t):(n=gy(t))=="Object"&&_3(t.callee)?"Arguments":n},k3=Pm,$3=String,Vt=function(e){if(k3(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return $3(e)},gR={},A3=RL,I3=pR,Ad=Object.keys||function(t){return A3(t,I3)},M3=Bt,x3=bL,D3=mr,N3=Dt,H3=Nr,L3=Ad;gR.f=M3&&!x3?Object.defineProperties:function(t,r){N3(t);for(var n=H3(r),o=L3(r),i=o.length,a=0,l;i>a;)D3.f(t,l=o[a++],n[l]);return t};var j3=xo,kL=j3("document","documentElement"),B3=Dt,F3=gR,RT=pR,V3=Pd,W3=kL,U3=Om,z3=Rm,ET=">",PT="<",CS="prototype",_S="script",$L=z3("IE_PROTO"),rb=function(){},AL=function(e){return PT+_S+ET+e+PT+"/"+_S+ET},TT=function(e){e.write(AL("")),e.close();var t=e.parentWindow.Object;return e=null,t},G3=function(){var e=U3("iframe"),t="java"+_S+":",r;return e.style.display="none",W3.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(AL("document.F=Object")),r.close(),r.F},yv,by=function(){try{yv=new ActiveXObject("htmlfile")}catch{}by=typeof document<"u"?document.domain&&yv?TT(yv):G3():TT(yv);for(var e=RT.length;e--;)delete by[CS][RT[e]];return by()};V3[$L]=!0;var ef=Object.create||function(t,r){var n;return t!==null?(rb[CS]=B3(t),n=new rb,rb[CS]=null,n[$L]=t):n=by(),r===void 0?n:F3.f(n,r)},bR={},Y3=_m,K3=mr,q3=Cd,tf=function(e,t,r){var n=Y3(t);n in e?K3.f(e,n,q3(0,r)):e[n]=r},kT=Td,X3=Xr,Z3=tf,Q3=Array,J3=Math.max,wR=function(e,t,r){for(var n=X3(e),o=kT(t,n),i=kT(r===void 0?n:r,n),a=Q3(J3(i-o,0)),l=0;o<i;o++,l++)Z3(a,l,e[o]);return a.length=l,a},eK=Dn,tK=Nr,IL=Fa.f,rK=wR,ML=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],nK=function(e){try{return IL(e)}catch{return rK(ML)}};bR.f=function(t){return ML&&eK(t)=="Window"?nK(t):IL(tK(t))};var $T=ip,oK=mr,Id=function(e,t,r){return r.get&&$T(r.get,t,{getter:!0}),r.set&&$T(r.set,t,{setter:!0}),oK.f(e,t,r)},SR={},iK=St;SR.f=iK;var aK=gt,xL=aK,AT=xL,lK=$t,sK=SR,uK=mr.f,CR=function(e){var t=AT.Symbol||(AT.Symbol={});lK(t,e)||uK(t,e,{value:sK.f(e)})},fK=Gt,cK=xo,hK=St,dK=qr,DL=function(){var e=cK("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=hK("toPrimitive");t&&!t[n]&&dK(t,n,function(o){return fK(r,this)},{arity:1})},vK=mr.f,yK=$t,pK=St,IT=pK("toStringTag"),Tm=function(e,t,r){e&&!r&&(e=e.prototype),e&&!yK(e,IT)&&vK(e,IT,{configurable:!0,value:t})},mK=Dn,gK=Be,Md=function(e){if(mK(e)==="Function")return gK(e)},MT=Md,bK=La,wK=wd,SK=MT(MT.bind),xd=function(e,t){return bK(e),t===void 0?e:wK?SK(e,t):function(){return e.apply(t,arguments)}},CK=Dn,rf=Array.isArray||function(t){return CK(t)=="Array"},_K=Be,OK=je,NL=_t,RK=Pm,EK=xo,PK=SL,HL=function(){},TK=[],LL=EK("Reflect","construct"),_R=/^\s*(?:class|function)\b/,kK=_K(_R.exec),$K=!_R.exec(HL),df=function(t){if(!NL(t))return!1;try{return LL(HL,TK,t),!0}catch{return!1}},jL=function(t){if(!NL(t))return!1;switch(RK(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return $K||!!kK(_R,PK(t))}catch{return!0}};jL.sham=!0;var km=!LL||OK(function(){var e;return df(df.call)||!df(Object)||!df(function(){e=!0})||e})?jL:df,xT=rf,AK=km,IK=Ft,MK=St,xK=MK("species"),DT=Array,DK=function(e){var t;return xT(e)&&(t=e.constructor,AK(t)&&(t===DT||xT(t.prototype))?t=void 0:IK(t)&&(t=t[xK],t===null&&(t=void 0))),t===void 0?DT:t},NK=DK,OR=function(e,t){return new(NK(e))(t===0?0:t)},HK=xd,LK=Be,jK=_d,BK=Er,FK=Xr,VK=OR,NT=LK([].push),Bo=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,l=e==5||i;return function(s,u,f,c){for(var h=BK(s),d=jK(h),v=HK(u,f),p=FK(d),g=0,w=c||VK,S=t?w(s,p):r||a?w(s,0):void 0,_,T;p>g;g++)if((l||g in d)&&(_=d[g],T=v(_,g,h),e))if(t)S[g]=T;else if(T)switch(e){case 3:return!0;case 5:return _;case 6:return g;case 2:NT(S,_)}else switch(e){case 4:return!1;case 7:NT(S,_)}return i?-1:n||o?o:S}},Wa={forEach:Bo(0),map:Bo(1),filter:Bo(2),some:Bo(3),every:Bo(4),find:Bo(5),findIndex:Bo(6),filterReject:Bo(7)},$m=Ae,RR=gt,ER=Gt,WK=Be,Yl=Bt,Kl=Qu,UK=je,Qt=$t,zK=bi,OS=Dt,Am=Nr,PR=_m,GK=Vt,RS=Cd,cc=ef,BL=Ad,YK=Fa,FL=bR,KK=kd,VL=xn,WL=mr,qK=gR,UL=Sd,nb=qr,XK=Id,TR=pi,ZK=Rm,zL=Pd,HT=Cm,QK=St,JK=SR,e4=CR,t4=DL,r4=Tm,GL=Do,Im=Wa.forEach,_r=ZK("hidden"),Mm="Symbol",hc="prototype",n4=GL.set,LT=GL.getterFor(Mm),zr=Object[hc],ga=RR.Symbol,Wf=ga&&ga[hc],o4=RR.TypeError,ob=RR.QObject,YL=VL.f,Wi=WL.f,KL=FL.f,i4=UL.f,qL=WK([].push),To=TR("symbols"),Dd=TR("op-symbols"),a4=TR("wks"),ES=!ob||!ob[hc]||!ob[hc].findChild,PS=Yl&&UK(function(){return cc(Wi({},"a",{get:function(){return Wi(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=YL(zr,t);n&&delete zr[t],Wi(e,t,r),n&&e!==zr&&Wi(zr,t,n)}:Wi,ib=function(e,t){var r=To[e]=cc(Wf);return n4(r,{type:Mm,tag:e,description:t}),Yl||(r.description=t),r},xm=function(t,r,n){t===zr&&xm(Dd,r,n),OS(t);var o=PR(r);return OS(n),Qt(To,o)?(n.enumerable?(Qt(t,_r)&&t[_r][o]&&(t[_r][o]=!1),n=cc(n,{enumerable:RS(0,!1)})):(Qt(t,_r)||Wi(t,_r,RS(1,{})),t[_r][o]=!0),PS(t,o,n)):Wi(t,o,n)},kR=function(t,r){OS(t);var n=Am(r),o=BL(n).concat(QL(n));return Im(o,function(i){(!Yl||ER(TS,n,i))&&xm(t,i,n[i])}),t},l4=function(t,r){return r===void 0?cc(t):kR(cc(t),r)},TS=function(t){var r=PR(t),n=ER(i4,this,r);return this===zr&&Qt(To,r)&&!Qt(Dd,r)?!1:n||!Qt(this,r)||!Qt(To,r)||Qt(this,_r)&&this[_r][r]?n:!0},XL=function(t,r){var n=Am(t),o=PR(r);if(!(n===zr&&Qt(To,o)&&!Qt(Dd,o))){var i=YL(n,o);return i&&Qt(To,o)&&!(Qt(n,_r)&&n[_r][o])&&(i.enumerable=!0),i}},ZL=function(t){var r=KL(Am(t)),n=[];return Im(r,function(o){!Qt(To,o)&&!Qt(zL,o)&&qL(n,o)}),n},QL=function(e){var t=e===zr,r=KL(t?Dd:Am(e)),n=[];return Im(r,function(o){Qt(To,o)&&(!t||Qt(zr,o))&&qL(n,To[o])}),n};Kl||(ga=function(){if(zK(Wf,this))throw o4("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:GK(arguments[0]),r=HT(t),n=function(o){this===zr&&ER(n,Dd,o),Qt(this,_r)&&Qt(this[_r],r)&&(this[_r][r]=!1),PS(this,r,RS(1,o))};return Yl&&ES&&PS(zr,r,{configurable:!0,set:n}),ib(r,t)},Wf=ga[hc],nb(Wf,"toString",function(){return LT(this).tag}),nb(ga,"withoutSetter",function(e){return ib(HT(e),e)}),UL.f=TS,WL.f=xm,qK.f=kR,VL.f=XL,YK.f=FL.f=ZL,KK.f=QL,JK.f=function(e){return ib(QK(e),e)},Yl&&(XK(Wf,"description",{configurable:!0,get:function(){return LT(this).description}}),nb(zr,"propertyIsEnumerable",TS,{unsafe:!0})));$m({global:!0,constructor:!0,wrap:!0,forced:!Kl,sham:!Kl},{Symbol:ga});Im(BL(a4),function(e){e4(e)});$m({target:Mm,stat:!0,forced:!Kl},{useSetter:function(){ES=!0},useSimple:function(){ES=!1}});$m({target:"Object",stat:!0,forced:!Kl,sham:!Yl},{create:l4,defineProperty:xm,defineProperties:kR,getOwnPropertyDescriptor:XL});$m({target:"Object",stat:!0,forced:!Kl},{getOwnPropertyNames:ZL});t4();r4(ga,Mm);zL[_r]=!0;var s4=Qu,JL=s4&&!!Symbol.for&&!!Symbol.keyFor,u4=Ae,f4=xo,c4=$t,h4=Vt,ej=pi,d4=JL,ab=ej("string-to-symbol-registry"),v4=ej("symbol-to-string-registry");u4({target:"Symbol",stat:!0,forced:!d4},{for:function(e){var t=h4(e);if(c4(ab,t))return ab[t];var r=f4("Symbol")(t);return ab[t]=r,v4[r]=t,r}});var y4=Ae,p4=$t,m4=Rd,g4=Ju,b4=pi,w4=JL,jT=b4("symbol-to-string-registry");y4({target:"Symbol",stat:!0,forced:!w4},{keyFor:function(t){if(!m4(t))throw TypeError(g4(t)+" is not a symbol");if(p4(jT,t))return jT[t]}});var S4=wd,tj=Function.prototype,BT=tj.apply,FT=tj.call,Ua=typeof Reflect=="object"&&Reflect.apply||(S4?FT.bind(BT):function(){return FT.apply(BT,arguments)}),C4=Be,Nd=C4([].slice),_4=Be,VT=rf,O4=_t,WT=Dn,R4=Vt,UT=_4([].push),E4=function(e){if(O4(e))return e;if(VT(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?UT(r,o):(typeof o=="number"||WT(o)=="Number"||WT(o)=="String")&&UT(r,R4(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(VT(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},P4=Ae,rj=xo,nj=Ua,T4=Gt,Hd=Be,oj=je,zT=_t,GT=Rd,ij=Nd,k4=E4,$4=Qu,A4=String,ri=rj("JSON","stringify"),pv=Hd(/./.exec),YT=Hd("".charAt),I4=Hd("".charCodeAt),M4=Hd("".replace),x4=Hd(1 .toString),D4=/[\uD800-\uDFFF]/g,KT=/^[\uD800-\uDBFF]$/,qT=/^[\uDC00-\uDFFF]$/,XT=!$4||oj(function(){var e=rj("Symbol")();return ri([e])!="[null]"||ri({a:e})!="{}"||ri(Object(e))!="{}"}),ZT=oj(function(){return ri("\uDF06\uD834")!=='"\\udf06\\ud834"'||ri("\uDEAD")!=='"\\udead"'}),N4=function(e,t){var r=ij(arguments),n=k4(t);if(!(!zT(n)&&(e===void 0||GT(e))))return r[1]=function(o,i){if(zT(n)&&(i=T4(n,this,A4(o),i)),!GT(i))return i},nj(ri,null,r)},H4=function(e,t,r){var n=YT(r,t-1),o=YT(r,t+1);return pv(KT,e)&&!pv(qT,o)||pv(qT,e)&&!pv(KT,n)?"\\u"+x4(I4(e,0),16):e};ri&&P4({target:"JSON",stat:!0,arity:3,forced:XT||ZT},{stringify:function(t,r,n){var o=ij(arguments),i=nj(XT?N4:ri,null,o);return ZT&&typeof i=="string"?M4(i,D4,H4):i}});var L4=Ae,j4=Qu,B4=je,aj=kd,F4=Er,V4=!j4||B4(function(){aj.f(1)});L4({target:"Object",stat:!0,forced:V4},{getOwnPropertySymbols:function(t){var r=aj.f;return r?r(F4(t)):[]}});var W4=Ae,U4=Bt,z4=gt,mv=Be,G4=$t,Y4=_t,K4=bi,q4=Vt,X4=Id,Z4=PL,Kn=z4.Symbol,Ri=Kn&&Kn.prototype;if(U4&&Y4(Kn)&&(!("description"in Ri)||Kn().description!==void 0)){var QT={},gv=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:q4(arguments[0]),r=K4(Ri,this)?new Kn(t):t===void 0?Kn():Kn(t);return t===""&&(QT[r]=!0),r};Z4(gv,Kn),gv.prototype=Ri,Ri.constructor=gv;var Q4=String(Kn("test"))=="Symbol(test)",J4=mv(Ri.valueOf),e6=mv(Ri.toString),t6=/^Symbol\((.*)\)[^)]+$/,r6=mv("".replace),n6=mv("".slice);X4(Ri,"description",{configurable:!0,get:function(){var t=J4(this);if(G4(QT,t))return"";var r=e6(t),n=Q4?n6(r,7,-1):r6(r,t6,"$1");return n===""?void 0:n}}),W4({global:!0,constructor:!0,forced:!0},{Symbol:gv})}var o6=CR;o6("iterator");var i6=Bt,a6=Ed.EXISTS,lj=Be,l6=Id,sj=Function.prototype,s6=lj(sj.toString),uj=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u6=lj(uj.exec),f6="name";i6&&!a6&&l6(sj,f6,{configurable:!0,get:function(){try{return u6(uj,s6(this))[1]}catch{return""}}});var c6=je,$R=!c6(function(){return Object.isExtensible(Object.preventExtensions({}))}),_a={},h6={get exports(){return _a},set exports(e){_a=e}},d6=je,v6=d6(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),y6=je,p6=Ft,m6=Dn,JT=v6,wy=Object.isExtensible,g6=y6(function(){wy(1)}),b6=g6||JT?function(t){return!p6(t)||JT&&m6(t)=="ArrayBuffer"?!1:wy?wy(t):!0}:wy,w6=Ae,S6=Be,C6=Pd,_6=Ft,AR=$t,O6=mr.f,ek=Fa,R6=bR,IR=b6,E6=Cm,P6=$R,fj=!1,ko=E6("meta"),T6=0,MR=function(e){O6(e,ko,{value:{objectID:"O"+T6++,weakData:{}}})},k6=function(e,t){if(!_6(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!AR(e,ko)){if(!IR(e))return"F";if(!t)return"E";MR(e)}return e[ko].objectID},$6=function(e,t){if(!AR(e,ko)){if(!IR(e))return!0;if(!t)return!1;MR(e)}return e[ko].weakData},A6=function(e){return P6&&fj&&IR(e)&&!AR(e,ko)&&MR(e),e},I6=function(){M6.enable=function(){},fj=!0;var e=ek.f,t=S6([].splice),r={};r[ko]=1,e(r).length&&(ek.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===ko){t(o,i,1);break}return o},w6({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:R6.f}))},M6=h6.exports={enable:I6,fastKey:k6,getWeakData:$6,onFreeze:A6};C6[ko]=!0;var x6=Ae,D6=$R,N6=je,H6=Ft,L6=_a.onFreeze,kS=Object.freeze,j6=N6(function(){kS(1)});x6({target:"Object",stat:!0,forced:j6,sham:!D6},{freeze:function(t){return kS&&H6(t)?kS(L6(t)):t}});var B6=St,F6=ef,V6=mr.f,$S=B6("unscopables"),AS=Array.prototype;AS[$S]==null&&V6(AS,$S,{configurable:!0,value:F6(null)});var Ld=function(e){AS[$S][e]=!0},jd={},W6=je,cj=!W6(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),U6=$t,z6=_t,G6=Er,Y6=Rm,K6=cj,tk=Y6("IE_PROTO"),IS=Object,q6=IS.prototype,Dm=K6?IS.getPrototypeOf:function(e){var t=G6(e);if(U6(t,tk))return t[tk];var r=t.constructor;return z6(r)&&t instanceof r?r.prototype:t instanceof IS?q6:null},X6=je,Z6=_t,Q6=Ft,rk=Dm,J6=qr,e8=St,MS=e8("iterator"),hj=!1,Oa,lb,sb;[].keys&&(sb=[].keys(),"next"in sb?(lb=rk(rk(sb)),lb!==Object.prototype&&(Oa=lb)):hj=!0);var t8=!Q6(Oa)||X6(function(){var e={};return Oa[MS].call(e)!==e});t8&&(Oa={});Z6(Oa[MS])||J6(Oa,MS,function(){return this});var dj={IteratorPrototype:Oa,BUGGY_SAFARI_ITERATORS:hj},r8=dj.IteratorPrototype,n8=ef,o8=Cd,i8=Tm,a8=jd,l8=function(){return this},s8=function(e,t,r,n){var o=t+" Iterator";return e.prototype=n8(r8,{next:o8(+!n,r)}),i8(e,o,!1),a8[o]=l8,e},u8=Be,f8=La,c8=function(e,t,r){try{return u8(f8(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},h8=_t,d8=String,v8=TypeError,y8=function(e){if(typeof e=="object"||h8(e))return e;throw v8("Can't set "+d8(e)+" as a prototype")},p8=c8,m8=Dt,g8=y8,xR=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=p8(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return m8(o),g8(i),e?r(o,i):o.__proto__=i,o}}():void 0),b8=Ae,w8=Gt,vj=Ed,S8=_t,C8=s8,nk=Dm,ok=xR,_8=Tm,O8=Ba,ub=qr,R8=St,E8=jd,yj=dj,P8=vj.PROPER,T8=vj.CONFIGURABLE,ik=yj.IteratorPrototype,bv=yj.BUGGY_SAFARI_ITERATORS,vf=R8("iterator"),ak="keys",yf="values",lk="entries",k8=function(){return this},DR=function(e,t,r,n,o,i,a){C8(r,t,n);var l=function(w){if(w===o&&h)return h;if(!bv&&w in f)return f[w];switch(w){case ak:return function(){return new r(this,w)};case yf:return function(){return new r(this,w)};case lk:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[vf]||f["@@iterator"]||o&&f[o],h=!bv&&c||l(o),d=t=="Array"&&f.entries||c,v,p,g;if(d&&(v=nk(d.call(new e)),v!==Object.prototype&&v.next&&(nk(v)!==ik&&(ok?ok(v,ik):S8(v[vf])||ub(v,vf,k8)),_8(v,s,!0))),P8&&o==yf&&c&&c.name!==yf&&(T8?O8(f,"name",yf):(u=!0,h=function(){return w8(c,this)})),o)if(p={values:l(yf),keys:i?h:l(ak),entries:l(lk)},a)for(g in p)(bv||u||!(g in f))&&ub(f,g,p[g]);else b8({target:t,proto:!0,forced:bv||u},p);return f[vf]!==h&&ub(f,vf,h,{name:o}),E8[t]=h,p},NR=function(e,t){return{value:e,done:t}},$8=Nr,HR=Ld,sk=jd,pj=Do,A8=mr.f,I8=DR,wv=NR,M8=Bt,mj="Array Iterator",x8=pj.set,D8=pj.getterFor(mj),N8=I8(Array,"Array",function(e,t){x8(this,{type:mj,target:$8(e),index:0,kind:t})},function(){var e=D8(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,wv(void 0,!0)):r=="keys"?wv(n,!1):r=="values"?wv(t[n],!1):wv([n,t[n]],!1)},"values"),uk=sk.Arguments=sk.Array;HR("keys");HR("values");HR("entries");if(M8&&uk.name!=="values")try{A8(uk,"name",{value:"values"})}catch{}var H8=mR,L8=Pm,j8=H8?{}.toString:function(){return"[object "+L8(this)+"]"},B8=mR,F8=qr,V8=j8;B8||F8(Object.prototype,"toString",V8,{unsafe:!0});var W8=St,U8=jd,z8=W8("iterator"),G8=Array.prototype,gj=function(e){return e!==void 0&&(U8.Array===e||G8[z8]===e)},Y8=Pm,fk=ja,K8=dn,q8=jd,X8=St,Z8=X8("iterator"),LR=function(e){if(!K8(e))return fk(e,Z8)||fk(e,"@@iterator")||q8[Y8(e)]},Q8=Gt,J8=La,e5=Dt,t5=Ju,r5=LR,n5=TypeError,bj=function(e,t){var r=arguments.length<2?r5(e):t;if(J8(r))return e5(Q8(r,e));throw n5(t5(e)+" is not iterable")},o5=Gt,ck=Dt,i5=ja,wj=function(e,t,r){var n,o;ck(e);try{if(n=i5(e,"return"),!n){if(t==="throw")throw r;return r}n=o5(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return ck(n),r},a5=xd,l5=Gt,s5=Dt,u5=Ju,f5=gj,c5=Xr,hk=bi,h5=bj,d5=LR,dk=wj,v5=TypeError,Sy=function(e,t){this.stopped=e,this.result=t},vk=Sy.prototype,jR=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=a5(t,n),u,f,c,h,d,v,p,g=function(S){return u&&dk(u,"normal",S),new Sy(!0,S)},w=function(S){return o?(s5(S),l?s(S[0],S[1],g):s(S[0],S[1])):l?s(S,g):s(S)};if(i)u=e.iterator;else if(a)u=e;else{if(f=d5(e),!f)throw v5(u5(e)+" is not iterable");if(f5(f)){for(c=0,h=c5(e);h>c;c++)if(d=w(e[c]),d&&hk(vk,d))return d;return new Sy(!1)}u=h5(e,f)}for(v=i?e.next:u.next;!(p=l5(v,u)).done;){try{d=w(p.value)}catch(S){dk(u,"throw",S)}if(typeof d=="object"&&d&&hk(vk,d))return d}return new Sy(!1)},y5=bi,p5=TypeError,BR=function(e,t){if(y5(t,e))return e;throw p5("Incorrect invocation")},m5=St,Sj=m5("iterator"),Cj=!1;try{var g5=0,yk={next:function(){return{done:!!g5++}},return:function(){Cj=!0}};yk[Sj]=function(){return this},Array.from(yk,function(){throw 2})}catch{}var _j=function(e,t){if(!t&&!Cj)return!1;var r=!1;try{var n={};n[Sj]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},b5=_t,w5=Ft,pk=xR,FR=function(e,t,r){var n,o;return pk&&b5(n=t.constructor)&&n!==r&&w5(o=n.prototype)&&o!==r.prototype&&pk(e,o),e},S5=Ae,C5=gt,_5=Be,mk=Em,O5=qr,R5=_a,E5=jR,P5=BR,T5=_t,k5=dn,fb=Ft,cb=je,$5=_j,A5=Tm,I5=FR,Nm=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=C5[e],l=a&&a.prototype,s=a,u={},f=function(w){var S=_5(l[w]);O5(l,w,w=="add"?function(T){return S(this,T===0?0:T),this}:w=="delete"?function(_){return o&&!fb(_)?!1:S(this,_===0?0:_)}:w=="get"?function(T){return o&&!fb(T)?void 0:S(this,T===0?0:T)}:w=="has"?function(T){return o&&!fb(T)?!1:S(this,T===0?0:T)}:function(T,R){return S(this,T===0?0:T,R),this})},c=mk(e,!T5(a)||!(o||l.forEach&&!cb(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),R5.enable();else if(mk(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!=h,v=cb(function(){h.has(1)}),p=$5(function(w){new a(w)}),g=!o&&cb(function(){for(var w=new a,S=5;S--;)w[i](S,S);return!w.has(-0)});p||(s=t(function(w,S){P5(w,l);var _=I5(new a,w,s);return k5(S)||E5(S,_[i],{that:_,AS_ENTRIES:n}),_}),s.prototype=l,l.constructor=s),(v||g)&&(f("delete"),f("has"),n&&f("get")),(g||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,S5({global:!0,constructor:!0,forced:s!=a},u),A5(s,e),o||r.setStrong(s,e,n),s},M5=qr,VR=function(e,t,r){for(var n in t)M5(e,n,t[n],r);return e},x5=xo,D5=Id,N5=St,H5=Bt,gk=N5("species"),Oj=function(e){var t=x5(e);H5&&t&&!t[gk]&&D5(t,gk,{configurable:!0,get:function(){return this}})},L5=ef,j5=Id,bk=VR,B5=xd,F5=BR,V5=dn,W5=jR,U5=DR,Sv=NR,z5=Oj,pf=Bt,wk=_a.fastKey,Rj=Do,Sk=Rj.set,hb=Rj.getterFor,Ej={getConstructor:function(e,t,r,n){var o=e(function(u,f){F5(u,i),Sk(u,{type:t,index:L5(null),first:void 0,last:void 0,size:0}),pf||(u.size=0),V5(f)||W5(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=hb(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,p;return d?d.value=c:(h.last=d={index:p=wk(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),pf?h.size++:u.size++,p!=="F"&&(h.index[p]=d)),u},s=function(u,f){var c=a(u),h=wk(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return bk(i,{clear:function(){for(var f=this,c=a(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,pf?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),pf?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=B5(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),bk(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),pf&&j5(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=hb(t),i=hb(n);U5(e,t,function(a,l){Sk(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,Sv(void 0,!0)):l=="keys"?Sv(s.key,!1):l=="values"?Sv(s.value,!1):Sv([s.key,s.value],!1)},r?"entries":"values",!r,!0),z5(t)}},G5=Nm,Y5=Ej;G5("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Y5);var WR=Be,K5=wi,q5=Vt,X5=Rr,Z5=WR("".charAt),Ck=WR("".charCodeAt),Q5=WR("".slice),_k=function(e){return function(t,r){var n=q5(X5(t)),o=K5(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=Ck(n,o),a<55296||a>56319||o+1===i||(l=Ck(n,o+1))<56320||l>57343?e?Z5(n,o):a:e?Q5(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},UR={codeAt:_k(!1),charAt:_k(!0)},J5=UR.charAt,e7=Vt,Pj=Do,t7=DR,Ok=NR,Tj="String Iterator",r7=Pj.set,n7=Pj.getterFor(Tj);t7(String,"String",function(e){r7(this,{type:Tj,string:e7(e),index:0})},function(){var t=n7(this),r=t.string,n=t.index,o;return n>=r.length?Ok(void 0,!0):(o=J5(r,n),t.index+=o.length,Ok(o,!1))});var kj={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},o7=Om,db=o7("span").classList,Rk=db&&db.constructor&&db.constructor.prototype,$j=Rk===Object.prototype?void 0:Rk,Ek=gt,Aj=kj,i7=$j,Uf=N8,vb=Ba,Ij=St,yb=Ij("iterator"),Pk=Ij("toStringTag"),pb=Uf.values,Mj=function(e,t){if(e){if(e[yb]!==pb)try{vb(e,yb,pb)}catch{e[yb]=pb}if(e[Pk]||vb(e,Pk,t),Aj[t]){for(var r in Uf)if(e[r]!==Uf[r])try{vb(e,r,Uf[r])}catch{e[r]=Uf[r]}}}};for(var mb in Aj)Mj(Ek[mb]&&Ek[mb].prototype,mb);Mj(i7,"DOMTokenList");var a7=Ae,l7=yR.includes,s7=je,u7=Ld,f7=s7(function(){return!Array(1).includes()});a7({target:"Array",proto:!0,forced:f7},{includes:function(t){return l7(this,t,arguments.length>1?arguments[1]:void 0)}});u7("includes");var Tk=Ju,c7=TypeError,xj=function(e,t){if(!delete e[t])throw c7("Cannot delete property "+Tk(t)+" of "+Tk(e))},kk=wR,h7=Math.floor,xS=function(e,t){var r=e.length,n=h7(r/2);return r<8?d7(e,t):v7(e,xS(kk(e,0,n),t),xS(kk(e,n),t),t)},d7=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},v7=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,l=0;a<o||l<i;)e[a+l]=a<o&&l<i?n(t[a],r[l])<=0?t[a++]:r[l++]:a<o?t[a++]:r[l++];return e},y7=xS,p7=je,nf=function(e,t){var r=[][e];return!!r&&p7(function(){r.call(null,t||function(){return 1},1)})},m7=Ha,$k=m7.match(/firefox\/(\d+)/i),g7=!!$k&&+$k[1],b7=Ha,w7=/MSIE|Trident/.test(b7),S7=Ha,Ak=S7.match(/AppleWebKit\/(\d+)\./),C7=!!Ak&&+Ak[1],_7=Ae,Dj=Be,O7=La,R7=Er,Ik=Xr,E7=xj,Mk=Vt,zR=je,P7=y7,T7=nf,xk=g7,k7=w7,Dk=Od,Nk=C7,Qo=[],Hk=Dj(Qo.sort),$7=Dj(Qo.push),A7=zR(function(){Qo.sort(void 0)}),I7=zR(function(){Qo.sort(null)}),M7=T7("sort"),Nj=!zR(function(){if(Dk)return Dk<70;if(!(xk&&xk>3)){if(k7)return!0;if(Nk)return Nk<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)Qo.push({k:r+o,v:n})}for(Qo.sort(function(i,a){return a.v-i.v}),o=0;o<Qo.length;o++)r=Qo[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),x7=A7||!I7||!M7||!Nj,D7=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:Mk(t)>Mk(r)?1:-1}};_7({target:"Array",proto:!0,forced:x7},{sort:function(t){t!==void 0&&O7(t);var r=R7(this);if(Nj)return t===void 0?Hk(r):Hk(r,t);var n=[],o=Ik(r),i,a;for(a=0;a<o;a++)a in r&&$7(n,r[a]);for(P7(n,D7(t)),i=Ik(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)E7(r,a++);return r}});var N7=Bt,H7=rf,L7=TypeError,j7=Object.getOwnPropertyDescriptor,B7=N7&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),F7=B7?function(e,t){if(H7(e)&&!j7(e,"length").writable)throw L7("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},V7=TypeError,W7=9007199254740991,Hj=function(e){if(e>W7)throw V7("Maximum allowed index exceeded");return e},U7=je,z7=St,G7=Od,Y7=z7("species"),Bd=function(e){return G7>=51||!U7(function(){var t=[],r=t.constructor={};return r[Y7]=function(){return{foo:1}},t[e](Boolean).foo!==1})},K7=Ae,q7=Er,X7=Td,Z7=wi,Q7=Xr,J7=F7,e9=Hj,t9=OR,r9=tf,gb=xj,n9=Bd,o9=n9("splice"),i9=Math.max,a9=Math.min;K7({target:"Array",proto:!0,forced:!o9},{splice:function(t,r){var n=q7(this),o=Q7(n),i=X7(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=a9(i9(Z7(r),0),o-i)),e9(o+l-s),u=t9(n,s),f=0;f<s;f++)c=i+f,c in n&&r9(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:gb(n,h);for(f=o;f>o-s+l;f--)gb(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:gb(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return J7(n,o-s+l),u}});var l9=Ft,s9=Math.floor,u9=Number.isInteger||function(t){return!l9(t)&&isFinite(t)&&s9(t)===t},f9=Ae,c9=u9;f9({target:"Number",stat:!0},{isInteger:c9});var h9=Be,Lj=h9(1 .valueOf),jj=`	
\v\f\r                　\u2028\u2029\uFEFF`,d9=Be,v9=Rr,y9=Vt,DS=jj,Lk=d9("".replace),p9=RegExp("^["+DS+"]+"),m9=RegExp("(^|[^"+DS+"])["+DS+"]+$"),bb=function(e){return function(t){var r=y9(v9(t));return e&1&&(r=Lk(r,p9,"")),e&2&&(r=Lk(r,m9,"$1")),r}},Bj={start:bb(1),end:bb(2),trim:bb(3)},g9=Ae,Fj=Xz,b9=Bt,Vj=gt,Wj=xL,Uj=Be,w9=Em,jk=$t,S9=FR,C9=bi,_9=Rd,zj=mL,O9=je,R9=Fa.f,E9=xn.f,P9=mr.f,T9=Lj,k9=Bj.trim,Hm="Number",Ml=Vj[Hm];Wj[Hm];var GR=Ml.prototype,$9=Vj.TypeError,A9=Uj("".slice),Cv=Uj("".charCodeAt),I9=function(e){var t=zj(e,"number");return typeof t=="bigint"?t:M9(t)},M9=function(e){var t=zj(e,"number"),r,n,o,i,a,l,s,u;if(_9(t))throw $9("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=k9(t),r=Cv(t,0),r===43||r===45){if(n=Cv(t,2),n===88||n===120)return NaN}else if(r===48){switch(Cv(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=A9(t,2),l=a.length,s=0;s<l;s++)if(u=Cv(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},YR=w9(Hm,!Ml(" 0o1")||!Ml("0b1")||Ml("+0x1")),x9=function(e){return C9(GR,e)&&O9(function(){T9(e)})},Lm=function(t){var r=arguments.length<1?0:Ml(I9(t));return x9(this)?S9(Object(r),this,Lm):r};Lm.prototype=GR;YR&&!Fj&&(GR.constructor=Lm);g9({global:!0,constructor:!0,wrap:!0,forced:YR},{Number:Lm});var D9=function(e,t){for(var r=b9?R9(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)jk(t,o=r[n])&&!jk(e,o)&&P9(e,o,E9(t,o))};(YR||Fj)&&D9(Wj[Hm],Ml);var N9=Ae,Bk=rf,H9=km,L9=Ft,Fk=Td,j9=Xr,B9=Nr,F9=tf,V9=St,W9=Bd,U9=Nd,z9=W9("slice"),G9=V9("species"),wb=Array,Y9=Math.max;N9({target:"Array",proto:!0,forced:!z9},{slice:function(t,r){var n=B9(this),o=j9(n),i=Fk(t,o),a=Fk(r===void 0?o:r,o),l,s,u;if(Bk(n)&&(l=n.constructor,H9(l)&&(l===wb||Bk(l.prototype))?l=void 0:L9(l)&&(l=l[G9],l===null&&(l=void 0)),l===wb||l===void 0))return U9(n,i,a);for(s=new(l===void 0?wb:l)(Y9(a-i,0)),u=0;i<a;i++,u++)i in n&&F9(s,u,n[i]);return s.length=u,s}});var K9=Ae,q9=je,X9=rf,Z9=Ft,Q9=Er,J9=Xr,Vk=Hj,Wk=tf,eq=OR,tq=Bd,rq=St,nq=Od,Gj=rq("isConcatSpreadable"),oq=nq>=51||!q9(function(){var e=[];return e[Gj]=!1,e.concat()[0]!==e}),iq=function(e){if(!Z9(e))return!1;var t=e[Gj];return t!==void 0?!!t:X9(e)},aq=!oq||!tq("concat");K9({target:"Array",proto:!0,arity:1,forced:aq},{concat:function(t){var r=Q9(this),n=eq(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],iq(u))for(s=J9(u),Vk(o+s),a=0;a<s;a++,o++)a in u&&Wk(n,o,u[a]);else Vk(o+1),Wk(n,o++,u);return n.length=o,n}});var lq=Er,Uk=Td,sq=Xr,uq=function(t){for(var r=lq(this),n=sq(r),o=arguments.length,i=Uk(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:Uk(a,n);l>i;)r[i++]=t;return r},fq=Ae,cq=uq,hq=Ld;fq({target:"Array",proto:!0},{fill:cq});hq("fill");var dq=Ae,vq=Wa.map,yq=Bd,pq=yq("map");dq({target:"Array",proto:!0,forced:!pq},{map:function(t){return vq(this,t,arguments.length>1?arguments[1]:void 0)}});var mq=Dt,Yj=function(){var e=mq(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},KR=je,gq=gt,qR=gq.RegExp,XR=KR(function(){var e=qR("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),bq=XR||KR(function(){return!qR("a","y").sticky}),wq=XR||KR(function(){var e=qR("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),ZR={BROKEN_CARET:wq,MISSED_STICKY:bq,UNSUPPORTED_Y:XR},Sq=je,Cq=gt,_q=Cq.RegExp,Kj=Sq(function(){var e=_q(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),Oq=je,Rq=gt,Eq=Rq.RegExp,qj=Oq(function(){var e=Eq("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),$l=Gt,jm=Be,Pq=Vt,Tq=Yj,kq=ZR,$q=pi,Aq=ef,Iq=Do.get,Mq=Kj,xq=qj,Dq=$q("native-string-replace",String.prototype.replace),sp=RegExp.prototype.exec,NS=sp,Nq=jm("".charAt),Hq=jm("".indexOf),Lq=jm("".replace),Sb=jm("".slice),HS=function(){var e=/a/,t=/b*/g;return $l(sp,e,"a"),$l(sp,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),Xj=kq.BROKEN_CARET,LS=/()??/.exec("")[1]!==void 0,jq=HS||LS||Xj||Mq||xq;jq&&(NS=function(t){var r=this,n=Iq(r),o=Pq(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=$l(NS,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=Xj&&r.sticky,p=$l(Tq,r),g=r.source,w=0,S=o;if(v&&(p=Lq(p,"y",""),Hq(p,"g")===-1&&(p+="g"),S=Sb(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&Nq(o,r.lastIndex-1)!==`
`)&&(g="(?: "+g+")",S=" "+S,w++),l=new RegExp("^(?:"+g+")",p)),LS&&(l=new RegExp("^"+g+"$(?!\\s)",p)),HS&&(s=r.lastIndex),u=$l(sp,v?l:r,S),v?u?(u.input=Sb(u.input,w),u[0]=Sb(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:HS&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),LS&&u&&u.length>1&&$l(Dq,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=Aq(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var Bm=NS,Bq=Ae,zk=Bm;Bq({target:"RegExp",proto:!0,forced:/./.exec!==zk},{exec:zk});var Gk=Md,Yk=qr,Fq=Bm,Kk=je,Zj=St,Vq=Ba,Wq=Zj("species"),Cb=RegExp.prototype,Fm=function(e,t,r,n){var o=Zj(e),i=!Kk(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!Kk(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[Wq]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=Gk(/./[o]),s=t(o,""[e],function(u,f,c,h,d){var v=Gk(u),p=f.exec;return p===Fq||p===Cb.exec?i&&!d?{done:!0,value:l(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});Yk(String.prototype,e,s[0]),Yk(Cb,o,s[1])}n&&Vq(Cb[o],"sham",!0)},Uq=UR.charAt,QR=function(e,t,r){return t+(r?Uq(e,t).length:1)},JR=Be,zq=Er,Gq=Math.floor,_b=JR("".charAt),Yq=JR("".replace),Ob=JR("".slice),Kq=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,qq=/\$([$&'`]|\d{1,2})/g,Xq=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=qq;return o!==void 0&&(o=zq(o),s=Kq),Yq(i,s,function(u,f){var c;switch(_b(f,0)){case"$":return"$";case"&":return e;case"`":return Ob(t,0,r);case"'":return Ob(t,a);case"<":c=o[Ob(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=Gq(h/10);return d===0?u:d<=l?n[d-1]===void 0?_b(f,1):n[d-1]+_b(f,1):u}c=n[h-1]}return c===void 0?"":c})},qk=Gt,Zq=Dt,Qq=_t,Jq=Dn,eX=Bm,tX=TypeError,Vm=function(e,t){var r=e.exec;if(Qq(r)){var n=qk(r,e,t);return n!==null&&Zq(n),n}if(Jq(e)==="RegExp")return qk(eX,e,t);throw tX("RegExp#exec called on incompatible receiver")},rX=Ua,Xk=Gt,Wm=Be,nX=Fm,oX=je,iX=Dt,aX=_t,lX=dn,sX=wi,uX=Va,Xa=Vt,fX=Rr,cX=QR,hX=ja,dX=Xq,vX=Vm,yX=St,jS=yX("replace"),pX=Math.max,mX=Math.min,gX=Wm([].concat),Rb=Wm([].push),Zk=Wm("".indexOf),Qk=Wm("".slice),bX=function(e){return e===void 0?e:String(e)},wX=function(){return"a".replace(/./,"$0")==="$0"}(),Jk=function(){return/./[jS]?/./[jS]("a","$0")==="":!1}(),SX=!oX(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});nX("replace",function(e,t,r){var n=Jk?"$":"$0";return[function(i,a){var l=fX(this),s=lX(i)?void 0:hX(i,jS);return s?Xk(s,i,l,a):Xk(t,Xa(l),i,a)},function(o,i){var a=iX(this),l=Xa(o);if(typeof i=="string"&&Zk(i,n)===-1&&Zk(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=aX(i);u||(i=Xa(i));var f=a.global;if(f){var c=a.unicode;a.lastIndex=0}for(var h=[];;){var d=vX(a,l);if(d===null||(Rb(h,d),!f))break;var v=Xa(d[0]);v===""&&(a.lastIndex=cX(l,uX(a.lastIndex),c))}for(var p="",g=0,w=0;w<h.length;w++){d=h[w];for(var S=Xa(d[0]),_=pX(mX(sX(d.index),l.length),0),T=[],R=1;R<d.length;R++)Rb(T,bX(d[R]));var W=d.groups;if(u){var z=gX([S],T,_,l);W!==void 0&&Rb(z,W);var X=Xa(rX(i,void 0,z))}else X=dX(S,l,_,T,W,i);_>=g&&(p+=Qk(l,g,_)+X,g=_+S.length)}return p+Qk(l,g)}]},!SX||!wX||Jk);var CX=Dt,_X=wj,OX=function(e,t,r,n){try{return n?t(CX(r)[0],r[1]):t(r)}catch(o){_X(e,"throw",o)}},RX=xd,EX=Gt,PX=Er,TX=OX,kX=gj,$X=km,AX=Xr,e$=tf,IX=bj,MX=LR,t$=Array,xX=function(t){var r=PX(t),n=$X(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=RX(i,o>2?arguments[2]:void 0));var l=MX(r),s=0,u,f,c,h,d,v;if(l&&!(this===t$&&kX(l)))for(h=IX(r,l),d=h.next,f=n?new this:[];!(c=EX(d,h)).done;s++)v=a?TX(h,i,[c.value,s],!0):c.value,e$(f,s,v);else for(u=AX(r),f=n?new this(u):t$(u);u>s;s++)v=a?i(r[s],s):r[s],e$(f,s,v);return f.length=s,f},DX=Ae,NX=xX,HX=_j,LX=!HX(function(e){Array.from(e)});DX({target:"Array",stat:!0,forced:LX},{from:NX});var jX=Ae,BX=Md,FX=yR.indexOf,VX=nf,BS=BX([].indexOf),Qj=!!BS&&1/BS([1],1,-0)<0,WX=Qj||!VX("indexOf");jX({target:"Array",proto:!0,forced:WX},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return Qj?BS(this,t,r)||0:FX(this,t,r)}});var UX=Ae,zX=Be,GX=rf,YX=zX([].reverse),r$=[1,2];UX({target:"Array",proto:!0,forced:String(r$)===String(r$.reverse())},{reverse:function(){return GX(this)&&(this.length=this.length),YX(this)}});var KX=Wa.forEach,qX=nf,XX=qX("forEach"),ZX=XX?[].forEach:function(t){return KX(this,t,arguments.length>1?arguments[1]:void 0)},n$=gt,o$=kj,QX=$j,Eb=ZX,JX=Ba,Jj=function(e){if(e&&e.forEach!==Eb)try{JX(e,"forEach",Eb)}catch{e.forEach=Eb}};for(var Pb in o$)o$[Pb]&&Jj(n$[Pb]&&n$[Pb].prototype);Jj(QX);var eZ=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",tZ=TypeError,eB=function(e,t){if(e<t)throw tZ("Not enough arguments");return e},tB=gt,rZ=Ua,nZ=_t,oZ=eZ,iZ=Ha,aZ=Nd,lZ=eB,sZ=tB.Function,uZ=/MSIE .\./.test(iZ)||oZ&&function(){var e=tB.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),eE=function(e,t){var r=t?2:1;return uZ?function(n,o){var i=lZ(arguments.length,1)>r,a=nZ(n)?n:sZ(n),l=i?aZ(arguments,r):[],s=i?function(){rZ(a,this,l)}:a;return t?e(s,o):e(s)}:e},fZ=Ae,rB=gt,cZ=eE,i$=cZ(rB.setInterval,!0);fZ({global:!0,bind:!0,forced:rB.setInterval!==i$},{setInterval:i$});var hZ=Ae,nB=gt,dZ=eE,a$=dZ(nB.setTimeout,!0);hZ({global:!0,bind:!0,forced:nB.setTimeout!==a$},{setTimeout:a$});var vZ=Ha,yZ=/(?:ipad|iphone|ipod).*applewebkit/i.test(vZ),pZ=Dn,oB=typeof process<"u"&&pZ(process)=="process",Dr=gt,mZ=Ua,gZ=xd,l$=_t,bZ=$t,iB=je,s$=kL,wZ=Nd,u$=Om,SZ=eB,CZ=yZ,_Z=oB,FS=Dr.setImmediate,VS=Dr.clearImmediate,OZ=Dr.process,Tb=Dr.Dispatch,RZ=Dr.Function,f$=Dr.MessageChannel,EZ=Dr.String,kb=0,qf={},c$="onreadystatechange",dc,Ei,$b,Ab;iB(function(){dc=Dr.location});var tE=function(e){if(bZ(qf,e)){var t=qf[e];delete qf[e],t()}},Ib=function(e){return function(){tE(e)}},h$=function(e){tE(e.data)},d$=function(e){Dr.postMessage(EZ(e),dc.protocol+"//"+dc.host)};(!FS||!VS)&&(FS=function(t){SZ(arguments.length,1);var r=l$(t)?t:RZ(t),n=wZ(arguments,1);return qf[++kb]=function(){mZ(r,void 0,n)},Ei(kb),kb},VS=function(t){delete qf[t]},_Z?Ei=function(e){OZ.nextTick(Ib(e))}:Tb&&Tb.now?Ei=function(e){Tb.now(Ib(e))}:f$&&!CZ?($b=new f$,Ab=$b.port2,$b.port1.onmessage=h$,Ei=gZ(Ab.postMessage,Ab)):Dr.addEventListener&&l$(Dr.postMessage)&&!Dr.importScripts&&dc&&dc.protocol!=="file:"&&!iB(d$)?(Ei=d$,Dr.addEventListener("message",h$,!1)):c$ in u$("script")?Ei=function(e){s$.appendChild(u$("script"))[c$]=function(){s$.removeChild(this),tE(e)}}:Ei=function(e){setTimeout(Ib(e),0)});var aB={set:FS,clear:VS},PZ=Ae,TZ=gt,v$=aB.clear;PZ({global:!0,bind:!0,enumerable:!0,forced:TZ.clearImmediate!==v$},{clearImmediate:v$});var kZ=Ae,lB=gt,y$=aB.set,$Z=eE,p$=lB.setImmediate?$Z(y$,!1):y$;kZ({global:!0,bind:!0,enumerable:!0,forced:lB.setImmediate!==p$},{setImmediate:p$});var AZ=Nm,IZ=Ej;AZ("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},IZ);var MZ=Ae,xZ=je,DZ=Er,sB=Dm,NZ=cj,HZ=xZ(function(){sB(1)});MZ({target:"Object",stat:!0,forced:HZ,sham:!NZ},{getPrototypeOf:function(t){return sB(DZ(t))}});var LZ=Ft,jZ=Dn,BZ=St,FZ=BZ("match"),rE=function(e){var t;return LZ(e)&&((t=e[FZ])!==void 0?!!t:jZ(e)=="RegExp")},VZ=rE,WZ=TypeError,nE=function(e){if(VZ(e))throw WZ("The method doesn't accept regular expressions");return e},UZ=St,zZ=UZ("match"),oE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[zZ]=!1,"/./"[e](t)}catch{}}return!1},GZ=Ae,YZ=Be,KZ=nE,qZ=Rr,m$=Vt,XZ=oE,ZZ=YZ("".indexOf);GZ({target:"String",proto:!0,forced:!XZ("includes")},{includes:function(t){return!!~ZZ(m$(qZ(this)),m$(KZ(t)),arguments.length>1?arguments[1]:void 0)}});var QZ=Ae,JZ=Wa.filter,eQ=Bd,tQ=eQ("filter");QZ({target:"Array",proto:!0,forced:!tQ},{filter:function(t){return JZ(this,t,arguments.length>1?arguments[1]:void 0)}});var rQ=Gt,nQ=$t,oQ=bi,iQ=Yj,g$=RegExp.prototype,uB=function(e){var t=e.flags;return t===void 0&&!("flags"in g$)&&!nQ(e,"flags")&&oQ(g$,e)?rQ(iQ,e):t},aQ=mr.f,lQ=function(e,t,r){r in e||aQ(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},sQ=Bt,iE=gt,Fd=Be,uQ=Em,fQ=FR,cQ=Ba,hQ=Fa.f,b$=bi,dQ=rE,w$=Vt,vQ=uB,fB=ZR,yQ=lQ,pQ=qr,mQ=je,gQ=$t,bQ=Do.enforce,wQ=Oj,SQ=St,cB=Kj,hB=qj,CQ=SQ("match"),ni=iE.RegExp,Ol=ni.prototype,_Q=iE.SyntaxError,OQ=Fd(Ol.exec),up=Fd("".charAt),S$=Fd("".replace),C$=Fd("".indexOf),RQ=Fd("".slice),EQ=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,ba=/a/g,Mb=/a/g,PQ=new ni(ba)!==ba,dB=fB.MISSED_STICKY,TQ=fB.UNSUPPORTED_Y,kQ=sQ&&(!PQ||dB||cB||hB||mQ(function(){return Mb[CQ]=!1,ni(ba)!=ba||ni(Mb)==Mb||ni(ba,"i")!="/a/i"})),$Q=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=up(e,r),i==="\\"){n+=i+up(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},AQ=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=up(e,r),f==="\\")f=f+up(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":OQ(EQ,RQ(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||gQ(i,u))throw new _Q("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(uQ("RegExp",kQ)){for(var Pi=function(t,r){var n=b$(Ol,this),o=dQ(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===Pi)return t;if((o||b$(Ol,t))&&(t=t.source,i&&(r=vQ(l))),t=t===void 0?"":w$(t),r=r===void 0?"":w$(r),l=t,cB&&"dotAll"in ba&&(u=!!r&&C$(r,"s")>-1,u&&(r=S$(r,/s/g,""))),s=r,dB&&"sticky"in ba&&(f=!!r&&C$(r,"y")>-1,f&&TQ&&(r=S$(r,/y/g,""))),hB&&(c=AQ(t),t=c[0],a=c[1]),h=fQ(ni(t,r),n?this:Ol,Pi),(u||f||a.length)&&(d=bQ(h),u&&(d.dotAll=!0,d.raw=Pi($Q(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{cQ(h,"source",l===""?"(?:)":l)}catch{}return h},_$=hQ(ni),O$=0;_$.length>O$;)yQ(Pi,ni,_$[O$++]);Ol.constructor=Pi,Pi.prototype=Ol,pQ(iE,"RegExp",Pi,{constructor:!0})}wQ("RegExp");var IQ=Ed.PROPER,MQ=qr,xQ=Dt,R$=Vt,DQ=je,NQ=uB,aE="toString",HQ=RegExp.prototype,vB=HQ[aE],LQ=DQ(function(){return vB.call({source:"a",flags:"b"})!="/a/b"}),jQ=IQ&&vB.name!=aE;(LQ||jQ)&&MQ(RegExp.prototype,aE,function(){var t=xQ(this),r=R$(t.source),n=R$(NQ(t));return"/"+r+"/"+n},{unsafe:!0});var BQ=Ae,FQ=Be,VQ=_d,WQ=Nr,UQ=nf,zQ=FQ([].join),GQ=VQ!=Object,YQ=GQ||!UQ("join",",");BQ({target:"Array",proto:!0,forced:YQ},{join:function(t){return zQ(WQ(this),t===void 0?",":t)}});var KQ=Ed.PROPER,qQ=je,E$=jj,P$="​᠎",XQ=function(e){return qQ(function(){return!!E$[e]()||P$[e]()!==P$||KQ&&E$[e].name!==e})},ZQ=Ae,QQ=Bj.trim,JQ=XQ;ZQ({target:"String",proto:!0,forced:JQ("trim")},{trim:function(){return QQ(this)}});function WS(e){return WS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WS(e)}function lE(e){return window.requestAnimationFrame(e)}function eJ(){return!!document.documentElement.classList}function tJ(){return!!document.createTextNode("test").textContent}function rJ(){return!!window.getComputedStyle}function fp(e){window.cancelAnimationFrame(e)}function yB(){return"ontouchstart"in window}var US;function nJ(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),US=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function pB(){return US===void 0&&nJ(),US}var Za;function oJ(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Za||((typeof Intl>"u"?"undefined":WS(Intl))==="object"?Za=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?Za=function(n,o){return"".concat(n).localeCompare(o)}:Za=function(n,o){return n===o?0:n>o?-1:1},Za)}var mf;function iJ(){if(mf!==void 0)return mf;try{var e={get passive(){mf=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{mf=!1}return mf}var aJ=CR,lJ=DL;aJ("toPrimitive");lJ();var sJ=Dt,uJ=pL,fJ=TypeError,cJ=function(e){if(sJ(this),e==="string"||e==="default")e="string";else if(e!=="number")throw fJ("Incorrect hint");return uJ(this,e)},hJ=$t,dJ=qr,vJ=cJ,yJ=St,T$=yJ("toPrimitive"),k$=Date.prototype;hJ(k$,T$)||dJ(k$,T$,vJ);var pJ=km,mJ=Ju,gJ=TypeError,mB=function(e){if(pJ(e))return e;throw gJ(mJ(e)+" is not a constructor")},$$=Dt,bJ=mB,wJ=dn,SJ=St,CJ=SJ("species"),_J=function(e,t){var r=$$(e).constructor,n;return r===void 0||wJ(n=$$(r)[CJ])?t:bJ(n)},OJ=Ua,gf=Gt,sE=Be,RJ=Fm,EJ=Dt,PJ=dn,TJ=rE,A$=Rr,kJ=_J,$J=QR,AJ=Va,xb=Vt,IJ=ja,I$=wR,M$=Vm,MJ=Bm,xJ=ZR,DJ=je,Qa=xJ.UNSUPPORTED_Y,x$=4294967295,NJ=Math.min,gB=[].push,HJ=sE(/./.exec),Ja=sE(gB),bf=sE("".slice),LJ=!DJ(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});RJ("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=xb(A$(this)),l=i===void 0?x$:i>>>0;if(l===0)return[];if(o===void 0)return[a];if(!TJ(o))return gf(t,a,o,l);for(var s=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),f=0,c=new RegExp(o.source,u+"g"),h,d,v;(h=gf(MJ,c,a))&&(d=c.lastIndex,!(d>f&&(Ja(s,bf(a,f,h.index)),h.length>1&&h.index<a.length&&OJ(gB,s,I$(h,1)),v=h[0].length,f=d,s.length>=l)));)c.lastIndex===h.index&&c.lastIndex++;return f===a.length?(v||!HJ(c,""))&&Ja(s,""):Ja(s,bf(a,f)),s.length>l?I$(s,0,l):s}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:gf(t,this,o,i)}:n=t,[function(i,a){var l=A$(this),s=PJ(i)?void 0:IJ(i,e);return s?gf(s,i,l,a):gf(n,xb(l),i,a)},function(o,i){var a=EJ(this),l=xb(o),s=r(n,a,l,i,n!==t);if(s.done)return s.value;var u=kJ(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Qa?"g":"y"),h=new u(Qa?"^(?:"+a.source+")":a,c),d=i===void 0?x$:i>>>0;if(d===0)return[];if(l.length===0)return M$(h,l)===null?[l]:[];for(var v=0,p=0,g=[];p<l.length;){h.lastIndex=Qa?0:p;var w=M$(h,Qa?bf(l,p):l),S;if(w===null||(S=NJ(AJ(h.lastIndex+(Qa?p:0)),l.length))===v)p=$J(l,p,f);else{if(Ja(g,bf(l,v,p)),g.length===d)return g;for(var _=1;_<=w.length-1;_++)if(Ja(g,w[_]),g.length===d)return g;p=v=S}}return Ja(g,bf(l,v)),g}]},!LJ,Qa);function jJ(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function D$(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Cy(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function ir(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function Yr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function We(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function I(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function bB(e){var t=[];return I(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function N$(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return I(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function H$(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function L$(e,t,r){return t=BJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BJ(e){var t=FJ(e,"string");return $o(t)==="symbol"?t:String(t)}function FJ(e,t){if($o(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($o(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $o(e){return $o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$o(e)}function vc(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},Ye(e,function(r,n){n!=="__children"&&(r&&$o(r)==="object"&&!Array.isArray(r)?t[n]=vc(r):Array.isArray(r)?r.length&&$o(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[vc(r[0])]:t[n]=[]:t[n]=null)})),t}function Si(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function zt(e,t,r){var n=Array.isArray(r);return Ye(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function Um(e,t){Ye(t,function(r,n){t[n]&&$o(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),Um(e[n],t[n])):e[n]=t[n]})}function yr(e){return $o(e)==="object"?JSON.parse(JSON.stringify(e)):e}function Or(e){var t={};return Ye(e,function(r,n){t[n]=r}),t}function bt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return I(r,function(o){e.MIXINS.push(o.MIXIN_NAME),Ye(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(p){var g=p;return(Array.isArray(g)||Ue(g))&&(g=yr(g)),g};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function wB(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ue(e){return Object.prototype.toString.call(e)==="[object Object]"}function No(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function Ye(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function VJ(e,t){var r=t.split("."),n=e;return Ye(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function Db(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(xt(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function uE(e){if(!Ue(e))return 0;var t=function r(n){var o=0;return Ue(n)?Ye(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function ql(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},L$(t,n,e),L$(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function xt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Cr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Nn={chrome:Cr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Cr(function(e){return/CriOS/.test(e)}),edge:Cr(function(e){return/Edge/.test(e)}),edgeWebKit:Cr(function(e){return/EdgiOS/.test(e)}),firefox:Cr(function(e){return/Firefox/.test(e)}),firefoxWebKit:Cr(function(e){return/FxiOS/.test(e)}),ie:Cr(function(e){return/Trident/.test(e)}),ie9:Cr(function(){return!!document.documentMode}),mobile:Cr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Cr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},Vd={mac:Cr(function(e){return/^Mac/.test(e)}),win:Cr(function(e){return/^Win/.test(e)}),linux:Cr(function(e){return/^Linux/.test(e)}),ios:Cr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function WJ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;Ye(Nn,function(i){var a=i.test;return void a(r,o)})}function UJ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;Ye(Vd,function(n){var o=n.test;return void o(r)})}WJ();UJ();function SB(){return Nn.chrome.value}function zJ(){return Nn.chromeWebKit.value}function Nb(){return Nn.firefox.value}function GJ(){return Nn.firefoxWebKit.value}function YJ(){return Nn.safari.value}function KJ(){return Nn.edge.value}function qJ(){return Nn.ie.value}function XJ(){return Nn.ie9.value}function $n(){return Nn.mobile.value}function CB(){return Vd.ios.value}function _B(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Vd.mac.value}function j$(){return Vd.win.value}function B$(){return Vd.mac.value}/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function Xo(e){return Xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xo(e)}function zS(e,t){return zS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},zS(e,t)}function ZJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _y(e,t,r){return ZJ()?_y=Reflect.construct:_y=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&zS(u,a.prototype),u},_y.apply(null,arguments)}function nn(e){return QJ(e)||JJ(e)||eee(e)||tee()}function QJ(e){if(Array.isArray(e))return GS(e)}function JJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eee(e,t){if(e){if(typeof e=="string")return GS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GS(e,t)}}function GS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ree=Object.hasOwnProperty,F$=Object.setPrototypeOf,nee=Object.isFrozen,oee=Object.getPrototypeOf,iee=Object.getOwnPropertyDescriptor,pr=Object.freeze,fn=Object.seal,aee=Object.create,OB=typeof Reflect<"u"&&Reflect,cp=OB.apply,YS=OB.construct;cp||(cp=function(t,r,n){return t.apply(r,n)});pr||(pr=function(t){return t});fn||(fn=function(t){return t});YS||(YS=function(t,r){return _y(t,nn(r))});var lee=Kr(Array.prototype.forEach),V$=Kr(Array.prototype.pop),wf=Kr(Array.prototype.push),Oy=Kr(String.prototype.toLowerCase),Hb=Kr(String.prototype.toString),see=Kr(String.prototype.match),en=Kr(String.prototype.replace),uee=Kr(String.prototype.indexOf),fee=Kr(String.prototype.trim),sr=Kr(RegExp.prototype.test),Lb=cee(TypeError);function Kr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return cp(e,t,n)}}function cee(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return YS(e,r)}}function Ge(e,t,r){r=r||Oy,F$&&F$(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var i=r(o);i!==o&&(nee(t)||(t[n]=i),o=i)}e[o]=!0}return e}function Ti(e){var t=aee(null),r;for(r in e)cp(ree,e,[r])===!0&&(t[r]=e[r]);return t}function _v(e,t){for(;e!==null;){var r=iee(e,t);if(r){if(r.get)return Kr(r.get);if(typeof r.value=="function")return Kr(r.value)}e=oee(e)}function n(o){return console.warn("fallback value for",o),null}return n}var W$=pr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),jb=pr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Bb=pr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),hee=pr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Fb=pr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),dee=pr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),U$=pr(["#text"]),z$=pr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Vb=pr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),G$=pr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ov=pr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),vee=fn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),yee=fn(/<%[\w\W]*|[\w\W]*%>/gm),pee=fn(/\${[\w\W]*}/gm),mee=fn(/^data-[\-\w.\u00B7-\uFFFF]/),gee=fn(/^aria-[\-\w]+$/),bee=fn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wee=fn(/^(?:\w+script|data):/i),See=fn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Cee=fn(/^html$/i),_ee=function(){return typeof window>"u"?null:window},Oee=function(t,r){if(Xo(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function RB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_ee(),t=function(N){return RB(N)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,p=_v(v,"cloneNode"),g=_v(v,"nextSibling"),w=_v(v,"childNodes"),S=_v(v,"parentNode");if(typeof i=="function"){var _=n.createElement("template");_.content&&_.content.ownerDocument&&(n=_.content.ownerDocument)}var T=Oee(d,r),R=T?T.createHTML(""):"",W=n,z=W.implementation,X=W.createNodeIterator,K=W.createDocumentFragment,q=W.getElementsByTagName,Q=r.importNode,ae={};try{ae=Ti(n).documentMode?n.documentMode:{}}catch{}var Z={};t.isSupported=typeof S=="function"&&z&&typeof z.createHTMLDocument<"u"&&ae!==9;var fe=vee,Oe=yee,be=pee,Ce=mee,k=gee,y=wee,m=See,b=bee,O=null,P=Ge({},[].concat(nn(W$),nn(jb),nn(Bb),nn(Fb),nn(U$))),A=null,B=Ge({},[].concat(nn(z$),nn(Vb),nn(G$),nn(Ov))),V=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),G=null,J=null,ee=!0,le=!0,Re=!1,ce=!0,he=!1,Y=!1,Ie=!1,ze=!1,Te=!1,$e=!1,ke=!1,C=!0,E=!1,$="user-content-",H=!0,M=!1,j={},x=null,D=Ge({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),F=null,L=Ge({},["audio","video","img","source","image","track"]),U=null,ie=Ge({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ye="http://www.w3.org/1998/Math/MathML",_e="http://www.w3.org/2000/svg",Me="http://www.w3.org/1999/xhtml",Ke=Me,ft=!1,xe=null,De=Ge({},[ye,_e,Me],Hb),tt,ot=["application/xhtml+xml","text/html"],Je="text/html",qe,Qe=null,Nt=n.createElement("form"),ht=function(N){return N instanceof RegExp||N instanceof Function},lt=function(N){Qe&&Qe===N||((!N||Xo(N)!=="object")&&(N={}),N=Ti(N),tt=ot.indexOf(N.PARSER_MEDIA_TYPE)===-1?tt=Je:tt=N.PARSER_MEDIA_TYPE,qe=tt==="application/xhtml+xml"?Hb:Oy,O="ALLOWED_TAGS"in N?Ge({},N.ALLOWED_TAGS,qe):P,A="ALLOWED_ATTR"in N?Ge({},N.ALLOWED_ATTR,qe):B,xe="ALLOWED_NAMESPACES"in N?Ge({},N.ALLOWED_NAMESPACES,Hb):De,U="ADD_URI_SAFE_ATTR"in N?Ge(Ti(ie),N.ADD_URI_SAFE_ATTR,qe):ie,F="ADD_DATA_URI_TAGS"in N?Ge(Ti(L),N.ADD_DATA_URI_TAGS,qe):L,x="FORBID_CONTENTS"in N?Ge({},N.FORBID_CONTENTS,qe):D,G="FORBID_TAGS"in N?Ge({},N.FORBID_TAGS,qe):{},J="FORBID_ATTR"in N?Ge({},N.FORBID_ATTR,qe):{},j="USE_PROFILES"in N?N.USE_PROFILES:!1,ee=N.ALLOW_ARIA_ATTR!==!1,le=N.ALLOW_DATA_ATTR!==!1,Re=N.ALLOW_UNKNOWN_PROTOCOLS||!1,ce=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,he=N.SAFE_FOR_TEMPLATES||!1,Y=N.WHOLE_DOCUMENT||!1,Te=N.RETURN_DOM||!1,$e=N.RETURN_DOM_FRAGMENT||!1,ke=N.RETURN_TRUSTED_TYPE||!1,ze=N.FORCE_BODY||!1,C=N.SANITIZE_DOM!==!1,E=N.SANITIZE_NAMED_PROPS||!1,H=N.KEEP_CONTENT!==!1,M=N.IN_PLACE||!1,b=N.ALLOWED_URI_REGEXP||b,Ke=N.NAMESPACE||Me,V=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&ht(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(V.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&ht(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(V.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(V.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),he&&(le=!1),$e&&(Te=!0),j&&(O=Ge({},nn(U$)),A=[],j.html===!0&&(Ge(O,W$),Ge(A,z$)),j.svg===!0&&(Ge(O,jb),Ge(A,Vb),Ge(A,Ov)),j.svgFilters===!0&&(Ge(O,Bb),Ge(A,Vb),Ge(A,Ov)),j.mathMl===!0&&(Ge(O,Fb),Ge(A,G$),Ge(A,Ov))),N.ADD_TAGS&&(O===P&&(O=Ti(O)),Ge(O,N.ADD_TAGS,qe)),N.ADD_ATTR&&(A===B&&(A=Ti(A)),Ge(A,N.ADD_ATTR,qe)),N.ADD_URI_SAFE_ATTR&&Ge(U,N.ADD_URI_SAFE_ATTR,qe),N.FORBID_CONTENTS&&(x===D&&(x=Ti(x)),Ge(x,N.FORBID_CONTENTS,qe)),H&&(O["#text"]=!0),Y&&Ge(O,["html","head","body"]),O.table&&(Ge(O,["tbody"]),delete G.tbody),pr&&pr(N),Qe=N)},rt=Ge({},["mi","mo","mn","ms","mtext"]),Oi=Ge({},["foreignobject","desc","title","annotation-xml"]),jo=Ge({},["title","style","font","a","script"]),Ka=Ge({},jb);Ge(Ka,Bb),Ge(Ka,hee);var Lg=Ge({},Fb);Ge(Lg,dee);var uz=function(N){var oe=S(N);(!oe||!oe.tagName)&&(oe={namespaceURI:Ke,tagName:"template"});var de=Oy(N.tagName),st=Oy(oe.tagName);return xe[N.namespaceURI]?N.namespaceURI===_e?oe.namespaceURI===Me?de==="svg":oe.namespaceURI===ye?de==="svg"&&(st==="annotation-xml"||rt[st]):Boolean(Ka[de]):N.namespaceURI===ye?oe.namespaceURI===Me?de==="math":oe.namespaceURI===_e?de==="math"&&Oi[st]:Boolean(Lg[de]):N.namespaceURI===Me?oe.namespaceURI===_e&&!Oi[st]||oe.namespaceURI===ye&&!rt[st]?!1:!Lg[de]&&(jo[de]||!Ka[de]):!!(tt==="application/xhtml+xml"&&xe[N.namespaceURI]):!1},jn=function(N){wf(t.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=R}catch{N.remove()}}},jg=function(N,oe){try{wf(t.removed,{attribute:oe.getAttributeNode(N),from:oe})}catch{wf(t.removed,{attribute:null,from:oe})}if(oe.removeAttribute(N),N==="is"&&!A[N])if(Te||$e)try{jn(oe)}catch{}else try{oe.setAttribute(N,"")}catch{}},XP=function(N){var oe,de;if(ze)N="<remove></remove>"+N;else{var st=see(N,/^[\r\n\t ]+/);de=st&&st[0]}tt==="application/xhtml+xml"&&Ke===Me&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var br=T?T.createHTML(N):N;if(Ke===Me)try{oe=new h().parseFromString(br,tt)}catch{}if(!oe||!oe.documentElement){oe=z.createDocument(Ke,"template",null);try{oe.documentElement.innerHTML=ft?R:br}catch{}}var nr=oe.body||oe.documentElement;return N&&de&&nr.insertBefore(n.createTextNode(de),nr.childNodes[0]||null),Ke===Me?q.call(oe,Y?"html":"body")[0]:Y?oe.documentElement:nr},ZP=function(N){return X.call(N.ownerDocument||N,N,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},fz=function(N){return N instanceof c&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof f)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},hf=function(N){return Xo(a)==="object"?N instanceof a:N&&Xo(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},Bn=function(N,oe,de){Z[N]&&lee(Z[N],function(st){st.call(t,oe,de,Qe)})},QP=function(N){var oe;if(Bn("beforeSanitizeElements",N,null),fz(N)||sr(/[\u0080-\uFFFF]/,N.nodeName))return jn(N),!0;var de=qe(N.nodeName);if(Bn("uponSanitizeElement",N,{tagName:de,allowedTags:O}),N.hasChildNodes()&&!hf(N.firstElementChild)&&(!hf(N.content)||!hf(N.content.firstElementChild))&&sr(/<[/\w]/g,N.innerHTML)&&sr(/<[/\w]/g,N.textContent)||de==="select"&&sr(/<template/i,N.innerHTML))return jn(N),!0;if(!O[de]||G[de]){if(!G[de]&&eT(de)&&(V.tagNameCheck instanceof RegExp&&sr(V.tagNameCheck,de)||V.tagNameCheck instanceof Function&&V.tagNameCheck(de)))return!1;if(H&&!x[de]){var st=S(N)||N.parentNode,br=w(N)||N.childNodes;if(br&&st)for(var nr=br.length,tr=nr-1;tr>=0;--tr)st.insertBefore(p(br[tr],!0),g(N))}return jn(N),!0}return N instanceof l&&!uz(N)||(de==="noscript"||de==="noembed")&&sr(/<\/no(script|embed)/i,N.innerHTML)?(jn(N),!0):(he&&N.nodeType===3&&(oe=N.textContent,oe=en(oe,fe," "),oe=en(oe,Oe," "),oe=en(oe,be," "),N.textContent!==oe&&(wf(t.removed,{element:N.cloneNode()}),N.textContent=oe)),Bn("afterSanitizeElements",N,null),!1)},JP=function(N,oe,de){if(C&&(oe==="id"||oe==="name")&&(de in n||de in Nt))return!1;if(!(le&&!J[oe]&&sr(Ce,oe))){if(!(ee&&sr(k,oe))){if(!A[oe]||J[oe]){if(!(eT(N)&&(V.tagNameCheck instanceof RegExp&&sr(V.tagNameCheck,N)||V.tagNameCheck instanceof Function&&V.tagNameCheck(N))&&(V.attributeNameCheck instanceof RegExp&&sr(V.attributeNameCheck,oe)||V.attributeNameCheck instanceof Function&&V.attributeNameCheck(oe))||oe==="is"&&V.allowCustomizedBuiltInElements&&(V.tagNameCheck instanceof RegExp&&sr(V.tagNameCheck,de)||V.tagNameCheck instanceof Function&&V.tagNameCheck(de))))return!1}else if(!U[oe]){if(!sr(b,en(de,m,""))){if(!((oe==="src"||oe==="xlink:href"||oe==="href")&&N!=="script"&&uee(de,"data:")===0&&F[N])){if(!(Re&&!sr(y,en(de,m,"")))){if(de)return!1}}}}}}return!0},eT=function(N){return N.indexOf("-")>0},tT=function(N){var oe,de,st,br;Bn("beforeSanitizeAttributes",N,null);var nr=N.attributes;if(nr){var tr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A};for(br=nr.length;br--;){oe=nr[br];var fv=oe,Xt=fv.name,Bg=fv.namespaceURI;if(de=Xt==="value"?oe.value:fee(oe.value),st=qe(Xt),tr.attrName=st,tr.attrValue=de,tr.keepAttr=!0,tr.forceKeepAttr=void 0,Bn("uponSanitizeAttribute",N,tr),de=tr.attrValue,!tr.forceKeepAttr&&(jg(Xt,N),!!tr.keepAttr)){if(!ce&&sr(/\/>/i,de)){jg(Xt,N);continue}he&&(de=en(de,fe," "),de=en(de,Oe," "),de=en(de,be," "));var rT=qe(N.nodeName);if(JP(rT,st,de)){if(E&&(st==="id"||st==="name")&&(jg(Xt,N),de=$+de),T&&Xo(d)==="object"&&typeof d.getAttributeType=="function"&&!Bg)switch(d.getAttributeType(rT,st)){case"TrustedHTML":de=T.createHTML(de);break;case"TrustedScriptURL":de=T.createScriptURL(de);break}try{Bg?N.setAttributeNS(Bg,Xt,de):N.setAttribute(Xt,de),V$(t.removed)}catch{}}}}Bn("afterSanitizeAttributes",N,null)}},cz=function Ee(N){var oe,de=ZP(N);for(Bn("beforeSanitizeShadowDOM",N,null);oe=de.nextNode();)Bn("uponSanitizeShadowNode",oe,null),!QP(oe)&&(oe.content instanceof o&&Ee(oe.content),tT(oe));Bn("afterSanitizeShadowDOM",N,null)};return t.sanitize=function(Ee){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe,de,st,br,nr;if(ft=!Ee,ft&&(Ee="<!-->"),typeof Ee!="string"&&!hf(Ee)){if(typeof Ee.toString!="function")throw Lb("toString is not a function");if(Ee=Ee.toString(),typeof Ee!="string")throw Lb("dirty is not a string, aborting")}if(!t.isSupported){if(Xo(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Ee=="string")return e.toStaticHTML(Ee);if(hf(Ee))return e.toStaticHTML(Ee.outerHTML)}return Ee}if(Ie||lt(N),t.removed=[],typeof Ee=="string"&&(M=!1),M){if(Ee.nodeName){var tr=qe(Ee.nodeName);if(!O[tr]||G[tr])throw Lb("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof a)oe=XP("<!---->"),de=oe.ownerDocument.importNode(Ee,!0),de.nodeType===1&&de.nodeName==="BODY"||de.nodeName==="HTML"?oe=de:oe.appendChild(de);else{if(!Te&&!he&&!Y&&Ee.indexOf("<")===-1)return T&&ke?T.createHTML(Ee):Ee;if(oe=XP(Ee),!oe)return Te?null:ke?R:""}oe&&ze&&jn(oe.firstChild);for(var fv=ZP(M?Ee:oe);st=fv.nextNode();)st.nodeType===3&&st===br||QP(st)||(st.content instanceof o&&cz(st.content),tT(st),br=st);if(br=null,M)return Ee;if(Te){if($e)for(nr=K.call(oe.ownerDocument);oe.firstChild;)nr.appendChild(oe.firstChild);else nr=oe;return(A.shadowroot||A.shadowrootmod)&&(nr=Q.call(r,nr,!0)),nr}var Xt=Y?oe.outerHTML:oe.innerHTML;return Y&&O["!doctype"]&&oe.ownerDocument&&oe.ownerDocument.doctype&&oe.ownerDocument.doctype.name&&sr(Cee,oe.ownerDocument.doctype.name)&&(Xt="<!DOCTYPE "+oe.ownerDocument.doctype.name+`>
`+Xt),he&&(Xt=en(Xt,fe," "),Xt=en(Xt,Oe," "),Xt=en(Xt,be," ")),T&&ke?T.createHTML(Xt):Xt},t.setConfig=function(Ee){lt(Ee),Ie=!0},t.clearConfig=function(){Qe=null,Ie=!1},t.isValidAttribute=function(Ee,N,oe){Qe||lt({});var de=qe(Ee),st=qe(N);return JP(de,st,oe)},t.addHook=function(Ee,N){typeof N=="function"&&(Z[Ee]=Z[Ee]||[],wf(Z[Ee],N))},t.removeHook=function(Ee){if(Z[Ee])return V$(Z[Ee])},t.removeHooks=function(Ee){Z[Ee]&&(Z[Ee]=[])},t.removeAllHooks=function(){Z={}},t}var Ree=RB(),Eee=Ae,Pee=UR.codeAt;Eee({target:"String",proto:!0},{codePointAt:function(t){return Pee(this,t)}});var Tee=wi,kee=Vt,$ee=Rr,Aee=RangeError,EB=function(t){var r=kee($ee(this)),n="",o=Tee(t);if(o<0||o==1/0)throw Aee("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},PB=Be,Iee=Va,Y$=Vt,Mee=EB,xee=Rr,Dee=PB(Mee),Nee=PB("".slice),Hee=Math.ceil,K$=function(e){return function(t,r,n){var o=Y$(xee(t)),i=Iee(r),a=o.length,l=n===void 0?" ":Y$(n),s,u;return i<=a||l==""?o:(s=i-a,u=Dee(l,Hee(s/l.length)),u.length>s&&(u=Nee(u,0,s)),e?o+u:u+o)}},Lee={start:K$(!1),end:K$(!0)},jee=Ha,Bee=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(jee),Fee=Ae,Vee=Lee.start,Wee=Bee;Fee({target:"String",proto:!0,forced:Wee},{padStart:function(t){return Vee(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var TB;function te(){return TB.apply(null,arguments)}function Uee(e){TB=e}function cn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function wa(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function it(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function fE(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(it(e,t))return!1;return!0}function Sr(e){return e===void 0}function Ao(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Wd(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function kB(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function Jo(e,t){for(var r in t)it(t,r)&&(e[r]=t[r]);return it(t,"toString")&&(e.toString=t.toString),it(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Hn(e,t,r,n){return JB(e,t,r,n,!0).utc()}function zee(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Fe(e){return e._pf==null&&(e._pf=zee()),e._pf}var KS;Array.prototype.some?KS=Array.prototype.some:KS=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function cE(e){if(e._isValid==null){var t=Fe(e),r=KS.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function zm(e){var t=Hn(NaN);return e!=null?Jo(Fe(t),e):Fe(t).userInvalidated=!0,t}var q$=te.momentProperties=[],Wb=!1;function hE(e,t){var r,n,o,i=q$.length;if(Sr(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Sr(t._i)||(e._i=t._i),Sr(t._f)||(e._f=t._f),Sr(t._l)||(e._l=t._l),Sr(t._strict)||(e._strict=t._strict),Sr(t._tzm)||(e._tzm=t._tzm),Sr(t._isUTC)||(e._isUTC=t._isUTC),Sr(t._offset)||(e._offset=t._offset),Sr(t._pf)||(e._pf=Fe(t)),Sr(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=q$[r],o=t[n],Sr(o)||(e[n]=o);return e}function Ud(e){hE(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Wb===!1&&(Wb=!0,te.updateOffset(this),Wb=!1)}function hn(e){return e instanceof Ud||e!=null&&e._isAMomentObject!=null}function $B(e){te.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Zr(e,t){var r=!0;return Jo(function(){if(te.deprecationHandler!=null&&te.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])it(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}$B(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var X$={};function AB(e,t){te.deprecationHandler!=null&&te.deprecationHandler(e,t),X$[e]||($B(t),X$[e]=!0)}te.suppressDeprecationWarnings=!1;te.deprecationHandler=null;function Ln(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function Gee(e){var t,r;for(r in e)it(e,r)&&(t=e[r],Ln(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function qS(e,t){var r=Jo({},e),n;for(n in t)it(t,n)&&(wa(e[n])&&wa(t[n])?(r[n]={},Jo(r[n],e[n]),Jo(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)it(e,n)&&!it(t,n)&&wa(e[n])&&(r[n]=Jo({},r[n]));return r}function dE(e){e!=null&&this.set(e)}var XS;Object.keys?XS=Object.keys:XS=function(e){var t,r=[];for(t in e)it(e,t)&&r.push(t);return r};var Yee={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Kee(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Ln(n)?n.call(t,r):n}function In(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var vE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Rv=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ub={},xl={};function Pe(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(xl[e]=o),t&&(xl[t[0]]=function(){return In(o.apply(this,arguments),t[1],t[2])}),r&&(xl[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function qee(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function Xee(e){var t=e.match(vE),r,n;for(r=0,n=t.length;r<n;r++)xl[t[r]]?t[r]=xl[t[r]]:t[r]=qee(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Ln(t[a])?t[a].call(o,e):t[a];return i}}function Ry(e,t){return e.isValid()?(t=IB(t,e.localeData()),Ub[t]=Ub[t]||Xee(t),Ub[t](e)):e.localeData().invalidDate()}function IB(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(Rv.lastIndex=0;r>=0&&Rv.test(e);)e=e.replace(Rv,n),Rv.lastIndex=0,r-=1;return e}var Zee={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Qee(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(vE).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var Jee="Invalid date";function ete(){return this._invalidDate}var tte="%d",rte=/\d{1,2}/;function nte(e){return this._ordinal.replace("%d",e)}var ote={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ite(e,t,r,n){var o=this._relativeTime[r];return Ln(o)?o(e,t,r,n):o.replace(/%d/i,e)}function ate(e,t){var r=this._relativeTime[e>0?"future":"past"];return Ln(r)?r(t):r.replace(/%s/i,t)}var Xf={};function ar(e,t){var r=e.toLowerCase();Xf[r]=Xf[r+"s"]=Xf[t]=e}function Qr(e){return typeof e=="string"?Xf[e]||Xf[e.toLowerCase()]:void 0}function yE(e){var t={},r,n;for(n in e)it(e,n)&&(r=Qr(n),r&&(t[r]=e[n]));return t}var MB={};function lr(e,t){MB[e]=t}function lte(e){var t=[],r;for(r in e)it(e,r)&&t.push({unit:r,priority:MB[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function Gm(e){return e%4===0&&e%100!==0||e%400===0}function Wr(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Ze(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Wr(t)),r}function of(e,t){return function(r){return r!=null?(xB(this,e,r),te.updateOffset(this,t),this):hp(this,e)}}function hp(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function xB(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&Gm(e.year())&&e.month()===1&&e.date()===29?(r=Ze(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),Qm(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function ste(e){return e=Qr(e),Ln(this[e])?this[e]():this}function ute(e,t){if(typeof e=="object"){e=yE(e);var r=lte(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=Qr(e),Ln(this[e]))return this[e](t);return this}var DB=/\d/,Hr=/\d\d/,NB=/\d{3}/,pE=/\d{4}/,Ym=/[+-]?\d{6}/,Ot=/\d\d?/,HB=/\d\d\d\d?/,LB=/\d\d\d\d\d\d?/,Km=/\d{1,3}/,mE=/\d{1,4}/,qm=/[+-]?\d{1,6}/,af=/\d+/,Xm=/[+-]?\d+/,fte=/Z|[+-]\d\d:?\d\d/gi,Zm=/Z|[+-]\d\d(?::?\d\d)?/gi,cte=/[+-]?\d+(\.\d{1,3})?/,zd=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,dp;dp={};function ge(e,t,r){dp[e]=Ln(t)?t:function(n,o){return n&&r?r:t}}function hte(e,t){return it(dp,e)?dp[e](t._strict,t._locale):new RegExp(dte(e))}function dte(e){return xr(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function xr(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ZS={};function yt(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),Ao(t)&&(n=function(i,a){a[t]=Ze(i)}),o=e.length,r=0;r<o;r++)ZS[e[r]]=n}function Gd(e,t){yt(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function vte(e,t,r){t!=null&&it(ZS,e)&&ZS[e](t,r._a,r,e)}var or=0,Jn=1,Tn=2,Kt=3,un=4,eo=5,zi=6,yte=7,pte=8;function mte(e,t){return(e%t+t)%t}var Lt;Array.prototype.indexOf?Lt=Array.prototype.indexOf:Lt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Qm(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=mte(t,12);return e+=(t-r)/12,r===1?Gm(e)?29:28:31-r%7%2}Pe("M",["MM",2],"Mo",function(){return this.month()+1});Pe("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Pe("MMMM",0,0,function(e){return this.localeData().months(this,e)});ar("month","M");lr("month",8);ge("M",Ot);ge("MM",Ot,Hr);ge("MMM",function(e,t){return t.monthsShortRegex(e)});ge("MMMM",function(e,t){return t.monthsRegex(e)});yt(["M","MM"],function(e,t){t[Jn]=Ze(e)-1});yt(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[Jn]=o:Fe(r).invalidMonth=e});var gte="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),jB="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),BB=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,bte=zd,wte=zd;function Ste(e,t){return e?cn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||BB).test(t)?"format":"standalone"][e.month()]:cn(this._months)?this._months:this._months.standalone}function Cte(e,t){return e?cn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[BB.test(t)?"format":"standalone"][e.month()]:cn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function _te(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Hn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Lt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Lt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Lt.call(this._shortMonthsParse,a),o!==-1?o:(o=Lt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Lt.call(this._longMonthsParse,a),o!==-1?o:(o=Lt.call(this._shortMonthsParse,a),o!==-1?o:null))}function Ote(e,t,r){var n,o,i;if(this._monthsParseExact)return _te.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=Hn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function FB(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Ze(t);else if(t=e.localeData().monthsParse(t),!Ao(t))return e}return r=Math.min(e.date(),Qm(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function VB(e){return e!=null?(FB(this,e),te.updateOffset(this,!0),this):hp(this,"Month")}function Rte(){return Qm(this.year(),this.month())}function Ete(e){return this._monthsParseExact?(it(this,"_monthsRegex")||WB.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=bte),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Pte(e){return this._monthsParseExact?(it(this,"_monthsRegex")||WB.call(this),e?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=wte),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function WB(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Hn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=xr(t[o]),r[o]=xr(r[o]);for(o=0;o<24;o++)n[o]=xr(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Pe("Y",0,0,function(){var e=this.year();return e<=9999?In(e,4):"+"+e});Pe(0,["YY",2],0,function(){return this.year()%100});Pe(0,["YYYY",4],0,"year");Pe(0,["YYYYY",5],0,"year");Pe(0,["YYYYYY",6,!0],0,"year");ar("year","y");lr("year",1);ge("Y",Xm);ge("YY",Ot,Hr);ge("YYYY",mE,pE);ge("YYYYY",qm,Ym);ge("YYYYYY",qm,Ym);yt(["YYYYY","YYYYYY"],or);yt("YYYY",function(e,t){t[or]=e.length===2?te.parseTwoDigitYear(e):Ze(e)});yt("YY",function(e,t){t[or]=te.parseTwoDigitYear(e)});yt("Y",function(e,t){t[or]=parseInt(e,10)});function Zf(e){return Gm(e)?366:365}te.parseTwoDigitYear=function(e){return Ze(e)+(Ze(e)>68?1900:2e3)};var UB=of("FullYear",!0);function Tte(){return Gm(this.year())}function kte(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function yc(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function vp(e,t,r){var n=7+t-r,o=(7+yc(e,0,n).getUTCDay()-t)%7;return-o+n-1}function zB(e,t,r,n,o){var i=(7+r-n)%7,a=vp(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=Zf(s)+l):l>Zf(e)?(s=e+1,u=l-Zf(e)):(s=e,u=l),{year:s,dayOfYear:u}}function pc(e,t,r){var n=vp(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+Eo(a,t,r)):o>Eo(e.year(),t,r)?(i=o-Eo(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function Eo(e,t,r){var n=vp(e,t,r),o=vp(e+1,t,r);return(Zf(e)-n+o)/7}Pe("w",["ww",2],"wo","week");Pe("W",["WW",2],"Wo","isoWeek");ar("week","w");ar("isoWeek","W");lr("week",5);lr("isoWeek",5);ge("w",Ot);ge("ww",Ot,Hr);ge("W",Ot);ge("WW",Ot,Hr);Gd(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Ze(e)});function $te(e){return pc(e,this._week.dow,this._week.doy).week}var Ate={dow:0,doy:6};function Ite(){return this._week.dow}function Mte(){return this._week.doy}function xte(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Dte(e){var t=pc(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Pe("d",0,"do","day");Pe("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Pe("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Pe("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Pe("e",0,0,"weekday");Pe("E",0,0,"isoWeekday");ar("day","d");ar("weekday","e");ar("isoWeekday","E");lr("day",11);lr("weekday",11);lr("isoWeekday",11);ge("d",Ot);ge("e",Ot);ge("E",Ot);ge("dd",function(e,t){return t.weekdaysMinRegex(e)});ge("ddd",function(e,t){return t.weekdaysShortRegex(e)});ge("dddd",function(e,t){return t.weekdaysRegex(e)});Gd(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:Fe(r).invalidWeekday=e});Gd(["d","e","E"],function(e,t,r,n){t[n]=Ze(e)});function Nte(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Hte(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function gE(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Lte="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),GB="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),jte="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Bte=zd,Fte=zd,Vte=zd;function Wte(e,t){var r=cn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?gE(r,this._week.dow):e?r[e.day()]:r}function Ute(e){return e===!0?gE(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function zte(e){return e===!0?gE(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Gte(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Hn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Lt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Lt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Lt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Lt.call(this._weekdaysParse,a),o!==-1||(o=Lt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Lt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Lt.call(this._shortWeekdaysParse,a),o!==-1||(o=Lt.call(this._weekdaysParse,a),o!==-1)?o:(o=Lt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Lt.call(this._minWeekdaysParse,a),o!==-1||(o=Lt.call(this._weekdaysParse,a),o!==-1)?o:(o=Lt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function Yte(e,t,r){var n,o,i;if(this._weekdaysParseExact)return Gte.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=Hn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function Kte(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Nte(e,this.localeData()),this.add(e-t,"d")):t}function qte(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Xte(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Hte(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Zte(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||bE.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=Bte),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Qte(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||bE.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Fte),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Jte(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||bE.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Vte),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function bE(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=Hn([2e3,1]).day(i),l=xr(this.weekdaysMin(a,"")),s=xr(this.weekdaysShort(a,"")),u=xr(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function wE(){return this.hours()%12||12}function ere(){return this.hours()||24}Pe("H",["HH",2],0,"hour");Pe("h",["hh",2],0,wE);Pe("k",["kk",2],0,ere);Pe("hmm",0,0,function(){return""+wE.apply(this)+In(this.minutes(),2)});Pe("hmmss",0,0,function(){return""+wE.apply(this)+In(this.minutes(),2)+In(this.seconds(),2)});Pe("Hmm",0,0,function(){return""+this.hours()+In(this.minutes(),2)});Pe("Hmmss",0,0,function(){return""+this.hours()+In(this.minutes(),2)+In(this.seconds(),2)});function YB(e,t){Pe(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}YB("a",!0);YB("A",!1);ar("hour","h");lr("hour",13);function KB(e,t){return t._meridiemParse}ge("a",KB);ge("A",KB);ge("H",Ot);ge("h",Ot);ge("k",Ot);ge("HH",Ot,Hr);ge("hh",Ot,Hr);ge("kk",Ot,Hr);ge("hmm",HB);ge("hmmss",LB);ge("Hmm",HB);ge("Hmmss",LB);yt(["H","HH"],Kt);yt(["k","kk"],function(e,t,r){var n=Ze(e);t[Kt]=n===24?0:n});yt(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});yt(["h","hh"],function(e,t,r){t[Kt]=Ze(e),Fe(r).bigHour=!0});yt("hmm",function(e,t,r){var n=e.length-2;t[Kt]=Ze(e.substr(0,n)),t[un]=Ze(e.substr(n)),Fe(r).bigHour=!0});yt("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Kt]=Ze(e.substr(0,n)),t[un]=Ze(e.substr(n,2)),t[eo]=Ze(e.substr(o)),Fe(r).bigHour=!0});yt("Hmm",function(e,t,r){var n=e.length-2;t[Kt]=Ze(e.substr(0,n)),t[un]=Ze(e.substr(n))});yt("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Kt]=Ze(e.substr(0,n)),t[un]=Ze(e.substr(n,2)),t[eo]=Ze(e.substr(o))});function tre(e){return(e+"").toLowerCase().charAt(0)==="p"}var rre=/[ap]\.?m?\.?/i,nre=of("Hours",!0);function ore(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var qB={calendar:Yee,longDateFormat:Zee,invalidDate:Jee,ordinal:tte,dayOfMonthOrdinalParse:rte,relativeTime:ote,months:gte,monthsShort:jB,week:Ate,weekdays:Lte,weekdaysMin:jte,weekdaysShort:GB,meridiemParse:rre},Rt={},Sf={},mc;function ire(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function Z$(e){return e&&e.toLowerCase().replace("_","-")}function are(e){for(var t=0,r,n,o,i;t<e.length;){for(i=Z$(e[t]).split("-"),r=i.length,n=Z$(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=Jm(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&ire(i,n)>=r-1)break;r--}t++}return mc}function lre(e){return e.match("^[^/\\\\]*$")!=null}function Jm(e){var t=null,r;if(Rt[e]===void 0&&typeof module<"u"&&module&&module.exports&&lre(e))try{t=mc._abbr,r=require,r("./locale/"+e),oi(t)}catch{Rt[e]=null}return Rt[e]}function oi(e,t){var r;return e&&(Sr(t)?r=Ho(e):r=SE(e,t),r?mc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),mc._abbr}function SE(e,t){if(t!==null){var r,n=qB;if(t.abbr=e,Rt[e]!=null)AB("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Rt[e]._config;else if(t.parentLocale!=null)if(Rt[t.parentLocale]!=null)n=Rt[t.parentLocale]._config;else if(r=Jm(t.parentLocale),r!=null)n=r._config;else return Sf[t.parentLocale]||(Sf[t.parentLocale]=[]),Sf[t.parentLocale].push({name:e,config:t}),null;return Rt[e]=new dE(qS(n,t)),Sf[e]&&Sf[e].forEach(function(o){SE(o.name,o.config)}),oi(e),Rt[e]}else return delete Rt[e],null}function sre(e,t){if(t!=null){var r,n,o=qB;Rt[e]!=null&&Rt[e].parentLocale!=null?Rt[e].set(qS(Rt[e]._config,t)):(n=Jm(e),n!=null&&(o=n._config),t=qS(o,t),n==null&&(t.abbr=e),r=new dE(t),r.parentLocale=Rt[e],Rt[e]=r),oi(e)}else Rt[e]!=null&&(Rt[e].parentLocale!=null?(Rt[e]=Rt[e].parentLocale,e===oi()&&oi(e)):Rt[e]!=null&&delete Rt[e]);return Rt[e]}function Ho(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return mc;if(!cn(e)){if(t=Jm(e),t)return t;e=[e]}return are(e)}function ure(){return XS(Rt)}function CE(e){var t,r=e._a;return r&&Fe(e).overflow===-2&&(t=r[Jn]<0||r[Jn]>11?Jn:r[Tn]<1||r[Tn]>Qm(r[or],r[Jn])?Tn:r[Kt]<0||r[Kt]>24||r[Kt]===24&&(r[un]!==0||r[eo]!==0||r[zi]!==0)?Kt:r[un]<0||r[un]>59?un:r[eo]<0||r[eo]>59?eo:r[zi]<0||r[zi]>999?zi:-1,Fe(e)._overflowDayOfYear&&(t<or||t>Tn)&&(t=Tn),Fe(e)._overflowWeeks&&t===-1&&(t=yte),Fe(e)._overflowWeekday&&t===-1&&(t=pte),Fe(e).overflow=t),e}var fre=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,cre=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,hre=/Z|[+-]\d\d(?::?\d\d)?/,Ev=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],zb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],dre=/^\/?Date\((-?\d+)/i,vre=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yre={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function XB(e){var t,r,n=e._i,o=fre.exec(n)||cre.exec(n),i,a,l,s,u=Ev.length,f=zb.length;if(o){for(Fe(e).iso=!0,t=0,r=u;t<r;t++)if(Ev[t][1].exec(o[1])){a=Ev[t][0],i=Ev[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(zb[t][1].exec(o[3])){l=(o[2]||" ")+zb[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(hre.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),OE(e)}else e._isValid=!1}function pre(e,t,r,n,o,i){var a=[mre(e),jB.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function mre(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function gre(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function bre(e,t,r){if(e){var n=GB.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return Fe(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function wre(e,t,r){if(e)return yre[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function ZB(e){var t=vre.exec(gre(e._i)),r;if(t){if(r=pre(t[4],t[3],t[2],t[5],t[6],t[7]),!bre(t[1],r,e))return;e._a=r,e._tzm=wre(t[8],t[9],t[10]),e._d=yc.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Fe(e).rfc2822=!0}else e._isValid=!1}function Sre(e){var t=dre.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(XB(e),e._isValid===!1)delete e._isValid;else return;if(ZB(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:te.createFromInputFallback(e)}te.createFromInputFallback=Zr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Rl(e,t,r){return e??t??r}function Cre(e){var t=new Date(te.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function _E(e){var t,r,n=[],o,i,a;if(!e._d){for(o=Cre(e),e._w&&e._a[Tn]==null&&e._a[Jn]==null&&_re(e),e._dayOfYear!=null&&(a=Rl(e._a[or],o[or]),(e._dayOfYear>Zf(a)||e._dayOfYear===0)&&(Fe(e)._overflowDayOfYear=!0),r=yc(a,0,e._dayOfYear),e._a[Jn]=r.getUTCMonth(),e._a[Tn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Kt]===24&&e._a[un]===0&&e._a[eo]===0&&e._a[zi]===0&&(e._nextDay=!0,e._a[Kt]=0),e._d=(e._useUTC?yc:kte).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Kt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(Fe(e).weekdayMismatch=!0)}}function _re(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=Rl(t.GG,e._a[or],pc(Ct(),1,4).year),n=Rl(t.W,1),o=Rl(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=pc(Ct(),i,a),r=Rl(t.gg,e._a[or],u.year),n=Rl(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>Eo(r,i,a)?Fe(e)._overflowWeeks=!0:s!=null?Fe(e)._overflowWeekday=!0:(l=zB(r,n,o,i,a),e._a[or]=l.year,e._dayOfYear=l.dayOfYear)}te.ISO_8601=function(){};te.RFC_2822=function(){};function OE(e){if(e._f===te.ISO_8601){XB(e);return}if(e._f===te.RFC_2822){ZB(e);return}e._a=[],Fe(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=IB(e._f,e._locale).match(vE)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(hte(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Fe(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),xl[i]?(n?Fe(e).empty=!1:Fe(e).unusedTokens.push(i),vte(i,n,e)):e._strict&&!n&&Fe(e).unusedTokens.push(i);Fe(e).charsLeftOver=l-s,t.length>0&&Fe(e).unusedInput.push(t),e._a[Kt]<=12&&Fe(e).bigHour===!0&&e._a[Kt]>0&&(Fe(e).bigHour=void 0),Fe(e).parsedDateParts=e._a.slice(0),Fe(e).meridiem=e._meridiem,e._a[Kt]=Ore(e._locale,e._a[Kt],e._meridiem),u=Fe(e).era,u!==null&&(e._a[or]=e._locale.erasConvertYear(u,e._a[or])),_E(e),CE(e)}function Ore(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Rre(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){Fe(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=hE({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],OE(t),cE(t)&&(a=!0),i+=Fe(t).charsLeftOver,i+=Fe(t).unusedTokens.length*10,Fe(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));Jo(e,r||t)}function Ere(e){if(!e._d){var t=yE(e._i),r=t.day===void 0?t.date:t.day;e._a=kB([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),_E(e)}}function Pre(e){var t=new Ud(CE(QB(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function QB(e){var t=e._i,r=e._f;return e._locale=e._locale||Ho(e._l),t===null||r===void 0&&t===""?zm({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),hn(t)?new Ud(CE(t)):(Wd(t)?e._d=t:cn(r)?Rre(e):r?OE(e):Tre(e),cE(e)||(e._d=null),e))}function Tre(e){var t=e._i;Sr(t)?e._d=new Date(te.now()):Wd(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Sre(e):cn(t)?(e._a=kB(t.slice(0),function(r){return parseInt(r,10)}),_E(e)):wa(t)?Ere(e):Ao(t)?e._d=new Date(t):te.createFromInputFallback(e)}function JB(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(wa(e)&&fE(e)||cn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,Pre(i)}function Ct(e,t,r,n){return JB(e,t,r,n,!1)}var kre=Zr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:zm()}),$re=Zr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:zm()});function eF(e,t){var r,n;if(t.length===1&&cn(t[0])&&(t=t[0]),!t.length)return Ct();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Are(){var e=[].slice.call(arguments,0);return eF("isBefore",e)}function Ire(){var e=[].slice.call(arguments,0);return eF("isAfter",e)}var Mre=function(){return Date.now?Date.now():+new Date},Cf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function xre(e){var t,r=!1,n,o=Cf.length;for(t in e)if(it(e,t)&&!(Lt.call(Cf,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[Cf[n]]){if(r)return!1;parseFloat(e[Cf[n]])!==Ze(e[Cf[n]])&&(r=!0)}return!0}function Dre(){return this._isValid}function Nre(){return vn(NaN)}function eg(e){var t=yE(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=xre(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Ho(),this._bubble()}function Ey(e){return e instanceof eg}function QS(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Hre(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Ze(e[a])!==Ze(t[a]))&&i++;return i+o}function tF(e,t){Pe(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+In(~~(r/60),2)+t+In(~~r%60,2)})}tF("Z",":");tF("ZZ","");ge("Z",Zm);ge("ZZ",Zm);yt(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=RE(Zm,e)});var Lre=/([\+\-]|\d\d)/gi;function RE(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(Lre)||["-",0,0],i=+(o[1]*60)+Ze(o[2]),i===0?0:o[0]==="+"?i:-i)}function EE(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(hn(e)||Wd(e)?e.valueOf():Ct(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),te.updateOffset(r,!1),r):Ct(e).local()}function JS(e){return-Math.round(e._d.getTimezoneOffset())}te.updateOffset=function(){};function jre(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=RE(Zm,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=JS(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?oF(this,vn(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,te.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:JS(this)}function Bre(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Fre(e){return this.utcOffset(0,e)}function Vre(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(JS(this),"m")),this}function Wre(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=RE(fte,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Ure(e){return this.isValid()?(e=e?Ct(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function zre(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Gre(){if(!Sr(this._isDSTShifted))return this._isDSTShifted;var e={},t;return hE(e,this),e=QB(e),e._a?(t=e._isUTC?Hn(e._a):Ct(e._a),this._isDSTShifted=this.isValid()&&Hre(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Yre(){return this.isValid()?!this._isUTC:!1}function Kre(){return this.isValid()?this._isUTC:!1}function rF(){return this.isValid()?this._isUTC&&this._offset===0:!1}var qre=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Xre=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function vn(e,t){var r=e,n=null,o,i,a;return Ey(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Ao(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=qre.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Ze(n[Tn])*o,h:Ze(n[Kt])*o,m:Ze(n[un])*o,s:Ze(n[eo])*o,ms:Ze(QS(n[zi]*1e3))*o}):(n=Xre.exec(e))?(o=n[1]==="-"?-1:1,r={y:ki(n[2],o),M:ki(n[3],o),w:ki(n[4],o),d:ki(n[5],o),h:ki(n[6],o),m:ki(n[7],o),s:ki(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=Zre(Ct(r.from),Ct(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new eg(r),Ey(e)&&it(e,"_locale")&&(i._locale=e._locale),Ey(e)&&it(e,"_isValid")&&(i._isValid=e._isValid),i}vn.fn=eg.prototype;vn.invalid=Nre;function ki(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function Q$(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Zre(e,t){var r;return e.isValid()&&t.isValid()?(t=EE(t,e),e.isBefore(t)?r=Q$(e,t):(r=Q$(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function nF(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(AB(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=vn(r,n),oF(this,o,e),this}}function oF(e,t,r,n){var o=t._milliseconds,i=QS(t._days),a=QS(t._months);e.isValid()&&(n=n??!0,a&&FB(e,hp(e,"Month")+a*r),i&&xB(e,"Date",hp(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&te.updateOffset(e,i||a))}var Qre=nF(1,"add"),Jre=nF(-1,"subtract");function iF(e){return typeof e=="string"||e instanceof String}function ene(e){return hn(e)||Wd(e)||iF(e)||Ao(e)||rne(e)||tne(e)||e===null||e===void 0}function tne(e){var t=wa(e)&&!fE(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||it(e,i);return t&&r}function rne(e){var t=cn(e),r=!1;return t&&(r=e.filter(function(n){return!Ao(n)&&iF(e)}).length===0),t&&r}function nne(e){var t=wa(e)&&!fE(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||it(e,i);return t&&r}function one(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function ine(e,t){arguments.length===1&&(arguments[0]?ene(arguments[0])?(e=arguments[0],t=void 0):nne(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Ct(),n=EE(r,this).startOf("day"),o=te.calendarFormat(this,n)||"sameElse",i=t&&(Ln(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,Ct(r)))}function ane(){return new Ud(this)}function lne(e,t){var r=hn(e)?e:Ct(e);return this.isValid()&&r.isValid()?(t=Qr(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function sne(e,t){var r=hn(e)?e:Ct(e);return this.isValid()&&r.isValid()?(t=Qr(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function une(e,t,r,n){var o=hn(e)?e:Ct(e),i=hn(t)?t:Ct(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function fne(e,t){var r=hn(e)?e:Ct(e),n;return this.isValid()&&r.isValid()?(t=Qr(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function cne(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function hne(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function dne(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=EE(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=Qr(t),t){case"year":i=Py(this,n)/12;break;case"month":i=Py(this,n);break;case"quarter":i=Py(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Wr(i)}function Py(e,t){if(e.date()<t.date())return-Py(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}te.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";te.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function vne(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function yne(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Ry(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ln(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ry(r,"Z")):Ry(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function pne(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function mne(e){e||(e=this.isUtc()?te.defaultFormatUtc:te.defaultFormat);var t=Ry(this,e);return this.localeData().postformat(t)}function gne(e,t){return this.isValid()&&(hn(e)&&e.isValid()||Ct(e).isValid())?vn({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function bne(e){return this.from(Ct(),e)}function wne(e,t){return this.isValid()&&(hn(e)&&e.isValid()||Ct(e).isValid())?vn({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Sne(e){return this.to(Ct(),e)}function aF(e){var t;return e===void 0?this._locale._abbr:(t=Ho(e),t!=null&&(this._locale=t),this)}var lF=Zr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function sF(){return this._locale}var yp=1e3,Dl=60*yp,pp=60*Dl,uF=(365*400+97)*24*pp;function Nl(e,t){return(e%t+t)%t}function fF(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-uF:new Date(e,t,r).valueOf()}function cF(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-uF:Date.UTC(e,t,r)}function Cne(e){var t,r;if(e=Qr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?cF:fF,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Nl(t+(this._isUTC?0:this.utcOffset()*Dl),pp);break;case"minute":t=this._d.valueOf(),t-=Nl(t,Dl);break;case"second":t=this._d.valueOf(),t-=Nl(t,yp);break}return this._d.setTime(t),te.updateOffset(this,!0),this}function _ne(e){var t,r;if(e=Qr(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?cF:fF,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=pp-Nl(t+(this._isUTC?0:this.utcOffset()*Dl),pp)-1;break;case"minute":t=this._d.valueOf(),t+=Dl-Nl(t,Dl)-1;break;case"second":t=this._d.valueOf(),t+=yp-Nl(t,yp)-1;break}return this._d.setTime(t),te.updateOffset(this,!0),this}function One(){return this._d.valueOf()-(this._offset||0)*6e4}function Rne(){return Math.floor(this.valueOf()/1e3)}function Ene(){return new Date(this.valueOf())}function Pne(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Tne(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function kne(){return this.isValid()?this.toISOString():null}function $ne(){return cE(this)}function Ane(){return Jo({},Fe(this))}function Ine(){return Fe(this).overflow}function Mne(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Pe("N",0,0,"eraAbbr");Pe("NN",0,0,"eraAbbr");Pe("NNN",0,0,"eraAbbr");Pe("NNNN",0,0,"eraName");Pe("NNNNN",0,0,"eraNarrow");Pe("y",["y",1],"yo","eraYear");Pe("y",["yy",2],0,"eraYear");Pe("y",["yyy",3],0,"eraYear");Pe("y",["yyyy",4],0,"eraYear");ge("N",PE);ge("NN",PE);ge("NNN",PE);ge("NNNN",Une);ge("NNNNN",zne);yt(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?Fe(r).era=o:Fe(r).invalidEra=e});ge("y",af);ge("yy",af);ge("yyy",af);ge("yyyy",af);ge("yo",Gne);yt(["y","yy","yyy","yyyy"],or);yt(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[or]=r._locale.eraYearOrdinalParse(e,o):t[or]=parseInt(e,10)});function xne(e,t){var r,n,o,i=this._eras||Ho("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=te(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=te(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function Dne(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function Nne(e,t){var r=e.since<=e.until?1:-1;return t===void 0?te(e.since).year():te(e.since).year()+(t-e.offset)*r}function Hne(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function Lne(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function jne(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function Bne(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-te(o[e].since).year())*r+o[e].offset;return this.year()}function Fne(e){return it(this,"_erasNameRegex")||TE.call(this),e?this._erasNameRegex:this._erasRegex}function Vne(e){return it(this,"_erasAbbrRegex")||TE.call(this),e?this._erasAbbrRegex:this._erasRegex}function Wne(e){return it(this,"_erasNarrowRegex")||TE.call(this),e?this._erasNarrowRegex:this._erasRegex}function PE(e,t){return t.erasAbbrRegex(e)}function Une(e,t){return t.erasNameRegex(e)}function zne(e,t){return t.erasNarrowRegex(e)}function Gne(e,t){return t._eraYearOrdinalRegex||af}function TE(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(xr(a[o].name)),e.push(xr(a[o].abbr)),r.push(xr(a[o].narrow)),n.push(xr(a[o].name)),n.push(xr(a[o].abbr)),n.push(xr(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Pe(0,["gg",2],0,function(){return this.weekYear()%100});Pe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function tg(e,t){Pe(0,[e,e.length],0,t)}tg("gggg","weekYear");tg("ggggg","weekYear");tg("GGGG","isoWeekYear");tg("GGGGG","isoWeekYear");ar("weekYear","gg");ar("isoWeekYear","GG");lr("weekYear",1);lr("isoWeekYear",1);ge("G",Xm);ge("g",Xm);ge("GG",Ot,Hr);ge("gg",Ot,Hr);ge("GGGG",mE,pE);ge("gggg",mE,pE);ge("GGGGG",qm,Ym);ge("ggggg",qm,Ym);Gd(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Ze(e)});Gd(["gg","GG"],function(e,t,r,n){t[n]=te.parseTwoDigitYear(e)});function Yne(e){return hF.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Kne(e){return hF.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function qne(){return Eo(this.year(),1,4)}function Xne(){return Eo(this.isoWeekYear(),1,4)}function Zne(){var e=this.localeData()._week;return Eo(this.year(),e.dow,e.doy)}function Qne(){var e=this.localeData()._week;return Eo(this.weekYear(),e.dow,e.doy)}function hF(e,t,r,n,o){var i;return e==null?pc(this,n,o).year:(i=Eo(e,n,o),t>i&&(t=i),Jne.call(this,e,t,r,n,o))}function Jne(e,t,r,n,o){var i=zB(e,t,r,n,o),a=yc(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Pe("Q",0,"Qo","quarter");ar("quarter","Q");lr("quarter",7);ge("Q",DB);yt("Q",function(e,t){t[Jn]=(Ze(e)-1)*3});function eoe(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Pe("D",["DD",2],"Do","date");ar("date","D");lr("date",9);ge("D",Ot);ge("DD",Ot,Hr);ge("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});yt(["D","DD"],Tn);yt("Do",function(e,t){t[Tn]=Ze(e.match(Ot)[0])});var dF=of("Date",!0);Pe("DDD",["DDDD",3],"DDDo","dayOfYear");ar("dayOfYear","DDD");lr("dayOfYear",4);ge("DDD",Km);ge("DDDD",NB);yt(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Ze(e)});function toe(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Pe("m",["mm",2],0,"minute");ar("minute","m");lr("minute",14);ge("m",Ot);ge("mm",Ot,Hr);yt(["m","mm"],un);var roe=of("Minutes",!1);Pe("s",["ss",2],0,"second");ar("second","s");lr("second",15);ge("s",Ot);ge("ss",Ot,Hr);yt(["s","ss"],eo);var noe=of("Seconds",!1);Pe("S",0,0,function(){return~~(this.millisecond()/100)});Pe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Pe(0,["SSS",3],0,"millisecond");Pe(0,["SSSS",4],0,function(){return this.millisecond()*10});Pe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Pe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Pe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Pe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Pe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ar("millisecond","ms");lr("millisecond",16);ge("S",Km,DB);ge("SS",Km,Hr);ge("SSS",Km,NB);var ei,vF;for(ei="SSSS";ei.length<=9;ei+="S")ge(ei,af);function ooe(e,t){t[zi]=Ze(("0."+e)*1e3)}for(ei="S";ei.length<=9;ei+="S")yt(ei,ooe);vF=of("Milliseconds",!1);Pe("z",0,0,"zoneAbbr");Pe("zz",0,0,"zoneName");function ioe(){return this._isUTC?"UTC":""}function aoe(){return this._isUTC?"Coordinated Universal Time":""}var ne=Ud.prototype;ne.add=Qre;ne.calendar=ine;ne.clone=ane;ne.diff=dne;ne.endOf=_ne;ne.format=mne;ne.from=gne;ne.fromNow=bne;ne.to=wne;ne.toNow=Sne;ne.get=ste;ne.invalidAt=Ine;ne.isAfter=lne;ne.isBefore=sne;ne.isBetween=une;ne.isSame=fne;ne.isSameOrAfter=cne;ne.isSameOrBefore=hne;ne.isValid=$ne;ne.lang=lF;ne.locale=aF;ne.localeData=sF;ne.max=$re;ne.min=kre;ne.parsingFlags=Ane;ne.set=ute;ne.startOf=Cne;ne.subtract=Jre;ne.toArray=Pne;ne.toObject=Tne;ne.toDate=Ene;ne.toISOString=yne;ne.inspect=pne;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=kne;ne.toString=vne;ne.unix=Rne;ne.valueOf=One;ne.creationData=Mne;ne.eraName=Hne;ne.eraNarrow=Lne;ne.eraAbbr=jne;ne.eraYear=Bne;ne.year=UB;ne.isLeapYear=Tte;ne.weekYear=Yne;ne.isoWeekYear=Kne;ne.quarter=ne.quarters=eoe;ne.month=VB;ne.daysInMonth=Rte;ne.week=ne.weeks=xte;ne.isoWeek=ne.isoWeeks=Dte;ne.weeksInYear=Zne;ne.weeksInWeekYear=Qne;ne.isoWeeksInYear=qne;ne.isoWeeksInISOWeekYear=Xne;ne.date=dF;ne.day=ne.days=Kte;ne.weekday=qte;ne.isoWeekday=Xte;ne.dayOfYear=toe;ne.hour=ne.hours=nre;ne.minute=ne.minutes=roe;ne.second=ne.seconds=noe;ne.millisecond=ne.milliseconds=vF;ne.utcOffset=jre;ne.utc=Fre;ne.local=Vre;ne.parseZone=Wre;ne.hasAlignedHourOffset=Ure;ne.isDST=zre;ne.isLocal=Yre;ne.isUtcOffset=Kre;ne.isUtc=rF;ne.isUTC=rF;ne.zoneAbbr=ioe;ne.zoneName=aoe;ne.dates=Zr("dates accessor is deprecated. Use date instead.",dF);ne.months=Zr("months accessor is deprecated. Use month instead",VB);ne.years=Zr("years accessor is deprecated. Use year instead",UB);ne.zone=Zr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Bre);ne.isDSTShifted=Zr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Gre);function loe(e){return Ct(e*1e3)}function soe(){return Ct.apply(null,arguments).parseZone()}function yF(e){return e}var at=dE.prototype;at.calendar=Kee;at.longDateFormat=Qee;at.invalidDate=ete;at.ordinal=nte;at.preparse=yF;at.postformat=yF;at.relativeTime=ite;at.pastFuture=ate;at.set=Gee;at.eras=xne;at.erasParse=Dne;at.erasConvertYear=Nne;at.erasAbbrRegex=Vne;at.erasNameRegex=Fne;at.erasNarrowRegex=Wne;at.months=Ste;at.monthsShort=Cte;at.monthsParse=Ote;at.monthsRegex=Pte;at.monthsShortRegex=Ete;at.week=$te;at.firstDayOfYear=Mte;at.firstDayOfWeek=Ite;at.weekdays=Wte;at.weekdaysMin=zte;at.weekdaysShort=Ute;at.weekdaysParse=Yte;at.weekdaysRegex=Zte;at.weekdaysShortRegex=Qte;at.weekdaysMinRegex=Jte;at.isPM=tre;at.meridiem=ore;function mp(e,t,r,n){var o=Ho(),i=Hn().set(n,t);return o[r](i,e)}function pF(e,t,r){if(Ao(e)&&(t=e,e=void 0),e=e||"",t!=null)return mp(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=mp(e,n,r,"month");return o}function kE(e,t,r,n){typeof e=="boolean"?(Ao(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Ao(t)&&(r=t,t=void 0),t=t||"");var o=Ho(),i=e?o._week.dow:0,a,l=[];if(r!=null)return mp(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=mp(t,(a+i)%7,n,"day");return l}function uoe(e,t){return pF(e,t,"months")}function foe(e,t){return pF(e,t,"monthsShort")}function coe(e,t,r){return kE(e,t,r,"weekdays")}function hoe(e,t,r){return kE(e,t,r,"weekdaysShort")}function doe(e,t,r){return kE(e,t,r,"weekdaysMin")}oi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Ze(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});te.lang=Zr("moment.lang is deprecated. Use moment.locale instead.",oi);te.langData=Zr("moment.langData is deprecated. Use moment.localeData instead.",Ho);var Fn=Math.abs;function voe(){var e=this._data;return this._milliseconds=Fn(this._milliseconds),this._days=Fn(this._days),this._months=Fn(this._months),e.milliseconds=Fn(e.milliseconds),e.seconds=Fn(e.seconds),e.minutes=Fn(e.minutes),e.hours=Fn(e.hours),e.months=Fn(e.months),e.years=Fn(e.years),this}function mF(e,t,r,n){var o=vn(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function yoe(e,t){return mF(this,e,t,1)}function poe(e,t){return mF(this,e,t,-1)}function J$(e){return e<0?Math.floor(e):Math.ceil(e)}function moe(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=J$(eC(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Wr(e/1e3),n.seconds=o%60,i=Wr(o/60),n.minutes=i%60,a=Wr(i/60),n.hours=a%24,t+=Wr(a/24),s=Wr(gF(t)),r+=s,t-=J$(eC(s)),l=Wr(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function gF(e){return e*4800/146097}function eC(e){return e*146097/4800}function goe(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Qr(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+gF(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(eC(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function boe(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Ze(this._months/12)*31536e6:NaN}function Lo(e){return function(){return this.as(e)}}var woe=Lo("ms"),Soe=Lo("s"),Coe=Lo("m"),_oe=Lo("h"),Ooe=Lo("d"),Roe=Lo("w"),Eoe=Lo("M"),Poe=Lo("Q"),Toe=Lo("y");function koe(){return vn(this)}function $oe(e){return e=Qr(e),this.isValid()?this[e+"s"]():NaN}function za(e){return function(){return this.isValid()?this._data[e]:NaN}}var Aoe=za("milliseconds"),Ioe=za("seconds"),Moe=za("minutes"),xoe=za("hours"),Doe=za("days"),Noe=za("months"),Hoe=za("years");function Loe(){return Wr(this.days()/7)}var qn=Math.round,Al={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function joe(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function Boe(e,t,r,n){var o=vn(e).abs(),i=qn(o.as("s")),a=qn(o.as("m")),l=qn(o.as("h")),s=qn(o.as("d")),u=qn(o.as("M")),f=qn(o.as("w")),c=qn(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,joe.apply(null,h)}function Foe(e){return e===void 0?qn:typeof e=="function"?(qn=e,!0):!1}function Voe(e,t){return Al[e]===void 0?!1:t===void 0?Al[e]:(Al[e]=t,e==="s"&&(Al.ss=t-1),!0)}function Woe(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Al,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Al,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=Boe(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var Gb=Math.abs;function el(e){return(e>0)-(e<0)||+e}function rg(){if(!this.isValid())return this.localeData().invalidDate();var e=Gb(this._milliseconds)/1e3,t=Gb(this._days),r=Gb(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Wr(e/60),o=Wr(n/60),e%=60,n%=60,i=Wr(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=el(this._months)!==el(l)?"-":"",f=el(this._days)!==el(l)?"-":"",c=el(this._milliseconds)!==el(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var et=eg.prototype;et.isValid=Dre;et.abs=voe;et.add=yoe;et.subtract=poe;et.as=goe;et.asMilliseconds=woe;et.asSeconds=Soe;et.asMinutes=Coe;et.asHours=_oe;et.asDays=Ooe;et.asWeeks=Roe;et.asMonths=Eoe;et.asQuarters=Poe;et.asYears=Toe;et.valueOf=boe;et._bubble=moe;et.clone=koe;et.get=$oe;et.milliseconds=Aoe;et.seconds=Ioe;et.minutes=Moe;et.hours=xoe;et.days=Doe;et.weeks=Loe;et.months=Noe;et.years=Hoe;et.humanize=Woe;et.toISOString=rg;et.toString=rg;et.toJSON=rg;et.locale=aF;et.localeData=sF;et.toIsoString=Zr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",rg);et.lang=lF;Pe("X",0,0,"unix");Pe("x",0,0,"valueOf");ge("x",Xm);ge("X",cte);yt("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});yt("x",function(e,t,r){r._d=new Date(Ze(e))});//! moment.js
te.version="2.29.4";Uee(Ct);te.fn=ne;te.min=Are;te.max=Ire;te.now=Mre;te.utc=Hn;te.unix=loe;te.months=uoe;te.isDate=Wd;te.locale=oi;te.invalid=zm;te.duration=vn;te.isMoment=hn;te.weekdays=coe;te.parseZone=soe;te.localeData=Ho;te.isDuration=Ey;te.monthsShort=foe;te.weekdaysMin=doe;te.defineLocale=SE;te.updateLocale=sre;te.locales=ure;te.weekdaysShort=hoe;te.normalizeUnits=Qr;te.relativeTimeRounding=Foe;te.relativeTimeThreshold=Voe;te.calendarFormat=one;te.prototype=ne;te.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Uoe=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));function ct(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=ir(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var e1,t1,r1,n1,o1,i1;function Hl(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function tC(e){return tC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tC(e)}function jt(e){var t;switch(tC(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function pe(e){return typeof e<"u"}function mt(e){return typeof e>"u"}function qt(e){return e===null||e===""||mt(e)}function zoe(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var zf="length",Qf=function(t){return parseInt(t,16)},a1=function(t){return parseInt(t,10)},gp=function(t,r,n){return t.substr(r,n)},Jf=function(t){return t.codePointAt(0)-65},rC=function(t){return"".concat(t).replace(/\-/g,"")},Goe=function(t){return Qf(gp(rC(t),Qf("12"),Jf("F")))/(Qf(gp(rC(t),Jf("B"),~~![][zf]))||9)},Yoe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},l1=!1,s1={invalid:function(){return ct(e1||(e1=Hl([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ct(t1||(t1=Hl([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return ct(r1||(r1=Hl([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},u1={invalid:function(){return ct(n1||(n1=Hl([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return ct(o1||(o1=Hl([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return ct(i1||(i1=Hl([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function Koe(e,t){var r=!qt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="12.3.1",i,a="invalid",l="invalid";e=rC(e||"");var s=qoe(e);if(r||n||s)if(s){var u=te("06/02/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=Goe(e);i=te((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(Yoe()&&(a="valid",l="valid"),!l1&&a!=="valid"){var h=s1[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](s1[a]({keyValidityDate:i,hotVersion:o})),l1=!0}if(l!=="valid"&&t.parentNode){var d=u1[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=u1[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function qoe(e){var t=[][zf],r=t;if(e[zf]!==Jf("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=Jf(o.shift());i;i=Jf(o.shift()||"A"))--i<""[zf]?r=r|(a1("".concat(a1(Qf(n)+(Qf(gp(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=gp(e,i,i?o[zf]===1?9:8:6);return r===t}function Po(e){return e[0].toUpperCase()+e.substr(1)}function bF(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function wF(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function SF(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function f1(e){return $E("".concat(e),{ALLOWED_TAGS:[]})}function $E(e,t){return Ree.sanitize(e,t)}function c1(e){return Joe(e)||Qoe(e)||Zoe(e)||Xoe()}function Xoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zoe(e,t){if(e){if(typeof e=="string")return nC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nC(e,t)}}function Qoe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Joe(e){if(Array.isArray(e))return nC(e)}function nC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eie(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function tie(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function bp(e){return tie(e)&&e.parent}function Sa(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function Pv(e,t,r){for(var n=[],o=e;o&&(o=Sa(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function Ca(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function rie(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function $i(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var oC,iC,aC;function Tv(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(eJ()){var h1=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};oC=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},iC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Tv(o),o.length>0)if(h1(n)){var i;(i=t.classList).add.apply(i,c1(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},aC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Tv(o),o.length>0)if(h1(n)){var i;(i=t.classList).remove.apply(i,c1(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var Yb=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};oC=function(t,r){return t.className!==void 0&&Yb(r).test(t.className)},iC=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=Tv(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!Yb(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},aC=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=Tv(i);i[n];)o=o.replace(Yb(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function Ne(e,t){return oC(e,t)}function re(e,t){iC(e,t)}function He(e,t){aC(e,t)}function CF(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)CF(t[r])}function Io(e){for(var t;t=e.lastChild;)e.removeChild(t)}var nie=/(<(.*)>|&(.*);)/;function Yd(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;nie.test(t)?e.innerHTML=r?$E(t):t:Ra(e,t)}function Ra(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?tJ?r.textContent=t:r.data=t:(Io(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function gc(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return gc(r.host.impl);if(r.host)return gc(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Ut(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(pB()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function bc(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Xl(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function wp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?bc(t):e.scrollTop}function lC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Xl(t):e.scrollLeft}function Sp(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=rJ(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function wc(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ea(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function Sc(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Ea(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function Ea(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function vt(e){return e.offsetWidth}function kt(e){return pB()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function ti(e){return e.clientHeight||e.innerHeight}function Ty(e){return e.clientWidth||e.innerWidth}function _F(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function oie(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function iie(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function d1(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function ng(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var Kb;function aie(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Jt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Kb===void 0&&(Kb=aie(e)),Kb}function lie(e){return e.offsetWidth!==e.clientWidth}function sie(e){return e.offsetHeight!==e.clientHeight}function AE(e,t,r){XJ()?(e.style.top=r,e.style.left=t):YJ()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function og(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Cp(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function IE(e){return Cp(e)&&e.hasAttribute("data-hot-input")===!1}function uie(e){var t=e.ownerDocument.activeElement;IE(t)||e.select()}function OF(e){return!e.parentNode}function fie(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}function wt(e){return typeof e=="function"}function RF(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function EF(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function cie(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function sC(e,t,r,n,o,i,a,l){return pe(l)?e.call(t,r,n,o,i,a,l):pe(a)?e.call(t,r,n,o,i,a):pe(i)?e.call(t,r,n,o,i):pe(o)?e.call(t,r,n,o):pe(n)?e.call(t,r,n):pe(r)?e.call(t,r):e.call(t)}function dt(){if(pe(console)){var e;(e=console).warn.apply(e,arguments)}}function ME(){if(pe(console)){var e;(e=console).error.apply(e,arguments)}}var hie=Be,v1=VR,kv=_a.getWeakData,die=BR,vie=Dt,yie=dn,qb=Ft,pie=jR,PF=Wa,y1=$t,TF=Do,mie=TF.set,gie=TF.getterFor,bie=PF.find,wie=PF.findIndex,Sie=hie([].splice),Cie=0,$v=function(e){return e.frozen||(e.frozen=new kF)},kF=function(){this.entries=[]},Xb=function(e,t){return bie(e.entries,function(r){return r[0]===t})};kF.prototype={get:function(e){var t=Xb(this,e);if(t)return t[1]},has:function(e){return!!Xb(this,e)},set:function(e,t){var r=Xb(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=wie(this.entries,function(r){return r[0]===e});return~t&&Sie(this.entries,t,1),!!~t}};var $F={getConstructor:function(e,t,r,n){var o=e(function(s,u){die(s,i),mie(s,{type:t,id:Cie++,frozen:void 0}),yie(u)||pie(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=gie(t),l=function(s,u,f){var c=a(s),h=kv(vie(u),!0);return h===!0?$v(c).set(u,f):h[c.id]=f,s};return v1(i,{delete:function(s){var u=a(this);if(!qb(s))return!1;var f=kv(s);return f===!0?$v(u).delete(s):f&&y1(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!qb(u))return!1;var c=kv(u);return c===!0?$v(f).has(u):c&&y1(c,f.id)}}),v1(i,r?{get:function(u){var f=a(this);if(qb(u)){var c=kv(u);return c===!0?$v(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},_ie=$R,p1=gt,ky=Be,m1=VR,Oie=_a,Rie=Nm,AF=$F,Av=Ft,Iv=Do.enforce,Eie=je,Pie=CL,Kd=Object,Tie=Array.isArray,Mv=Kd.isExtensible,IF=Kd.isFrozen,kie=Kd.isSealed,MF=Kd.freeze,$ie=Kd.seal,g1={},b1={},Aie=!p1.ActiveXObject&&"ActiveXObject"in p1,_f,xF=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},DF=Rie("WeakMap",xF,AF),El=DF.prototype,$y=ky(El.set),Iie=function(){return _ie&&Eie(function(){var e=MF([]);return $y(new DF,e,1),!IF(e)})};if(Pie)if(Aie){_f=AF.getConstructor(xF,"WeakMap",!0),Oie.enable();var w1=ky(El.delete),xv=ky(El.has),S1=ky(El.get);m1(El,{delete:function(e){if(Av(e)&&!Mv(e)){var t=Iv(this);return t.frozen||(t.frozen=new _f),w1(this,e)||t.frozen.delete(e)}return w1(this,e)},has:function(t){if(Av(t)&&!Mv(t)){var r=Iv(this);return r.frozen||(r.frozen=new _f),xv(this,t)||r.frozen.has(t)}return xv(this,t)},get:function(t){if(Av(t)&&!Mv(t)){var r=Iv(this);return r.frozen||(r.frozen=new _f),xv(this,t)?S1(this,t):r.frozen.get(t)}return S1(this,t)},set:function(t,r){if(Av(t)&&!Mv(t)){var n=Iv(this);n.frozen||(n.frozen=new _f),xv(this,t)?$y(this,t,r):n.frozen.set(t,r)}else $y(this,t,r);return this}})}else Iie()&&m1(El,{set:function(t,r){var n;return Tie(t)&&(IF(t)?n=g1:kie(t)&&(n=b1)),$y(this,t,r),n==g1&&MF(t),n==b1&&$ie(t),this}});var we={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Nb()?182:174,AUDIO_MUTE:Nb()?181:173,AUDIO_UP:Nb()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Mie=[we.ALT,we.ARROW_DOWN,we.ARROW_LEFT,we.ARROW_RIGHT,we.ARROW_UP,we.AUDIO_DOWN,we.AUDIO_MUTE,we.AUDIO_UP,we.BACKSPACE,we.CAPS_LOCK,we.DELETE,we.END,we.ENTER,we.ESCAPE,we.F1,we.F2,we.F3,we.F4,we.F5,we.F6,we.F7,we.F8,we.F9,we.F10,we.F11,we.F12,we.F13,we.F14,we.F15,we.F16,we.F17,we.F18,we.F19,we.HOME,we.INSERT,we.MEDIA_NEXT,we.MEDIA_PLAY_PAUSE,we.MEDIA_PREV,we.MEDIA_STOP,we.NULL,we.NUM_LOCK,we.PAGE_DOWN,we.PAGE_UP,we.PAUSE,we.SCROLL_LOCK,we.SHIFT,we.TAB];function xie(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function NF(e){return Mie.includes(e)}function Die(e){return[we.CONTROL,we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX].includes(e)}function Cc(e,t){var r=t.split("|"),n=!1;return I(r,function(o){if(e===we[o])return n=!0,!1}),n}function Mn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Pl(e){return e.isImmediatePropagationEnabled===!1}function Pa(e){return e.button===2}function xE(e){return e.button===0}function _c(e){return _c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_c(e)}var C1;function Nie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lie(n.key),n)}}function Hie(e,t,r){return t&&_1(e.prototype,t),r&&_1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lie(e){var t=jie(e,"string");return _c(t)==="symbol"?t:String(t)}function jie(e,t){if(_c(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_c(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bie(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var tl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Fie=ct(C1||(C1=Bie([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Zb=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Qb=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),HF=function(){function e(){Nie(this,e),this.globalBucket=this.createEmptyBucket()}return Hie(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return I(tl,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))I(n,function(s){return o.add(r,s,i)});else{Zb.has(r)&&dt(SF(Fie,{hookName:r,removedInVersion:Zb.get(r)})),Qb.has(r)&&dt(Qb.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&I(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?I(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=sC(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],p=v?v.length:0,g=0;if(p)for(;g<p;){if(!v[g]||v[g].skip){g+=1;continue}var w=sC(v[g],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[g]&&v[g].runOnce&&this.remove(n,v[g],r),g+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ye(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||tl.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&tl.splice(tl.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Qb.has(r)||Zb.has(r)}},{key:"isRegistered",value:function(r){return tl.indexOf(r)>=0}},{key:"getRegistered",value:function(){return tl}}],[{key:"getSingleton",value:function(){return Wie()}}]),e}(),Vie=new HF;function Wie(){return Vie}const me=HF;function O1(e){return Yie(e)||Gie(e)||zie(e)||Uie()}function Uie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zie(e,t){if(e){if(typeof e=="string")return uC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uC(e,t)}}function Gie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Yie(e){if(Array.isArray(e))return uC(e)}function uC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Jb=new Map;function Jr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Jb.has(e)||Jb.set(e,new Map);var t=Jb.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return O1(t.keys())}function a(){return O1(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var fC=new WeakMap,qd=Jr("editors"),Kie=qd.register,LF=qd.getItem,jF=qd.hasItem;qd.getNames;qd.getValues;function qie(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},me.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function BF(e,t){var r;if(typeof e=="function")fC.get(e)||FF(null,e),r=fC.get(e);else if(typeof e=="string")r=LF(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function R1(e){if(typeof e=="function")return e;if(!jF(e))throw Error('No registered editor found under "'.concat(e,'" name'));return LF(e).getConstructor()}function FF(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new qie(t);typeof e=="string"&&Kie(e,r),fC.set(t,r)}function Oc(e){return Oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oc(e)}function Xie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qie(n.key),n)}}function Zie(e,t,r){return t&&E1(e.prototype,t),r&&E1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qie(e){var t=Jie(e,"string");return Oc(t)==="symbol"?t:String(t)}function Jie(e,t){if(Oc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eae=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Xie(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return Zie(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,tae(s))}return typeof a!="boolean"&&!iJ()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function tae(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Mn(this)},e}const At=eae;function Rc(e){return Rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rc(e)}function rae(e,t){return aae(e)||iae(e,t)||oae(e,t)||nae()}function nae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oae(e,t){if(e){if(typeof e=="string")return P1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P1(e,t)}}function P1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function aae(e){if(Array.isArray(e))return e}function lae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uae(n.key),n)}}function sae(e,t,r){return t&&T1(e.prototype,t),r&&T1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uae(e){var t=fae(e,"string");return Rc(t)==="symbol"?t:String(t)}function fae(e,t){if(Rc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ig="editorManager.navigation",ec="editorManager.handlingEditor",cC=function(){function e(t,r,n){var o=this;lae(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new At(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return sae(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:ec};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),Mn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(p){p&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=rae(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&IE(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=BF(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!NF(o)&&!Die(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return pe(n.instance.getSelected())},group:ig};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),k1=new WeakMap;cC.getInstance=function(e,t,r){var n=k1.get(e);return n||(n=new cC(e,t,r),k1.set(e,n)),n};const cae=cC;var hae=Ae,dae=Er,VF=Ad,vae=je,yae=vae(function(){VF(1)});hae({target:"Object",stat:!0,forced:yae},{keys:function(t){return VF(dae(t))}});var pae=Gt,mae=Fm,gae=Dt,bae=dn,wae=Va,ew=Vt,Sae=Rr,Cae=ja,_ae=QR,$1=Vm;mae("match",function(e,t,r){return[function(o){var i=Sae(this),a=bae(o)?void 0:Cae(o,e);return a?pae(a,o,i):new RegExp(o)[e](ew(i))},function(n){var o=gae(this),i=ew(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return $1(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=$1(o,i))!==null;){var c=ew(f[0]);s[u]=c,c===""&&(o.lastIndex=_ae(i,wae(o.lastIndex),l)),u++}return u===0?null:s}]});var Oae=Ua,Rae=Nr,Eae=wi,Pae=Xr,Tae=nf,kae=Math.min,hC=[].lastIndexOf,WF=!!hC&&1/[1].lastIndexOf(1,-0)<0,$ae=Tae("lastIndexOf"),Aae=WF||!$ae,Iae=Aae?function(t){if(WF)return Oae(hC,this,arguments)||0;var r=Rae(this),n=Pae(r),o=n-1;for(arguments.length>1&&(o=kae(o,Eae(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:hC,Mae=Ae,A1=Iae;Mae({target:"Array",proto:!0,forced:A1!==[].lastIndexOf},{lastIndexOf:A1});var xae=La,Dae=Er,Nae=_d,Hae=Xr,Lae=TypeError,I1=function(e){return function(t,r,n,o){xae(r);var i=Dae(t),a=Nae(i),l=Hae(i),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw Lae("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},jae={left:I1(!1),right:I1(!0)},Bae=Ae,Fae=jae.left,Vae=nf,M1=Od,Wae=oB,Uae=!Wae&&M1>79&&M1<83,zae=Uae||!Vae("reduce");Bae({target:"Array",proto:!0,forced:zae},{reduce:function(t){var r=arguments.length;return Fae(this,t,r,r>1?arguments[1]:void 0)}});var Gae=Ae,Yae=Wa.findIndex,Kae=Ld,dC="findIndex",UF=!0;dC in[]&&Array(1)[dC](function(){UF=!1});Gae({target:"Array",proto:!0,forced:UF},{findIndex:function(t){return Yae(this,t,arguments.length>1?arguments[1]:void 0)}});Kae(dC);function tw(e){return Qae(e)||Zae(e)||Xae(e)||qae()}function qae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xae(e,t){if(e){if(typeof e=="string")return vC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vC(e,t)}}function Zae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qae(e){if(Array.isArray(e))return vC(e)}function vC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var zF={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Jae=new RegExp(Object.keys(zF).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function ele(e){return(e&&e.nodeName||"")==="TABLE"}function x1(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],p=0;p<a;p+=1){var g=!d&&r&&p===0,w="";if(d)w="<th>".concat(e.getColHeader(p-f),"</th>");else if(g)w="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][p],_=e.getCellMeta(h-c,p-f),T=_.hidden,R=_.rowspan,W=_.colspan;if(!T){var z=[];if(R&&z.push('rowspan="'.concat(R,'"')),W&&z.push('colspan="'.concat(W,'"')),qt(S))w="<td ".concat(z.join(" "),"></td>");else{var X=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(z.join(" "),">").concat(X,"</td>")}}}v.push(w)}var K=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,K):u.splice(-1,0,K)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function D1(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=qt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function tle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(O){var P=O.match(/<td\b[^>]*?>/g)[0],A=O.substring(P.length,O.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),B="</td>";return"".concat(P).concat(A).concat(B)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!ele(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(O,P){return O+P.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,p=0;if(i.tHead){var g=Array.from(i.tHead.rows).filter(function(O){var P=O.querySelector("td")!==null;return P&&h.push(O),!P});v=g.length,d=v>0,v>1?r.nestedHeaders=Array.from(g).reduce(function(O,P){var A=Array.from(P.cells).reduce(function(B,V,G){if(s&&G===0)return B;var J=V.colSpan,ee=V.innerHTML,le=J>1?{label:ee,colspan:J}:ee;return B.push(le),B},[]);return O.push(A),O},[]):d&&(r.colHeaders=Array.from(g[0].children).reduce(function(O,P,A){return s&&A===0||O.push(P.innerHTML),O},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var w=[].concat(h,tw(Array.from(i.tBodies).reduce(function(O,P){return O.push.apply(O,tw(Array.from(P.rows))),O},[])),tw(c));p=w.length;for(var S=new Array(p),_=0;_<p;_++)S[_]=new Array(f);for(var T=[],R=[],W=0;W<p;W++)for(var z=w[W],X=Array.from(z.cells),K=X.length,q=0;q<K;q++){var Q=X[q],ae=Q.nodeName,Z=Q.innerHTML,fe=Q.rowSpan,Oe=Q.colSpan,be=S[W].findIndex(function(O){return O===void 0});if(ae==="TD"){if(fe>1||Oe>1){for(var Ce=W;Ce<W+fe;Ce++)if(Ce<p)for(var k=be;k<be+Oe;k++)S[Ce][k]=null;var y=Q.getAttribute("style"),m=y&&y.includes("mso-ignore:colspan");m||T.push({col:be,row:W,rowspan:fe,colspan:Oe})}var b="";l&&/excel/gi.test(l.content)?b=Z.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):b=Z.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[W][be]=b.replace(Jae,function(O){return zF[O]})}else R.push(Z)}return T.length&&(r.mergeCells=T),R.length&&(r.rowHeaders=R),S.length&&(r.data=S),r}}function rle(e){return ale(e)||ile(e)||ole(e)||nle()}function nle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ole(e,t){if(e){if(typeof e=="string")return yC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yC(e,t)}}function ile(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ale(e){if(Array.isArray(e))return yC(e)}function yC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pC(e){return pC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pC(e)}function Ur(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=pC(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(rle(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function lle(e){return Ur(e,[","])}function Se(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function mC(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function GF(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function sle(e){return cle(e)||fle(e)||YF(e)||ule()}function ule(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cle(e){if(Array.isArray(e))return gC(e)}function hle(e,t){return yle(e)||vle(e,t)||YF(e,t)||dle()}function dle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YF(e,t){if(e){if(typeof e=="string")return gC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gC(e,t)}}function gC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function yle(e){if(Array.isArray(e))return e}var bC="asc",ple="desc",N1=new Map([[bC,[-1,1]],[ple,[1,-1]]]),mle=function(t){return"The priority '".concat(t,"' is already declared in a map.")},gle=function(t){return"The priority '".concat(t,"' is not a number.")};function ble(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=wt(t)?t:mle,r=wt(r)?r:gle;function o(a,l){if(!Ur(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bC,l=N1.get(a)||N1.get(bC),s=hle(l,2),u=s[0],f=s[1];return sle(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}var wle=Ae,Sle=Wa.find,Cle=Ld,wC="find",KF=!0;wC in[]&&Array(1)[wC](function(){KF=!1});wle({target:"Array",proto:!0,forced:KF},{find:function(t){return Sle(this,t,arguments.length>1?arguments[1]:void 0)}});Cle(wC);function _le(e){return Ele(e)||Rle(e)||qF(e)||Ole()}function Ole(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ele(e){if(Array.isArray(e))return SC(e)}function H1(e,t){return kle(e)||Tle(e,t)||qF(e,t)||Ple()}function Ple(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qF(e,t){if(e){if(typeof e=="string")return SC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SC(e,t)}}function SC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function kle(e){if(Array.isArray(e))return e}var $le=function(t){return"The id '".concat(t,"' is already declared in a map.")};function ag(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=wt(t)?t:$le;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var p=H1(v,2),g=p[0],w=p[1];return f===w?g:!1})||[null],h=H1(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return _le(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function Ale(e){return Dle(e)||xle(e)||Mle(e)||Ile()}function Ile(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mle(e,t){if(e){if(typeof e=="string")return CC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CC(e,t)}}function xle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dle(e){if(Array.isArray(e))return CC(e)}function CC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Nle=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function Hle(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=wt(t)?t:Nle;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return Ale(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function Lle(e,t){return Fle(e)||Ble(e,t)||XF(e,t)||jle()}function jle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ble(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Fle(e){if(Array.isArray(e))return e}function L1(e){return Ule(e)||Wle(e)||XF(e)||Vle()}function Vle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XF(e,t){if(e){if(typeof e=="string")return _C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _C(e,t)}}function Wle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ule(e){if(Array.isArray(e))return _C(e)}function _C(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var DE=function(t){return'There is already registered "'.concat(t,'" plugin.')},zle=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},Gle=function(t){return'The priority "'.concat(t,'" is not a number.')},ZF=ble({errorPriorityExists:zle,errorPriorityNaN:Gle}),QF=Hle({errorItemExists:DE}),OC=ag({errorIdExists:DE});function JF(){return[].concat(L1(ZF.getItems()),L1(QF.getItems()))}function NE(e){var t=Po(e);return OC.getItem(t)}function Yle(e){return!!NE(e)}function nt(e,t,r){var n=qle(e,t,r),o=Lle(n,3);e=o[0],t=o[1],r=o[2],NE(e)===void 0&&Kle(e,t,r)}function Kle(e,t,r){var n=Po(e);if(OC.hasItem(n))throw new Error(DE(n));r===void 0?QF.addItem(n):ZF.addItem(r,n),OC.addItem(n,t)}function qle(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var Xd=Jr("renderers"),Xle=Xd.register,Zle=Xd.getItem,eV=Xd.hasItem;Xd.getNames;Xd.getValues;function j1(e){if(typeof e=="function")return e;if(!eV(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Zle(e)}function Yn(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),Xle(e,t)}var Zd=Jr("validators"),Qle=Zd.register,Jle=Zd.getItem,tV=Zd.hasItem;Zd.getNames;Zd.getValues;function ese(e){if(typeof e=="function")return e;if(!tV(e))throw Error('No registered validator found under "'.concat(e,'" name'));return Jle(e)}function tse(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),Qle(e,t)}var Ui=1,Gr=2;function Ec(e){return Ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ec(e)}function rse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ose(n.key),n)}}function nse(e,t,r){return t&&B1(e.prototype,t),r&&B1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ose(e){var t=ise(e,"string");return Ec(t)==="symbol"?t:String(t)}function ise(e,t){if(Ec(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ec(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rl=new WeakMap,ase=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(c){return c}:u;rse(this,e),rl.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return nse(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=rl.get(this),l=a.calculationType,s=a.overrideFn,u=a.scrollOffset,f=a.totalColumns,c=a.viewportWidth,h=0;h<f;h++){i=this._getColumnWidth(h),r<=u&&l!==Gr&&(this.startColumn=h);var d=u>0?c+1:c;if(r>=u&&r+(l===Gr?i:0)<=u+d&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=h),this.endColumn=h),o.push(r),r+=i,l!==Gr&&(this.endColumn=h),r>=u+c){n=!1;break}}if(this.endColumn===f-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var v=o[this.endColumn]+i-o[this.startColumn-1];if((v<=c||l!==Gr)&&(this.startColumn-=1),v>c)break}l===Ui&&this.startColumn!==null&&s&&s(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=rl.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=rl.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=rl.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=rl.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const HE=ase;function Pc(e){return Pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pc(e)}function lse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,use(n.key),n)}}function sse(e,t,r){return t&&F1(e.prototype,t),r&&F1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function use(e){var t=fse(e,"string");return Pc(t)==="symbol"?t:String(t)}function fse(e,t){if(Pc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var V1=new WeakMap,cse=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;lse(this,e),V1.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return sse(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i=V1.get(this),a=i.calculationType,l=i.overrideFn,s=i.rowHeightFn,u=i.scrollOffset,f=i.totalRows,c=i.viewportHeight,h=i.horizontalScrollbarHeight||0,d,v=0;v<f;v++)if(d=s(v),isNaN(d)&&(d=e.DEFAULT_HEIGHT),r<=u&&a!==Gr&&(this.startRow=v),r>=u&&r+(a===Gr?d:0)<=u+c-h&&(this.startRow===null&&(this.startRow=v),this.endRow=v),o.push(r),r+=d,a!==Gr&&(this.endRow=v),r>=u+c-h){n=!1;break}if(this.endRow===f-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var p=o[this.endRow]+d-o[this.startRow-1];if((p<=c-h||a!==Gr)&&(this.startRow-=1),p>=c-h)break}a===Ui&&this.startRow!==null&&l&&l(this),this.startPosition=o[this.startRow],this.startPosition===void 0&&(this.startPosition=null),f<this.endRow&&(this.endRow=f-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const rV=cse;function Tc(e){return Tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tc(e)}function hse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nV(n.key),n)}}function dse(e,t,r){return t&&W1(e.prototype,t),r&&W1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vse(e,t,r){yse(e,t),t.set(e,r)}function yse(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U1(e,t,r){return t=nV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nV(e){var t=pse(e,"string");return Tc(t)==="symbol"?t:String(t)}function pse(e,t){if(Tc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Of(e,t){var r=oV(e,t,"get");return mse(e,r)}function mse(e,t){return t.get?t.get.call(e):t.value}function gse(e,t,r){var n=oV(e,t,"set");return bse(e,n,r),r}function oV(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function bse(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ai=new WeakMap,wse=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;hse(this,e),U1(this,"row",null),U1(this,"col",null),vse(this,Ai,{writable:!0,value:!1}),gse(this,Ai,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return dse(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Of(this,Ai)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Of(this,Ai)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Of(this,Ai)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Of(this,Ai)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Of(this,Ai))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const _p=wse;function kc(e){return kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kc(e)}function Sse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iV(n.key),n)}}function Cse(e,t,r){return t&&z1(e.prototype,t),r&&z1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _se(e,t,r){Ose(e,t),t.set(e,r)}function Ose(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rw(e,t,r){return t=iV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iV(e){var t=Rse(e,"string");return kc(t)==="symbol"?t:String(t)}function Rse(e,t){if(kc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pn(e,t){var r=aV(e,t,"get");return Ese(e,r)}function Ese(e,t){return t.get?t.get.call(e):t.value}function Pse(e,t,r){var n=aV(e,t,"set");return Tse(e,n,r),r}function aV(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Tse(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var jr=new WeakMap,kse=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Sse(this,e),rw(this,"highlight",null),rw(this,"from",null),rw(this,"to",null),_se(this,jr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),Pse(this,jr,o)}return Cse(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return pn(this,jr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return pn(this,jr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return pn(this,jr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return pn(this,jr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return pn(this,jr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return pn(this,jr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return pn(this,jr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return pn(this,jr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof _p))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,pn(this,jr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new _p(r,n,pn(this,jr))}}]),e}();const LE=kse;var $se=Ae,Ase=xR;$se({target:"Object",stat:!0},{setPrototypeOf:Ase});var lV=Be,Ise=La,Mse=Ft,xse=$t,G1=Nd,Dse=wd,sV=Function,Nse=lV([].concat),Hse=lV([].join),nw={},Lse=function(e,t,r){if(!xse(nw,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";nw[t]=sV("C,a","return new C("+Hse(n,",")+")")}return nw[t](e,r)},jse=Dse?sV.bind:function(t){var r=Ise(this),n=r.prototype,o=G1(arguments,1),i=function(){var l=Nse(o,G1(arguments));return this instanceof i?Lse(r,l.length,l):r.apply(t,l)};return Mse(n)&&(i.prototype=n),i},Bse=Ae,Fse=xo,ow=Ua,Vse=jse,Y1=mB,Wse=Dt,K1=Ft,Use=ef,uV=je,jE=Fse("Reflect","construct"),zse=Object.prototype,Gse=[].push,fV=uV(function(){function e(){}return!(jE(function(){},[],e)instanceof e)}),cV=!uV(function(){jE(function(){})}),q1=fV||cV;Bse({target:"Reflect",stat:!0,forced:q1,sham:q1},{construct:function(t,r){Y1(t),Wse(r);var n=arguments.length<3?t:Y1(arguments[2]);if(cV&&!fV)return jE(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return ow(Gse,o,r),new(ow(Vse,t,o))}var i=n.prototype,a=Use(K1(i)?i:zse),l=ow(t,a,r);return K1(l)?l:a}});function $c(e){return $c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$c(e)}function Yse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qse(n.key),n)}}function Kse(e,t,r){return t&&X1(e.prototype,t),r&&X1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qse(e){var t=Xse(e,"string");return $c(t)==="symbol"?t:String(t)}function Xse(e,t){if($c(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($c(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nl=new WeakMap,Zse=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Yse(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,nl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return Kse(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};$n()?n():(yB()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=nl.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=Pv(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):Ne(r,"wtBorder")&&Ne(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):Ne(r,"wtBorder")&&Ne(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=nl.get(this),o=this.domBindings.rootDocument.activeElement,i=EF(eie,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);Ne(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=Pv(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&Ca(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=Pv(r.target,["TD","TH"],n),i=Pv(r.relatedTarget,["TD","TH"],n);o&&o!==i&&Ca(o,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o)}}},{key:"onMouseUp",value:function(r){var n=nl.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(Ne(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=nl.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=pe(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];CB()&&(zJ()||GJ())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=nl.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const hV=Zse;function Ac(e){return Ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ac(e)}function Qse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eue(n.key),n)}}function Jse(e,t,r){return t&&Z1(e.prototype,t),r&&Z1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eue(e){var t=tue(e,"string");return Ac(t)==="symbol"?t:String(t)}function tue(e,t){if(Ac(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ac(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rue=function(){function e(t,r,n){Qse(this,e),this.offset=t,this.total=r,this.countTH=n}return Jse(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const nue=rue;function Ic(e){return Ic=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ic(e)}function oue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aue(n.key),n)}}function iue(e,t,r){return t&&Q1(e.prototype,t),r&&Q1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aue(e){var t=lue(e,"string");return Ic(t)==="symbol"?t:String(t)}function lue(e,t){if(Ic(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ic(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sue=function(){function e(t,r,n){oue(this,e),this.offset=t,this.total=r,this.countTH=n}return iue(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const uue=sue;var fue=0,Op=1,Rp=2;function Mc(e){return Mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mc(e)}function cue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,due(n.key),n)}}function hue(e,t,r){return t&&J1(e.prototype,t),r&&J1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function due(e){var t=vue(e,"string");return Mc(t)==="symbol"?t:String(t)}function vue(e,t){if(Mc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eA=function(){function e(){cue(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return hue(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function xc(e){return xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xc(e)}function yue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mue(n.key),n)}}function pue(e,t,r){return t&&tA(e.prototype,t),r&&tA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mue(e){var t=gue(e,"string");return xc(t)==="symbol"?t:String(t)}function gue(e,t){if(xc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bue=function(){function e(){yue(this,e),this.size=new eA,this.workingSpace=fue,this.sharedSize=null}return pue(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof eA}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=Op,r.workingSpace=Rp,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=Rp,r.workingSpace=Op,this.sharedSize=r.getViewSize()}}]),e}();function Dc(e){return Dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dc(e)}function wue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cue(n.key),n)}}function Sue(e,t,r){return t&&rA(e.prototype,t),r&&rA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cue(e){var t=_ue(e,"string");return Dc(t)==="symbol"?t:String(t)}function _ue(e,t){if(Dc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dV=function(){function e(t,r,n){wue(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new bue,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return Sue(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(Op))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(Rp)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(Op);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Rp)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Zl(e){return Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zl(e)}function Oue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eue(n.key),n)}}function Rue(e,t,r){return t&&nA(e.prototype,t),r&&nA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eue(e){var t=Pue(e,"string");return Zl(t)==="symbol"?t:String(t)}function Pue(e,t){if(Zl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RC(e,t)}function RC(e,t){return RC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RC(e,t)}function kue(e){var t=Iue();return function(){var n=Ep(e),o;if(t){var i=Ep(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $ue(this,o)}}function $ue(e,t){if(t&&(Zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Aue(e)}function Aue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ep(e){return Ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ep(e)}var vV=function(e){Tue(r,e);var t=kue(r);function r(){return Oue(this,r),t.apply(this,arguments)}return Rue(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(dV);function Nc(e){return Nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nc(e)}function Mue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Due(n.key),n)}}function xue(e,t,r){return t&&oA(e.prototype,t),r&&oA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Due(e){var t=Nue(e,"string");return Nc(t)==="symbol"?t:String(t)}function Nue(e,t){if(Nc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hue=function(){function e(t){Mue(this,e),this.nodeType=t.toUpperCase()}return xue(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function Hc(e){return Hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hc(e)}function Lue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bue(n.key),n)}}function jue(e,t,r){return t&&iA(e.prototype,t),r&&iA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bue(e){var t=Fue(e,"string");return Hc(t)==="symbol"?t:String(t)}function Fue(e,t){if(Hc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qd=function(){function e(t,r){Lue(this,e),this.nodesPool=typeof t=="string"?new Hue(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return jue(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function Ql(e){return Ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ql(e)}function Vue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uue(n.key),n)}}function Wue(e,t,r){return t&&aA(e.prototype,t),r&&aA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uue(e){var t=zue(e,"string");return Ql(t)==="symbol"?t:String(t)}function zue(e,t){if(Ql(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ql(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EC(e,t)}function EC(e,t){return EC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},EC(e,t)}function Yue(e){var t=Xue();return function(){var n=Pp(e),o;if(t){var i=Pp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Kue(this,o)}}function Kue(e,t){if(t&&(Ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return que(e)}function que(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pp(e){return Pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pp(e)}var Zue=function(e){Gue(r,e);var t=Yue(r);function r(){var n;return Vue(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Wue(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new vV(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<l;p++){d.render();var g=d.getCurrentNode();g.className="",g.removeAttribute("style"),a[p](c,g,p)}d.end()}}}]),r}(Qd);function Jl(e){return Jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jl(e)}function Que(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,efe(n.key),n)}}function Jue(e,t,r){return t&&lA(e.prototype,t),r&&lA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function efe(e){var t=tfe(e,"string");return Jl(t)==="symbol"?t:String(t)}function tfe(e,t){if(Jl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PC(e,t)}function PC(e,t){return PC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PC(e,t)}function nfe(e){var t=afe();return function(){var n=Tp(e),o;if(t){var i=Tp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ofe(this,o)}}function ofe(e,t){if(t&&(Jl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ife(e)}function ife(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function afe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tp(e){return Tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tp(e)}var lfe=function(e){rfe(r,e);var t=nfe(r);function r(n){return Que(this,r),t.call(this,null,n)}return Jue(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&Io(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(Qd);function es(e){return es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},es(e)}function sfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ffe(n.key),n)}}function ufe(e,t,r){return t&&sA(e.prototype,t),r&&sA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ffe(e){var t=cfe(e,"string");return es(t)==="symbol"?t:String(t)}function cfe(e,t){if(es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TC(e,t)}function TC(e,t){return TC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},TC(e,t)}function dfe(e){var t=pfe();return function(){var n=kp(e),o;if(t){var i=kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vfe(this,o)}}function vfe(e,t){if(t&&(es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yfe(e)}function yfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kp(e){return kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kp(e)}var mfe=function(e){hfe(r,e);var t=dfe(r);function r(n){return sfe(this,r),t.call(this,null,n)}return ufe(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&re(d,"rowHeader")}}]),r}(Qd);function ts(e){return ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ts(e)}var uA;function gfe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sfe(n.key),n)}}function wfe(e,t,r){return t&&fA(e.prototype,t),r&&fA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sfe(e){var t=Cfe(e,"string");return ts(t)==="symbol"?t:String(t)}function Cfe(e,t){if(ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _fe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kC(e,t)}function kC(e,t){return kC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kC(e,t)}function Ofe(e){var t=Pfe();return function(){var n=$p(e),o;if(t){var i=$p(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Rfe(this,o)}}function Rfe(e,t){if(t&&(ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Efe(e)}function Efe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $p(e){return $p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$p(e)}var cA=!1,Tfe=function(e){_fe(r,e);var t=Ofe(r);function r(n){var o;return bfe(this,r),o=t.call(this,"TR",n),o.orderView=new dV(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return wfe(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!cA&&o>1e3&&(cA=!0,dt(ct(uA||(uA=gfe([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(Qd);function rs(e){return rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rs(e)}function kfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Afe(n.key),n)}}function $fe(e,t,r){return t&&hA(e.prototype,t),r&&hA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Afe(e){var t=Ife(e,"string");return rs(t)==="symbol"?t:String(t)}function Ife(e,t){if(rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$C(e,t)}function $C(e,t){return $C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$C(e,t)}function xfe(e){var t=Hfe();return function(){var n=Ap(e),o;if(t){var i=Ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Dfe(this,o)}}function Dfe(e,t){if(t&&(rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nfe(e)}function Nfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ap(e){return Ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ap(e)}var Lfe=function(e){Mfe(r,e);var t=xfe(r);function r(){var n;return kfe(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return $fe(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new vV(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var p=h.getCurrentNode(),g=this.table.renderedColumnToSource(v);Ne(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),this.table.cellRenderer(f,g,p)}h.end()}}}]),r}(Qd);function Lc(e){return Lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(e)}function jfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ffe(n.key),n)}}function Bfe(e,t,r){return t&&dA(e.prototype,t),r&&dA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ffe(e){var t=Vfe(e,"string");return Lc(t)==="symbol"?t:String(t)}function Vfe(e,t){if(Lc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wfe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;jfe(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Bfe(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function jc(e){return jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jc(e)}function Ufe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gfe(n.key),n)}}function zfe(e,t,r){return t&&vA(e.prototype,t),r&&vA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gfe(e){var t=Yfe(e,"string");return jc(t)==="symbol"?t:String(t)}function Yfe(e,t){if(jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kfe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;Ufe(this,e),this.renderer=new Wfe(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Zue,columnHeaders:new lfe(n),colGroup:new mfe(o),rows:new Tfe(i),cells:new Lfe}),this.renderer.setAxisUtils(a,l)}return zfe(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function Bc(e){return Bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bc(e)}function qfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zfe(n.key),n)}}function Xfe(e,t,r){return t&&yA(e.prototype,t),r&&yA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zfe(e){var t=Qfe(e,"string");return Bc(t)==="symbol"?t:String(t)}function Qfe(e,t){if(Bc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jfe=function(){function e(t,r){qfe(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return Xfe(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Jt():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function Fc(e){return Fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fc(e)}function ece(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rce(n.key),n)}}function tce(e,t,r){return t&&pA(e.prototype,t),r&&pA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rce(e){var t=nce(e,"string");return Fc(t)==="symbol"?t:String(t)}function nce(e,t){if(Fc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oce=function(){function e(t,r){ece(this,e),this.dataAccessObject=t,this.wtSettings=r}return tce(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function Vc(e){return Vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vc(e)}function ice(e){return sce(e)||lce(e)||yV(e)||ace()}function ace(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sce(e){if(Array.isArray(e))return AC(e)}function uce(e,t){return hce(e)||cce(e,t)||yV(e,t)||fce()}function fce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yV(e,t){if(e){if(typeof e=="string")return AC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AC(e,t)}}function AC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hce(e){if(Array.isArray(e))return e}function dce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pV(n.key),n)}}function vce(e,t,r){return t&&mA(e.prototype,t),r&&mA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mn(e,t,r){return t=pV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pV(e){var t=yce(e,"string");return Vc(t)==="symbol"?t:String(t)}function yce(e,t){if(Vc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pce=function(){function e(t,r,n,o,i){var a=this;dce(this,e),mn(this,"wtSettings",null),mn(this,"domBindings",void 0),mn(this,"TBODY",null),mn(this,"THEAD",null),mn(this,"COLGROUP",null),mn(this,"hasTableHeight",!0),mn(this,"hasTableWidth",!0),mn(this,"isTableVisible",!1),mn(this,"tableOffset",0),mn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,CF(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new oce(this.dataAccessObject,this.wtSettings),this.columnUtils=new Jfe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Kfe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return vce(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ne(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ne(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ne(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Ut(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var p=i.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,g!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Ut(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new uue(w,l,h),this.columnFilter=new nue(S,s,f);var _=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var T={};this.wtSettings.getSetting("beforeDraw",!0,T),_=T.skipRender!==!0}if(_){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(kn)||this.is(ii))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var R;if(this.isMaster&&(R=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(kn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var W=vt(this.hider),z=vt(this.TABLE);W!==0&&z!==W&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),R!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(kn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var X=!1;return this.isMaster&&(X=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(X=i.bottomOverlay.resetFixedPosition()||X),X=i.inlineStartOverlay.resetFixedPosition()||X,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),X?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=ti(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(kn))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)He(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,p=0;p<v;p++)l.includes(d[p])||l.push(d[p]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var g=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(g))for(var w=0;w<g.length;w++)l.push(g[w]);for(var S=l.length,_=0;_<S;_++)this.removeClassFromCells(l[_])}for(var T=0;T<a;T++)i[T].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=uce(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Sa(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=rie(o),l=n.cellIndex;if($i($a,n,this.wtRootElement)||$i(Ta,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if($i(ii,n,this.wtRootElement)||$i(kn,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return $i($a,n,this.wtRootElement)||$i(ka,n,this.wtRootElement)||$i(ii,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=ti(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=ti(u):a=ti(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return vt(this.TABLE)}},{key:"getHeight",value:function(){return kt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=vt(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=kt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return gc(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=wt(r)?r():null;return Array.isArray(n)?(n=ice(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const lf=pce;var mce="stickyRowsBottom",mV={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};No(mV,"MIXIN_NAME",mce,{writable:!1,enumerable:!1});const gV=mV;var gce="stickyColumnsStart",bV={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};No(bV,"MIXIN_NAME",gce,{writable:!1,enumerable:!1});const BE=bV;function ns(e){return ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ns(e)}function gA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wce(n.key),n)}}function bce(e,t,r){return t&&gA(e.prototype,t),r&&gA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wce(e){var t=Sce(e,"string");return ns(t)==="symbol"?t:String(t)}function Sce(e,t){if(ns(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ns(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _ce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IC(e,t)}function IC(e,t){return IC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},IC(e,t)}function Oce(e){var t=Pce();return function(){var n=Ip(e),o;if(t){var i=Ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Rce(this,o)}}function Rce(e,t){if(t&&(ns(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ece(e)}function Ece(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ip(e){return Ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ip(e)}var FE=function(e){_ce(r,e);var t=Oce(r);function r(n,o,i,a){return Cce(this,r),t.call(this,n,o,i,a,ii)}return bce(r)}(lf);bt(FE,gV);bt(FE,BE);const Tce=FE;var Ta="top",kn="bottom",ka="inline_start",$a="top_inline_start_corner",ii="bottom_inline_start_corner",kce=[Ta,kn,ka,$a,ii],$ce=new Map([[Ta,"ht_clone_".concat(Ta)],[kn,"ht_clone_".concat(kn)],[ka,"ht_clone_".concat(ka," ht_clone_left")],[$a,"ht_clone_".concat($a," ht_clone_top_left_corner")],[ii,"ht_clone_".concat(ii," ht_clone_bottom_left_corner")]]);function Wc(e){return Wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wc(e)}function Ace(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wV(n.key),n)}}function Ice(e,t,r){return t&&bA(e.prototype,t),r&&bA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iw(e,t,r){return t=wV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wV(e){var t=Mce(e,"string");return Wc(t)==="symbol"?t:String(t)}function Mce(e,t){if(Wc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xce=function(){function e(t){Ace(this,e),iw(this,"dataAccessObject",void 0),iw(this,"lastScrolledColumnPos",-1),iw(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return Ice(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var p=!1;return s===-1?p=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(p=v.scrollTo(r,f?r>u:o)),p&&(this.lastScrolledRowPos=r),p}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=Ut(o.wtRootElement),c=ti(o.hider),h=ti(s),d=wp(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var p=a;p>0;p--)if(v+=n.sumCellSizes(p-1,p),f.top+c-v<=d){u=p;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=wp(l,l);if(u.top>f){for(var c=ti(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=Ty(o.hider),c=Ty(l),h=Math.abs(lC(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getLastVisibleColumn();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=Math.abs(lC(l,l));if(u.left>f){for(var c=Ty(l),h=i.getRowHeaderWidth(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.left+h-f>=c){s=d-2;break}}}return s}}]),e}();const Dce=xce;function Uc(e){return Uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uc(e)}function Nce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SV(n.key),n)}}function Hce(e,t,r){return t&&wA(e.prototype,t),r&&wA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tn(e,t,r){return t=SV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SV(e){var t=Lce(e,"string");return Uc(t)==="symbol"?t:String(t)}function Lce(e,t){if(Uc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VE=function(){function e(t,r){Nce(this,e),tn(this,"wtTable",void 0),tn(this,"wtScroll",void 0),tn(this,"wtViewport",void 0),tn(this,"wtOverlays",void 0),tn(this,"selections",void 0),tn(this,"wtEvent",void 0),tn(this,"guid","wt_".concat(bF())),tn(this,"drawInterrupted",!1),tn(this,"drawn",!1),tn(this,"domBindings",void 0),tn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Dce(this.createScrollDao())}return Hce(e,[{key:"eventManager",get:function(){return new At(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){Ra(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new _p(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new LE(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function os(e){return os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},os(e)}function SA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CV(n.key),n)}}function jce(e,t,r){return t&&SA(e.prototype,t),r&&SA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MC(e,t)}function MC(e,t){return MC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MC(e,t)}function Vce(e){var t=Uce();return function(){var n=Mp(e),o;if(t){var i=Mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Wce(this,o)}}function Wce(e,t){if(t&&(os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ay(e)}function Ay(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mp(e){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mp(e)}function CA(e,t,r){return t=CV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CV(e){var t=zce(e,"string");return os(t)==="symbol"?t:String(t)}function zce(e,t){if(os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gce=function(e){Fce(r,e);var t=Vce(r);function r(n,o,i){var a;Bce(this,r),a=t.call(this,n,o),CA(Ay(a),"cloneSource",void 0),CA(Ay(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",Ay(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new hV(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return jce(r)}(VE);function zc(e){return zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zc(e)}function Yce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_V(n.key),n)}}function Kce(e,t,r){return t&&_A(e.prototype,t),r&&_A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qce(e,t,r){return t=_V(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _V(e){var t=Xce(e,"string");return zc(t)==="symbol"?t:String(t)}function Xce(e,t){if(zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jd=function(){function e(t,r,n,o,i){Yce(this,e),qce(this,"wtSettings",null),No(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=wc(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return Kce(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=wc(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Sp(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){dt("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Jt())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(kce.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat($ce.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ta||u==="vertical"&&this.type===ka?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Sp(r.TABLE),new Gce(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;I([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function is(e){return is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},is(e)}function Iy(e,t,r){return OV()?Iy=Reflect.construct.bind():Iy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&xp(u,a.prototype),u},Iy.apply(null,arguments)}function Zce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jce(n.key),n)}}function Qce(e,t,r){return t&&OA(e.prototype,t),r&&OA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jce(e){var t=ehe(e,"string");return is(t)==="symbol"?t:String(t)}function ehe(e,t){if(is(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(is(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function the(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xp(e,t)}function xp(e,t){return xp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xp(e,t)}function rhe(e){var t=OV();return function(){var n=Dp(e),o;if(t){var i=Dp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nhe(this,o)}}function nhe(e,t){if(t&&(is(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ohe(e)}function ohe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dp(e){return Dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dp(e)}var ihe=function(e){the(r,e);var t=rhe(r);function r(n,o,i,a,l,s){var u;return Zce(this,r),u=t.call(this,n,o,ii,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return Qce(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Iy(Tce,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else og(i),this.repositionOverlay();var s=kt(this.clone.wtTable.TABLE),u=vt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}}]),r}(Jd),ahe="calculatedColumns",RV={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};No(RV,"MIXIN_NAME",ahe,{writable:!1,enumerable:!1});const WE=RV;function as(e){return as=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},as(e)}function RA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,she(n.key),n)}}function lhe(e,t,r){return t&&RA(e.prototype,t),r&&RA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function she(e){var t=uhe(e,"string");return as(t)==="symbol"?t:String(t)}function uhe(e,t){if(as(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(as(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function che(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xC(e,t)}function xC(e,t){return xC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xC(e,t)}function hhe(e){var t=yhe();return function(){var n=Np(e),o;if(t){var i=Np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dhe(this,o)}}function dhe(e,t){if(t&&(as(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vhe(e)}function vhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Np(e){return Np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Np(e)}var UE=function(e){che(r,e);var t=hhe(r);function r(n,o,i,a){return fhe(this,r),t.call(this,n,o,i,a,kn)}return lhe(r)}(lf);bt(UE,gV);bt(UE,WE);const phe=UE;function ls(e){return ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ls(e)}function My(e,t,r){return PV()?My=Reflect.construct.bind():My=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Hp(u,a.prototype),u},My.apply(null,arguments)}function mhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TV(n.key),n)}}function ghe(e,t,r){return t&&EA(e.prototype,t),r&&EA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hp(e,t)}function Hp(e,t){return Hp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Hp(e,t)}function whe(e){var t=PV();return function(){var n=Lp(e),o;if(t){var i=Lp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return She(this,o)}}function She(e,t){if(t&&(ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EV(e)}function EV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lp(e){return Lp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lp(e)}function Che(e,t,r){return t=TV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TV(e){var t=_he(e,"string");return ls(t)==="symbol"?t:String(t)}function _he(e,t){if(ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ohe=function(e){bhe(r,e);var t=whe(r);function r(n,o,i,a){var l;return mhe(this,r),l=t.call(this,n,o,kn,i,a),Che(EV(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return ghe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return My(phe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Xl(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=Jt(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var p=kt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(p=0),h.height="".concat(p,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return wp(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=Ne(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(re(u,"innerBorderBottom"),s=!f):(He(u,"innerBorderBottom"),s=f)}return s}}]),r}(Jd),Rhe="calculatedRows",kV={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};No(kV,"MIXIN_NAME",Rhe,{writable:!1,enumerable:!1});const $V=kV;function ss(e){return ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ss(e)}function PA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Phe(n.key),n)}}function Ehe(e,t,r){return t&&PA(e.prototype,t),r&&PA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Phe(e){var t=The(e,"string");return ss(t)==="symbol"?t:String(t)}function The(e,t){if(ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function khe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $he(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DC(e,t)}function DC(e,t){return DC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},DC(e,t)}function Ahe(e){var t=xhe();return function(){var n=jp(e),o;if(t){var i=jp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ihe(this,o)}}function Ihe(e,t){if(t&&(ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mhe(e)}function Mhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jp(e){return jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jp(e)}var zE=function(e){$he(r,e);var t=Ahe(r);function r(n,o,i,a){return khe(this,r),t.call(this,n,o,i,a,ka)}return Ehe(r)}(lf);bt(zE,$V);bt(zE,BE);const Dhe=zE;function us(e){return us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},us(e)}function xy(e,t,r){return AV()?xy=Reflect.construct.bind():xy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Bp(u,a.prototype),u},xy.apply(null,arguments)}function Nhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lhe(n.key),n)}}function Hhe(e,t,r){return t&&TA(e.prototype,t),r&&TA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lhe(e){var t=jhe(e,"string");return us(t)==="symbol"?t:String(t)}function jhe(e,t){if(us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bp(e,t)}function Bp(e,t){return Bp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Bp(e,t)}function Fhe(e){var t=AV();return function(){var n=Fp(e),o;if(t){var i=Fp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vhe(this,o)}}function Vhe(e,t){if(t&&(us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Whe(e)}function Whe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fp(e){return Fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fp(e)}var Uhe=function(e){Bhe(r,e);var t=Fhe(r);function r(n,o,i,a){return Nhe(this,r),t.call(this,n,o,ka,i,a)}return Hhe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return xy(Dhe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),AE(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),og(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,bc(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=vt(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(lC(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?He(i,"emptyRows"):re(i,"emptyRows");var u=!1;if(l&&!a.length)re(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=Ne(i,"innerBorderInlineStart");o?(re(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(He(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(Jd),zhe="stickyRowsTop",IV={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};No(IV,"MIXIN_NAME",zhe,{writable:!1,enumerable:!1});const MV=IV;function fs(e){return fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fs(e)}function kA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yhe(n.key),n)}}function Ghe(e,t,r){return t&&kA(e.prototype,t),r&&kA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yhe(e){var t=Khe(e,"string");return fs(t)==="symbol"?t:String(t)}function Khe(e,t){if(fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NC(e,t)}function NC(e,t){return NC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},NC(e,t)}function Zhe(e){var t=ede();return function(){var n=Vp(e),o;if(t){var i=Vp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qhe(this,o)}}function Qhe(e,t){if(t&&(fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jhe(e)}function Jhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ede(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vp(e){return Vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vp(e)}var GE=function(e){Xhe(r,e);var t=Zhe(r);function r(n,o,i,a){return qhe(this,r),t.call(this,n,o,i,a,$a)}return Ghe(r)}(lf);bt(GE,MV);bt(GE,BE);const tde=GE;function cs(e){return cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cs(e)}function Dy(e,t,r){return xV()?Dy=Reflect.construct.bind():Dy=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Wp(u,a.prototype),u},Dy.apply(null,arguments)}function rde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DV(n.key),n)}}function nde(e,t,r){return t&&$A(e.prototype,t),r&&$A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ode(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wp(e,t)}function Wp(e,t){return Wp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Wp(e,t)}function ide(e){var t=xV();return function(){var n=Up(e),o;if(t){var i=Up(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ade(this,o)}}function ade(e,t){if(t&&(cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HC(e)}function HC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Up(e){return Up=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Up(e)}function AA(e,t,r){return t=DV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DV(e){var t=lde(e,"string");return cs(t)==="symbol"?t:String(t)}function lde(e,t){if(cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sde=function(e){ode(r,e);var t=ide(r);function r(n,o,i,a,l,s){var u;return rde(this,r),u=t.call(this,n,o,$a,i,a),AA(HC(u),"topOverlay",void 0),AA(HC(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return nde(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Dy(tde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();AE(o,"".concat(i,"px"),"".concat(a,"px"))}else og(o);var l=kt(this.clone.wtTable.TABLE),s=vt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(Jd);function hs(e){return hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hs(e)}function IA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fde(n.key),n)}}function ude(e,t,r){return t&&IA(e.prototype,t),r&&IA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fde(e){var t=cde(e,"string");return hs(t)==="symbol"?t:String(t)}function cde(e,t){if(hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LC(e,t)}function LC(e,t){return LC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LC(e,t)}function vde(e){var t=mde();return function(){var n=zp(e),o;if(t){var i=zp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yde(this,o)}}function yde(e,t){if(t&&(hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pde(e)}function pde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zp(e){return zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zp(e)}var YE=function(e){dde(r,e);var t=vde(r);function r(n,o,i,a){return hde(this,r),t.call(this,n,o,i,a,Ta)}return ude(r)}(lf);bt(YE,MV);bt(YE,WE);const gde=YE;function ds(e){return ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ds(e)}function Ny(e,t,r){return HV()?Ny=Reflect.construct.bind():Ny=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Gp(u,a.prototype),u},Ny.apply(null,arguments)}function bde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LV(n.key),n)}}function wde(e,t,r){return t&&MA(e.prototype,t),r&&MA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gp(e,t)}function Gp(e,t){return Gp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Gp(e,t)}function Cde(e){var t=HV();return function(){var n=Yp(e),o;if(t){var i=Yp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _de(this,o)}}function _de(e,t){if(t&&(ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NV(e)}function NV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yp(e){return Yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yp(e)}function Ode(e,t,r){return t=LV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LV(e){var t=Rde(e,"string");return ds(t)==="symbol"?t:String(t)}function Rde(e,t){if(ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ede=function(e){Sde(r,e);var t=Cde(r);function r(n,o,i,a){var l;return bde(this,r),l=t.call(this,n,o,Ta,i,a),Ode(NV(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return wde(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Ny(gde,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),AE(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),og(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Xl(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=kt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=Jt(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),p=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(p-v,p),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return wp(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?He(a,"emptyColumns"):re(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=Ne(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(re(a,"innerBorderTop"),s=!h):(He(a,"innerBorderTop"),s=h)}}return s}}]),r}(Jd);function Gc(e){return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(e)}function Zo(e,t,r){return Pde()?Zo=Reflect.construct.bind():Zo=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&jC(u,a.prototype),u},Zo.apply(null,arguments)}function Pde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jC(e,t){return jC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jC(e,t)}function Tde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jV(n.key),n)}}function kde(e,t,r){return t&&xA(e.prototype,t),r&&xA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vn(e,t,r){return t=jV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jV(e){var t=$de(e,"string");return Gc(t)==="symbol"?t:String(t)}function $de(e,t){if(Gc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ade=function(){function e(t,r,n,o,i,a){var l=this;Tde(this,e),Vn(this,"wot",null),Vn(this,"topOverlay",null),Vn(this,"bottomOverlay",null),Vn(this,"inlineStartOverlay",null),Vn(this,"topInlineStartCornerOverlay",null),Vn(this,"bottomInlineStartCornerOverlay",null),Vn(this,"browserLineHeight",void 0),Vn(this,"wtSettings",null),Vn(this,"resizeObserver",new ResizeObserver(function(h){lE(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Jt(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:Sp(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return kde(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=Zo(Ede,r),this.bottomOverlay=Zo(Ohe,r),this.inlineStartOverlay=Zo(Uhe,r),this.topInlineStartCornerOverlay=Zo(sde,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=Zo(ihe,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!SB())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var p=v.clone.wtTable.holder;r.eventManager.addEventListener(p,"wheel",function(g){return r.onCloneWheel(g,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=Cc(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Sp(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,p=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<p,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return I(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];I(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const Ide=Ade;function Yc(e){return Yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yc(e)}function Mde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BV(n.key),n)}}function xde(e,t,r){return t&&DA(e.prototype,t),r&&DA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NA(e,t,r){return t=BV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BV(e){var t=Dde(e,"string");return Yc(t)==="symbol"?t:String(t)}function Dde(e,t){if(Yc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nde=function(){function e(t){var r=this;Mde(this,e),NA(this,"settings",{}),NA(this,"defaults",Object.freeze(this.getDefaults())),Ye(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return xde(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);Ra(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?Ye(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function vs(e){return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vs(e)}function Hde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jde(n.key),n)}}function Lde(e,t,r){return t&&HA(e.prototype,t),r&&HA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jde(e){var t=Bde(e,"string");return vs(t)==="symbol"?t:String(t)}function Bde(e,t){if(vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BC(e,t)}function BC(e,t){return BC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},BC(e,t)}function Vde(e){var t=zde();return function(){var n=Kp(e),o;if(t){var i=Kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Wde(this,o)}}function Wde(e,t){if(t&&(vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ude(e)}function Ude(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kp(e){return Kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kp(e)}var KE=function(e){Fde(r,e);var t=Vde(r);function r(n,o,i,a){return Hde(this,r),t.call(this,n,o,i,a,"master")}return Lde(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=wc(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=Sc(o,"height",i),u=Sc(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,p=d.height,g=["auto","hidden","scroll"];if(l&&g.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var S=parseInt(Ea(w,i).height,10);l.removeChild(w),S===0&&(p=0)}p=Math.min(p,h),f.height=s==="auto"?"auto":"".concat(p,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:p>0,this.hasTableWidth=v>0}this.isTableVisible=gc(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(lf);bt(KE,$V);bt(KE,WE);const Gde=KE;function Kc(e){return Kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(e)}function Yde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qde(n.key),n)}}function Kde(e,t,r){return t&&LA(e.prototype,t),r&&LA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qde(e){var t=Xde(e,"string");return Kc(t)==="symbol"?t:String(t)}function Xde(e,t){if(Kc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zde=function(){function e(t,r,n,o,i){var a=this;Yde(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return Kde(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=kt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,p;if(u)return vt(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(p=Sc(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(v,a.clientWidth);var g=r.getSetting("stretchH");return g==="none"||!g?Math.max(v,vt(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Ut(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=kt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=vt(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ui,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Ui?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;s<0&&(s=0);var u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Jt(this.domBindings.rootDocument),new rV({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ui,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,a<0&&(a=0);var l=n.getSetting("fixedColumnsStart");if(l){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Jt(this.domBindings.rootDocument)),new HE({viewportSize:i,scrollOffset:Math.abs(a),totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)}})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(Gr),i=this.createColumnsCalculator(Gr);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Ui),this.columnsRenderCalculator=this.createColumnsCalculator(Ui)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Gr),this.columnsVisibleCalculator=this.createColumnsCalculator(Gr)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow;if(n===null&&o===null)return!1;var i=this.rowsRenderCalculator,a=i.startRow,l=i.endRow;return n<a||n===a&&n>0?!1:!(o>l||o===l&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn;if(n===null&&o===null)return!1;var i=this.columnsRenderCalculator,a=i.startColumn,l=i.endColumn;return n<a||n===a&&n>0?!1:!(o>l||o===l&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Ye(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const Qde=Zde;function ys(e){return ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ys(e)}function Jde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tve(n.key),n)}}function eve(e,t,r){return t&&jA(e.prototype,t),r&&jA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tve(e){var t=rve(e,"string");return ys(t)==="symbol"?t:String(t)}function rve(e,t){if(ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FC(e,t)}function FC(e,t){return FC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FC(e,t)}function ove(e){var t=ave();return function(){var n=qp(e),o;if(t){var i=qp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ive(this,o)}}function ive(e,t){if(t&&(ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VC(e)}function VC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ave(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qp(e){return qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qp(e)}var lve=function(e){nve(r,e);var t=ove(r);function r(n,o){var i;Jde(this,r),i=t.call(this,n,new Nde(o));var a=i.wtSettings.getSetting("facade",VC(i));return i.wtTable=new Gde(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new Qde(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new hV(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Ide(VC(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return eve(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];Ye(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),He(this.wtTable.wtRootElement.parentNode,a),re(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(VE);function qc(e){return qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(e)}function sve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fve(n.key),n)}}function uve(e,t,r){return t&&BA(e.prototype,t),r&&BA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fve(e){var t=cve(e,"string");return qc(t)==="symbol"?t:String(t)}function cve(e,t){if(qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hve=function(){function e(t){sve(this,e),t instanceof VE?this._wot=t:this._initFromSettings(t)}return uve(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new lve(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),dve=Bt,FV=Be,vve=Ad,yve=Nr,pve=Sd.f,mve=FV(pve),gve=FV([].push),FA=function(e){return function(t){for(var r=yve(t),n=vve(r),o=n.length,i=0,a=[],l;o>i;)l=n[i++],(!dve||mve(r,l))&&gve(a,e?[l,r[l]]:r[l]);return a}},bve={entries:FA(!0),values:FA(!1)},wve=Ae,Sve=bve.values;wve({target:"Object",stat:!0},{values:function(t){return Sve(t)}});function Xc(e){return Xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xc(e)}function aw(e,t){return Rve(e)||Ove(e,t)||_ve(e,t)||Cve()}function Cve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _ve(e,t){if(e){if(typeof e=="string")return VA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VA(e,t)}}function VA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ove(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Rve(e){if(Array.isArray(e))return e}function Eve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tve(n.key),n)}}function Pve(e,t,r){return t&&WA(e.prototype,t),r&&WA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tve(e){var t=kve(e,"string");return Xc(t)==="symbol"?t:String(t)}function kve(e,t){if(Xc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $ve=function(){function e(t,r){Eve(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Pve(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Mn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),$n()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};Ye(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Ye(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,p=parseInt(c.borderWidth,10),g=parseInt(c.width,10),w=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),_=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-g-1,10),"px"),c[u]="".concat(parseInt(i-g-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var T=Math.min(parseInt(i+a,10),S-g-p*2),R=Math.min(parseInt(i+a-w/4,10),S-w-p*2);d[u]="".concat(T,"px"),v[u]="".concat(R,"px");var W=Math.min(parseInt(o+l,10),_-g-p*2),z=Math.min(parseInt(o+l-w/4,10),_-w-p*2);d.top="".concat(W,"px"),v.top="".concat(z,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var p=o.rowFilter.renderedToSource(v);if(p>=r[0]&&p<=r[2]){l=p,c=r[0];break}}for(var g=d-1;g>=0;g-=1){var w=o.rowFilter.renderedToSource(g);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var S=o.getRenderedColumnsCount(),_=0;_<S;_+=1){var T=o.columnFilter.renderedToSource(_);if(T>=r[1]&&T<=r[3]){u=T,h=r[1];break}}for(var R=S-1;R>=0;R-=1){var W=o.columnFilter.renderedToSource(R);if(W>=r[1]&&W<=r[3]){f=W;break}}if(l===void 0||u===void 0){this.disappear();return}var z=o.getCell(this.wot.createCellCoords(l,u)),X=l!==s||u!==f,K=X?o.getCell(this.wot.createCellCoords(s,f)):z,q=Ut(z),Q=X?Ut(K):q,ae=Ut(o.TABLE),Z=vt(o.TABLE),fe=q.top,Oe=q.left,be=this.wot.wtSettings.getSetting("rtlMode"),Ce=0,k=0;if(be){var y=vt(z),m=a.innerWidth-ae.left-Z;k=Oe+y-Q.left,Ce=a.innerWidth-Oe-y-m-1}else k=Q.left+vt(K)-Oe,Ce=Oe-ae.left-1;if(this.isEntireColumnSelected(l,s)){var b=this.getDimensionsFromHeader("columns",u,f,c,ae),O=null;if(b){var P=aw(b,3);O=P[0],Ce=P[1],k=P[2]}O&&(z=O)}var A=fe-ae.top-1,B=Q.top+kt(K)-fe;if(this.isEntireRowSelected(u,f)){var V=this.getDimensionsFromHeader("rows",l,s,h,ae),G=null;if(V){var J=aw(V,3);G=J[0],A=J[1],B=J[2]}G&&(z=G)}var ee=Ea(z,a);parseInt(ee.borderTopWidth,10)>0&&(A+=1,B=B>0?B-1:0),parseInt(ee[be?"borderRightWidth":"borderLeftWidth"],10)>0&&(Ce+=1,k=k>0?k-1:0);var le=be?"right":"left";this.topStyle.top="".concat(A,"px"),this.topStyle[le]="".concat(Ce,"px"),this.topStyle.width="".concat(k,"px"),this.topStyle.display="block",this.startStyle.top="".concat(A,"px"),this.startStyle[le]="".concat(Ce,"px"),this.startStyle.height="".concat(B,"px"),this.startStyle.display="block";var Re=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(A+B-Re,"px"),this.bottomStyle[le]="".concat(Ce,"px"),this.bottomStyle.width="".concat(k,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(A,"px"),this.endStyle[le]="".concat(Ce+k-Re,"px"),this.endStyle.height="".concat(B+1,"px"),this.endStyle.display="block";var ce=this.settings.border.cornerVisible;ce=typeof ce=="function"?ce(this.settings.layerLevel):ce;var he=this.wot.getSetting("onModifyGetCellCoords",s,f),Y=s,Ie=f;if(he&&Array.isArray(he)){var ze=aw(he,4);Y=ze[2],Ie=ze[3]}if($n()||!ce||this.isPartRange(Y,Ie))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(A+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[le]="".concat(Ce+k+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Te=wc(o.TABLE),$e=Te===a;$e&&(Te=i.documentElement);var ke=parseInt(this.cornerDefaultStyle.width,10)/2,C=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var E=$e?K.getBoundingClientRect().left:K.offsetLeft,$=!1,H=0;be?(H=E-parseInt(this.cornerDefaultStyle.width,10)/2,$=H<0):(H=E+vt(K)+parseInt(this.cornerDefaultStyle.width,10)/2,$=H>=Ty(Te)),$&&(this.cornerStyle[le]="".concat(Math.floor(Ce+k+this.cornerCenterPointOffset-ke),"px"),this.cornerStyle[be?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=$e?K.getBoundingClientRect().top:K.offsetTop,j=M+kt(K)+parseInt(this.cornerDefaultStyle.height,10)/2,x=j>=ti(Te);x&&(this.cornerStyle.top="".concat(Math.floor(A+B+this.cornerCenterPointOffset-C),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}$n()&&this.updateMultipleSelectionHandlesPosition(s,f,A,Ce,k,B)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,p=null,g=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return kt.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return vt.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var w=this.wot.getSetting("columnHeaders").length;if(p=u(n,w-i),g=u(o,w-i),!p||!g)return!1;var S=Ut(p),_=Ut(g);return p&&g&&(h=S[v]-a[v]-1,d=_[v]+f(g)-S[v]),[p,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?re(this[r],"hidden"):(Ne(this[r],"hidden")&&He(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?re(this[r],"hidden"):He(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",$n()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Ave=$ve;function Ive(e,t){return Nve(e)||Dve(e,t)||xve(e,t)||Mve()}function Mve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xve(e,t){if(e){if(typeof e=="string")return UA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UA(e,t)}}function UA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Nve(e){if(Array.isArray(e))return e}function ps(e){return ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ps(e)}function Hve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jve(n.key),n)}}function Lve(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jve(e){var t=Bve(e,"string");return ps(t)==="symbol"?t:String(t)}function Bve(e,t){if(ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fve=function(){function e(t,r){Hve(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Lve(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Ave(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(ps(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),re(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(Ne(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=Ive(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,p=c.highlightOnlyClosestHeader,g=c.selectionType,w=g===void 0||["active-header","header"].includes(g);if(w&&s!==null&&f!==null)for(var S=0,_=0;_<o;_+=1){var T=r.wtTable.columnFilter.renderedToSource(_);if(T>=s&&T<=f){var R=r.wtTable.getColumnHeaders(T),W=R.length-1;p&&R.length>1&&(R=[R[W]]);for(var z=0;z<R.length;z+=1){var X=[],K=R[z];h&&X.push(h),d&&X.push(d),z=p?W:z;var q=r.getSetting("onBeforeHighlightingColumnHeader",T,z,{selectionType:g,columnCursor:S,selectionWidth:f-s+1,classNames:X});q!==T&&(K=r.wtTable.getColumnHeader(q,z)),re(K,X)}S+=1}}if(l!==null&&u!==null)for(var Q=0,ae=0;ae<n;ae+=1){var Z=r.wtTable.rowFilter.renderedToSource(ae);if(w&&Z>=l&&Z<=u){var fe=r.wtTable.getRowHeaders(Z),Oe=fe.length-1;p&&fe.length>1&&(fe=[fe[Oe]]);for(var be=0;be<fe.length;be+=1){var Ce=[],k=fe[be];h&&Ce.push(h),v&&Ce.push(v),be=p?Oe:be;var y=r.getSetting("onBeforeHighlightingRowHeader",Z,be,{selectionType:g,rowCursor:Q,selectionHeight:u-l+1,classNames:Ce});y!==Z&&(k=r.wtTable.getRowHeader(y,be)),re(k,Ce)}Q+=1}if(s!==null&&f!==null)for(var m=0;m<o;m+=1){var b=r.wtTable.columnFilter.renderedToSource(m);Z>=l&&Z<=u&&b>=s&&b<=f?this.settings.className&&this.addClassAtCoords(r,Z,b,this.settings.className,this.settings.markIntersections):Z>=l&&Z<=u?v&&this.addClassAtCoords(r,Z,b,v):b>=s&&b<=f&&d&&this.addClassAtCoords(r,Z,b,d);var O=r.getSetting("onAfterDrawSelection",Z,b,this.settings.layerLevel);typeof O=="string"&&this.addClassAtCoords(r,Z,b,O)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const Vve=Fve;function GA(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function Wve(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var Uve=new Map([["mousedown",GA],["mouseover",Wve],["touchstart",GA]]);function YA(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;Uve.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:xE(e)||e.type==="touchstart",isRightClick:Pa(e)})}var VV=new WeakMap,qE=Symbol("rootInstance");function zve(e){VV.set(e,!0)}function Gve(e){return e===qE}function WC(e){return VV.has(e)}function Zc(e){return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zc(e)}function Rf(e,t){return qve(e)||Kve(e,t)||WV(e,t)||Yve()}function Yve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function qve(e){if(Array.isArray(e))return e}function KA(e){return Qve(e)||Zve(e)||WV(e)||Xve()}function Xve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WV(e,t){if(e){if(typeof e=="string")return UC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UC(e,t)}}function Zve(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qve(e){if(Array.isArray(e))return UC(e)}function UC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UV(n.key),n)}}function eye(e,t,r){return t&&qA(e.prototype,t),r&&qA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XA(e,t,r){tye(e,t),t.set(e,r)}function tye(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fo(e,t,r){return t=UV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UV(e){var t=rye(e,"string");return Zc(t)==="symbol"?t:String(t)}function rye(e,t){if(Zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZA(e,t){var r=zV(e,t,"get");return nye(e,r)}function nye(e,t){return t.get?t.get.call(e):t.value}function QA(e,t,r){var n=zV(e,t,"set");return oye(e,n,r),r}function zV(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function oye(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ii=new WeakMap,lw=new WeakMap,sw=new WeakMap,iye=function(){function e(t){Jve(this,e),Fo(this,"instance",void 0),Fo(this,"eventManager",void 0),Fo(this,"settings",void 0),Fo(this,"THEAD",void 0),Fo(this,"TBODY",void 0),Fo(this,"_wt",void 0),Fo(this,"activeWt",void 0),XA(this,lw,{writable:!0,value:0}),XA(this,sw,{writable:!0,value:0}),Fo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new At(this.instance),this.settings=this.instance.getSettings(),Ii.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return eye(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=Ii.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),re(o,"handsontable"),r.table=i.createElement("TABLE"),re(r.table,"htCore"),this.instance.getSettings().tableClassName&&re(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Ii.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;d1(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&d1(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&xE(u)&&l.finish(),n.mouseDown=!1,(IE(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!Pa(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&Pa(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var p=Jt(a);if(a.elementFromPoint(c+p,h)!==v||a.elementFromPoint(c,h+p)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var g=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;g?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Cp(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,KA(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Ii.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return WC(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,KA(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),QA(r,sw,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),QA(r,lw,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=Rf(d,2),p=v[0],g=v[1],w=r.instance.runHooks("modifyGetCellCoords",p,g),S=p,_=g;if(Array.isArray(w)){var T=Rf(w,2);S=T[0],_=T[1]}var R=r.instance.getCellMeta(S,_),W=r.instance.colToProp(_),z=r.instance.getDataAtRowProp(S,W);r.instance.hasHook("beforeValueRender")&&(z=r.instance.runHooks("beforeValueRender",z,R)),r.instance.runHooks("beforeRenderer",h,p,g,W,z,R),r.instance.getCellRenderer(R)(r.instance,h,p,g,W,z,R),r.instance.runHooks("afterRenderer",h,p,g,W,z,R)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),p={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,p),!Pl(f)&&(YA(f,{coords:v,selection:r.instance.selection,controller:p,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!Pl(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!Pl(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),p={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,p),!Pl(f)&&(n.mouseDown&&YA(f,{coords:v,selection:r.instance.selection,controller:p,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(Pl(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),p=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),p=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),p=Rf(v,2),g=p[0],w=p[1],S=r.instance.selection.getSelectedRange(),_=S.size();if(_>0){var T=(h??0)+1-_,R=S.peekByIndex(T);d=[R.from.row,R.from.col,R.to.row,R.to.col]}return r.instance.runHooks("afterDrawSelection",g,w,d,h)},onBeforeDrawBorders:function(f,c){var h=Rf(f,4),d=h[0],v=h[1],p=h[2],g=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(p),r.instance.columnIndexMapper.getVisualFromRenderableIndex(g)];return r.instance.runHooks("beforeDrawBorders",w,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,p=c>=0?v.getVisualFromRenderableIndex(c):c,g=f>=0?d.getVisualFromRenderableIndex(f):f,w=r.instance.runHooks("modifyGetCellCoords",g,p,h);if(Array.isArray(w)){var S=Rf(w,4),_=S[0],T=S[1],R=S[2],W=S[3];return[_>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(_,1)):_,T>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(T,1)):T,R>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(R,-1)):R,W>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(W,-1)):W]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var p=Math.ceil(v/h*12);f.startRow=Math.max(d-p,0),f.endRow=Math.min(v+p,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var p=Math.ceil(v/h*6);f.startColumn=Math.max(d-p,0),f.endColumn=Math.min(v+p,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new hve(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Cp(r))return!0;var n=Ca(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Ii.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!Ne(o,"relative")){Io(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;Ne(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(Io(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(Ne(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):Ne(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?Yd(r,o(n,i)):(Ra(r,String.fromCharCode(160)),re(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=Ii.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=Ii.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return ZA(this,lw)}},{key:"getRowHeadersCount",value:function(){return ZA(this,sw)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const aye=iye;function zC(e){return zC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zC(e)}var lye="ABCDEFGHIJKLMNOPQRSTUVWXYZ",JA=lye.length;function sye(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%JA,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/JA,10);return r}function eI(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function GV(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ue(e[0])&&(t=uE(e[0]))),t}function uye(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function fye(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return zC(t)==="object"&&!Array.isArray(t)&&t!==null}))}function Qc(e){return Qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qc(e)}function cye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dye(n.key),n)}}function hye(e,t,r){return t&&tI(e.prototype,t),r&&tI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dye(e){var t=vye(e,"string");return Qc(t)==="symbol"?t:String(t)}function vye(e,t){if(Qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yye=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];cye(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return hye(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return I(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):Se(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ue(s)||wt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;Se(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):Db(u,d,v)}})}else Ye(s,function(h,d){Db(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=ql(o);this.hot.runHooks("modifySourceData",r,this.propToCol(n),i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:Db(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=VJ(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=ql(i);this.hot.runHooks("modifySourceData",r,this.colToProp(n),a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return Se(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return GV(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const pye=yye;var rI=$t,mye=function(e){return e!==void 0&&(rI(e,"value")||rI(e,"writable"))},gye=Ae,bye=Gt,wye=Ft,Sye=Dt,Cye=mye,_ye=xn,Oye=Dm;function YV(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(Sye(e)===r)return e[t];if(n=_ye.f(e,t),n)return Cye(n)?n.value:n.get===void 0?void 0:bye(n.get,r);if(wye(o=Oye(e)))return YV(o,t,r)}gye({target:"Reflect",stat:!0},{get:YV});var Rye=Ae,Eye=je,Pye=Nr,KV=xn.f,qV=Bt,Tye=!qV||Eye(function(){KV(1)});Rye({target:"Object",stat:!0,forced:Tye,sham:!qV},{getOwnPropertyDescriptor:function(t,r){return KV(Pye(t),r)}});var kye="localHooks",XV={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)sC(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};No(XV,"MIXIN_NAME",kye,{writable:!1,enumerable:!1});const Pr=XV;function Jc(e){return Jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(e)}function $ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iye(n.key),n)}}function Aye(e,t,r){return t&&nI(e.prototype,t),r&&nI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iye(e){var t=Mye(e,"string");return Jc(t)==="symbol"?t:String(t)}function Mye(e,t){if(Jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ga=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;$ye(this,e),this.indexedValues=[],this.initValueOrFn=t}return Aye(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,wt(this.initValueOrFn)?Se(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):Se(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();bt(Ga,Pr);function uw(e){return Hye(e)||Nye(e)||Dye(e)||xye()}function xye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dye(e,t){if(e){if(typeof e=="string")return GC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GC(e,t)}}function Nye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Hye(e){if(Array.isArray(e))return GC(e)}function GC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XE(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(uw(e.slice(0,o)),uw(r.map(function(i,a){return wt(n)?n(i,a):n})),uw(o===void 0?[]:e.slice(o)))}function ZE(e,t){return Yr(e,function(r,n){return t.includes(n)===!1})}function ms(e){return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ms(e)}function Lye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bye(n.key),n)}}function jye(e,t,r){return t&&oI(e.prototype,t),r&&oI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bye(e){var t=Fye(e,"string");return ms(t)==="symbol"?t:String(t)}function Fye(e,t){if(ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tc(){return typeof Reflect<"u"&&Reflect.get?tc=Reflect.get.bind():tc=function(t,r,n){var o=Vye(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},tc.apply(this,arguments)}function Vye(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Aa(e),e!==null););return e}function Wye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YC(e,t)}function YC(e,t){return YC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YC(e,t)}function Uye(e){var t=Yye();return function(){var n=Aa(e),o;if(t){var i=Aa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zye(this,o)}}function zye(e,t){if(t&&(ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gye(e)}function Gye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Aa(e){return Aa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Aa(e)}var Ci=function(e){Wye(r,e);var t=Uye(r);function r(){return Lye(this,r),t.apply(this,arguments)}return jye(r,[{key:"insert",value:function(o,i){this.indexedValues=XE(this.indexedValues,o,i,this.initValueOrFn),tc(Aa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=ZE(this.indexedValues,o),tc(Aa(r.prototype),"remove",this).call(this,o)}}]),r}(Ga);function gs(e){return gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gs(e)}function Kye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xye(n.key),n)}}function qye(e,t,r){return t&&iI(e.prototype,t),r&&iI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xye(e){var t=Zye(e,"string");return gs(t)==="symbol"?t:String(t)}function Zye(e,t){if(gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KC(e,t)}function KC(e,t){return KC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KC(e,t)}function Jye(e){var t=rpe();return function(){var n=Xp(e),o;if(t){var i=Xp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return epe(this,o)}}function epe(e,t){if(t&&(gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tpe(e)}function tpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xp(e){return Xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xp(e)}var lg=function(e){Qye(r,e);var t=Jye(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Kye(this,r),t.call(this,n)}return qye(r,[{key:"getHiddenIndexes",value:function(){return ir(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Ci);function fw(e){return ape(e)||ipe(e)||ope(e)||npe()}function npe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ope(e,t){if(e){if(typeof e=="string")return qC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qC(e,t)}}function ipe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ape(e){if(Array.isArray(e))return qC(e)}function qC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QE(e,t,r){return[].concat(fw(e.slice(0,t)),fw(r),fw(e.slice(t)))}function eh(e,t){return Yr(e,function(r){return t.includes(r)===!1})}function JE(e,t){return We(e,function(r){return r-t.filter(function(n){return n<r}).length})}function e0(e,t){var r=t[0],n=t.length;return We(e,function(o){return o>=r?o+n:o})}function bs(e){return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function lpe(e){return cpe(e)||fpe(e)||upe(e)||spe()}function spe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function upe(e,t){if(e){if(typeof e=="string")return XC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XC(e,t)}}function fpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cpe(e){if(Array.isArray(e))return XC(e)}function XC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QV(n.key),n)}}function dpe(e,t,r){return t&&aI(e.prototype,t),r&&aI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zn(){return typeof Reflect<"u"&&Reflect.get?Zn=Reflect.get.bind():Zn=function(t,r,n){var o=vpe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Zn.apply(this,arguments)}function vpe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ln(e),e!==null););return e}function ype(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZC(e,t)}function ZC(e,t){return ZC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZC(e,t)}function ppe(e){var t=gpe();return function(){var n=ln(e),o;if(t){var i=ln(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mpe(this,o)}}function mpe(e,t){if(t&&(bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZV(e)}function ZV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ln(e){return ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ln(e)}function bpe(e,t,r){return t=QV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QV(e){var t=wpe(e,"string");return bs(t)==="symbol"?t:String(t)}function wpe(e,t){if(bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sg=function(e){ype(r,e);var t=ppe(r);function r(){var n;hpe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),bpe(ZV(n),"orderOfIndexes",[]),n}return dpe(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=lpe(Array(o.length).keys()),Zn(ln(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=eh(this.orderOfIndexes,[o]),wt(this.initValueOrFn)?Zn(ln(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):Zn(ln(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,Zn(ln(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=XE(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=e0(this.orderOfIndexes,i),Zn(ln(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=ZE(this.indexedValues,o),this.orderOfIndexes=eh(this.orderOfIndexes,o),this.orderOfIndexes=JE(this.orderOfIndexes,o),Zn(ln(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(Ga);function ws(e){return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function Spe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_pe(n.key),n)}}function Cpe(e,t,r){return t&&lI(e.prototype,t),r&&lI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _pe(e){var t=Ope(e,"string");return ws(t)==="symbol"?t:String(t)}function Ope(e,t){if(ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QC(e,t)}function QC(e,t){return QC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QC(e,t)}function Epe(e){var t=kpe();return function(){var n=Zp(e),o;if(t){var i=Zp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ppe(this,o)}}function Ppe(e,t){if(t&&(ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tpe(e)}function Tpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zp(e){return Zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zp(e)}var ev=function(e){Rpe(r,e);var t=Epe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Spe(this,r),t.call(this,n)}return Cpe(r,[{key:"getTrimmedIndexes",value:function(){return ir(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Ci),sI=new Map([["indexesSequence",{getListWithInsertedItems:QE,getListWithRemovedItems:eh}],["physicallyIndexed",{getListWithInsertedItems:XE,getListWithRemovedItems:ZE}]]),JV=function(t){if(sI.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return sI.get(t)};function Ss(e){return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function $pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ipe(n.key),n)}}function Ape(e,t,r){return t&&uI(e.prototype,t),r&&uI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ipe(e){var t=Mpe(e,"string");return Ss(t)==="symbol"?t:String(t)}function Mpe(e,t){if(Ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rc(){return typeof Reflect<"u"&&Reflect.get?rc=Reflect.get.bind():rc=function(t,r,n){var o=xpe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},rc.apply(this,arguments)}function xpe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ia(e),e!==null););return e}function Dpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JC(e,t)}function JC(e,t){return JC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JC(e,t)}function Npe(e){var t=jpe();return function(){var n=Ia(e),o;if(t){var i=Ia(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Hpe(this,o)}}function Hpe(e,t){if(t&&(Ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lpe(e)}function Lpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ia(e){return Ia=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ia(e)}var eW=function(e){Dpe(r,e);var t=Npe(r);function r(){return $pe(this,r),t.call(this,function(n){return n})}return Ape(r,[{key:"insert",value:function(o,i){var a=e0(this.indexedValues,i);this.indexedValues=QE(a,o,i),rc(Ia(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=eh(this.indexedValues,o);this.indexedValues=JE(i,o),rc(Ia(r.prototype),"remove",this).call(this,o)}}]),r}(Ga),fI=new Map([["hiding",lg],["index",Ga],["linkedPhysicalIndexToValue",sg],["physicalIndexToValue",Ci],["trimming",ev]]);function Bpe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!fI.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(fI.get(e))(t)}function th(e){return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function Fpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wpe(n.key),n)}}function Vpe(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wpe(e){var t=Upe(e,"string");return th(t)==="symbol"?t:String(t)}function Upe(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t0=function(){function e(){Fpe(this,e),this.collection=new Map}return Vpe(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);pe(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return mt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();bt(t0,Pr);function Cs(e){return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function zpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ype(n.key),n)}}function Gpe(e,t,r){return t&&hI(e.prototype,t),r&&hI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ype(e){var t=Kpe(e,"string");return Cs(t)==="symbol"?t:String(t)}function Kpe(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e_(e,t)}function e_(e,t){return e_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},e_(e,t)}function Xpe(e){var t=Jpe();return function(){var n=Qp(e),o;if(t){var i=Qp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zpe(this,o)}}function Zpe(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qpe(e)}function Qpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qp(e){return Qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qp(e)}var dI=function(e){qpe(r,e);var t=Xpe(r);function r(n,o){var i;return zpe(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return Gpe(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=We(this.get(),function(c){return c.getValues()}),a=[],l=pe(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return We(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return pe(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(t0);function rh(e){return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function eme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rme(n.key),n)}}function tme(e,t,r){return t&&vI(e.prototype,t),r&&vI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rme(e){var t=nme(e,"string");return rh(t)==="symbol"?t:String(t)}function nme(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ome(e,t,r){ime(e,t),t.set(e,r)}function ime(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ame(e,t,r){var n=tW(e,t,"set");return lme(e,n,r),r}function lme(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function sme(e,t){var r=tW(e,t,"get");return ume(e,r)}function tW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ume(e,t){return t.get?t.get.call(e):t.value}var cw=new WeakMap,rW=function(){function e(){eme(this,e),ome(this,cw,{writable:!0,value:[]})}return tme(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(sme(this,cw)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){ame(this,cw,r)}}]),e}();bt(rW,Pr);function yI(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function nh(e){return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function fme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hme(n.key),n)}}function cme(e,t,r){return t&&pI(e.prototype,t),r&&pI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hme(e){var t=dme(e,"string");return nh(t)==="symbol"?t:String(t)}function dme(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ef(e,t,r){vme(e,t),t.set(e,r)}function vme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Br(e,t){var r=nW(e,t,"get");return yme(e,r)}function yme(e,t){return t.get?t.get.call(e):t.value}function Dv(e,t,r){var n=nW(e,t,"set");return pme(e,n,r),r}function nW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function pme(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Nv=new WeakMap,Pf=new WeakMap,Hv=new WeakMap,Lv=new WeakMap,jv=new WeakMap,mme=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;fme(this,e),Ef(this,Nv,{writable:!0,value:new Set}),Ef(this,Pf,{writable:!0,value:[]}),Ef(this,Hv,{writable:!0,value:[]}),Ef(this,Lv,{writable:!0,value:!1}),Ef(this,jv,{writable:!0,value:!1}),Dv(this,jv,r??!1)}return cme(e,[{key:"createObserver",value:function(){var r=this,n=new rW;return Br(this,Nv).add(n),n.addLocalHook("unsubscribe",function(){Br(r,Nv).delete(n)}),n._writeInitialChanges(yI(Br(this,Pf),Br(this,Hv))),n}},{key:"emit",value:function(r){var n=Br(this,Hv);(!Br(this,Lv)||Br(this,Pf).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Br(this,jv)):Dv(this,Pf,new Array(r.length).fill(Br(this,jv))),Br(this,Lv)||(Dv(this,Lv,!0),n=Br(this,Pf)));var o=yI(n,r);Br(this,Nv).forEach(function(i){return i._write(o)}),Dv(this,Hv,r)}}]),e}();function oh(e){return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}var mI;function hw(e){return Sme(e)||wme(e)||bme(e)||gme()}function gme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bme(e,t){if(e){if(typeof e=="string")return t_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t_(e,t)}}function wme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sme(e){if(Array.isArray(e))return t_(e)}function t_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rme(n.key),n)}}function Ome(e,t,r){return t&&gI(e.prototype,t),r&&gI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rme(e){var t=Eme(e,"string");return oh(t)==="symbol"?t:String(t)}function Eme(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bI=new Set(["getFirstNotHiddenIndex"]),r_=function(){function e(){var t=this;_me(this,e),this.indexesSequence=new eW,this.trimmingMapsCollection=new dI(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new dI(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new t0,this.hidingChangesObservable=new mme({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return Ome(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,Bpe(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof ev?this.trimmingMapsCollection.register(r,n):n instanceof lg?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return pe(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return pe(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return pe(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return pe(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;bI.has("getFirstNotHiddenIndex")&&(bI.delete("getFirstNotHiddenIndex"),dt(ct(mI||(mI=Cme([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?o===!0&&i!==r-n?this.getFirstNotHiddenIndex(i,-n,!1,i):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,o,i)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=hw(new Array(r).keys()),this.notHiddenIndexesCache=hw(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=hw(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=We(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=eh(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.setIndexesSequence(QE(s,u,i))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=pe(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=We(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesSequence.insert(a,l),this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();bt(r_,Pr);var wI;function Pme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Tme(e,t){return Ye(t,function(r,n){mt(e[n])&&(e[n]=r)}),e}function oW(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function iW(e){pe(e)&&ME(ct(wI||(wI=Pme(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function kme(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var aW=Jr("phraseFormatters"),$me=aW.register,Ame=aW.getValues;function Ime(e,t){$me(e,t)}function Mme(){return Ame()}Ime("pluralize",kme);var lW="ContextMenu:items",Le=lW,r0="".concat(Le,".noItems"),n0="".concat(Le,".insertRowAbove"),o0="".concat(Le,".insertRowBelow"),i0="".concat(Le,".insertColumnOnTheLeft"),a0="".concat(Le,".insertColumnOnTheRight"),l0="".concat(Le,".removeRow"),s0="".concat(Le,".removeColumn"),u0="".concat(Le,".undo"),f0="".concat(Le,".redo"),c0="".concat(Le,".readOnly"),h0="".concat(Le,".clearColumn"),d0="".concat(Le,".copy"),v0="".concat(Le,".copyWithHeaders"),y0="".concat(Le,".copyWithGroupHeaders"),p0="".concat(Le,".copyHeadersOnly"),m0="".concat(Le,".cut"),g0="".concat(Le,".freezeColumn"),b0="".concat(Le,".unfreezeColumn"),w0="".concat(Le,".mergeCells"),S0="".concat(Le,".unmergeCells"),C0="".concat(Le,".addComment"),_0="".concat(Le,".editComment"),O0="".concat(Le,".removeComment"),R0="".concat(Le,".readOnlyComment"),E0="".concat(Le,".align"),P0="".concat(Le,".align.left"),T0="".concat(Le,".align.center"),k0="".concat(Le,".align.right"),$0="".concat(Le,".align.justify"),A0="".concat(Le,".align.top"),I0="".concat(Le,".align.middle"),M0="".concat(Le,".align.bottom"),x0="".concat(Le,".borders"),D0="".concat(Le,".borders.top"),N0="".concat(Le,".borders.right"),H0="".concat(Le,".borders.bottom"),L0="".concat(Le,".borders.left"),j0="".concat(Le,".borders.remove"),B0="".concat(Le,".nestedHeaders.insertChildRow"),F0="".concat(Le,".nestedHeaders.detachFromParent"),V0="".concat(Le,".hideColumn"),W0="".concat(Le,".showColumn"),U0="".concat(Le,".hideRow"),z0="".concat(Le,".showRow"),gr="Filters:",It="".concat(gr,"conditions"),ug="".concat(It,".none"),G0="".concat(It,".isEmpty"),Y0="".concat(It,".isNotEmpty"),K0="".concat(It,".isEqualTo"),q0="".concat(It,".isNotEqualTo"),X0="".concat(It,".beginsWith"),Z0="".concat(It,".endsWith"),Q0="".concat(It,".contains"),J0="".concat(It,".doesNotContain"),xme="".concat(It,".byValue"),eP="".concat(It,".greaterThan"),tP="".concat(It,".greaterThanOrEqualTo"),rP="".concat(It,".lessThan"),nP="".concat(It,".lessThanOrEqualTo"),oP="".concat(It,".isBetween"),iP="".concat(It,".isNotBetween"),aP="".concat(It,".after"),lP="".concat(It,".before"),sP="".concat(It,".today"),uP="".concat(It,".tomorrow"),fP="".concat(It,".yesterday"),cP="".concat(gr,"labels.filterByCondition"),hP="".concat(gr,"labels.filterByValue"),dP="".concat(gr,"labels.conjunction"),fg="".concat(gr,"labels.disjunction"),Jp="".concat(gr,"values.blankCells"),vP="".concat(gr,"buttons.selectAll"),yP="".concat(gr,"buttons.clear"),pP="".concat(gr,"buttons.ok"),mP="".concat(gr,"buttons.cancel"),gP="".concat(gr,"buttons.placeholder.search"),bP="".concat(gr,"buttons.placeholder.value"),wP="".concat(gr,"buttons.placeholder.secondValue");const Dme=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:C0,CONTEXTMENU_ITEMS_ALIGNMENT:E0,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:M0,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:T0,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:$0,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:P0,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:I0,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:k0,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:A0,CONTEXTMENU_ITEMS_BORDERS:x0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:H0,CONTEXTMENU_ITEMS_BORDERS_LEFT:L0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:N0,CONTEXTMENU_ITEMS_BORDERS_TOP:D0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:h0,CONTEXTMENU_ITEMS_COPY:d0,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:p0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:y0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:v0,CONTEXTMENU_ITEMS_CUT:m0,CONTEXTMENU_ITEMS_EDIT_COMMENT:_0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:g0,CONTEXTMENU_ITEMS_HIDE_COLUMN:V0,CONTEXTMENU_ITEMS_HIDE_ROW:U0,CONTEXTMENU_ITEMS_INSERT_LEFT:i0,CONTEXTMENU_ITEMS_INSERT_RIGHT:a0,CONTEXTMENU_ITEMS_MERGE_CELLS:w0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:F0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:B0,CONTEXTMENU_ITEMS_NO_ITEMS:r0,CONTEXTMENU_ITEMS_READ_ONLY:c0,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:R0,CONTEXTMENU_ITEMS_REDO:f0,CONTEXTMENU_ITEMS_REMOVE_BORDERS:j0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:s0,CONTEXTMENU_ITEMS_REMOVE_COMMENT:O0,CONTEXTMENU_ITEMS_REMOVE_ROW:l0,CONTEXTMENU_ITEMS_ROW_ABOVE:n0,CONTEXTMENU_ITEMS_ROW_BELOW:o0,CONTEXTMENU_ITEMS_SHOW_COLUMN:W0,CONTEXTMENU_ITEMS_SHOW_ROW:z0,CONTEXTMENU_ITEMS_UNDO:u0,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:b0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:S0,CONTEXT_MENU_ITEMS_NAMESPACE:lW,FILTERS_BUTTONS_CANCEL:mP,FILTERS_BUTTONS_CLEAR:yP,FILTERS_BUTTONS_OK:pP,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:gP,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:wP,FILTERS_BUTTONS_PLACEHOLDER_VALUE:bP,FILTERS_BUTTONS_SELECT_ALL:vP,FILTERS_CONDITIONS_AFTER:aP,FILTERS_CONDITIONS_BEFORE:lP,FILTERS_CONDITIONS_BEGINS_WITH:X0,FILTERS_CONDITIONS_BETWEEN:oP,FILTERS_CONDITIONS_BY_VALUE:xme,FILTERS_CONDITIONS_CONTAINS:Q0,FILTERS_CONDITIONS_EMPTY:G0,FILTERS_CONDITIONS_ENDS_WITH:Z0,FILTERS_CONDITIONS_EQUAL:K0,FILTERS_CONDITIONS_GREATER_THAN:eP,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:tP,FILTERS_CONDITIONS_LESS_THAN:rP,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:nP,FILTERS_CONDITIONS_NAMESPACE:It,FILTERS_CONDITIONS_NONE:ug,FILTERS_CONDITIONS_NOT_BETWEEN:iP,FILTERS_CONDITIONS_NOT_CONTAIN:J0,FILTERS_CONDITIONS_NOT_EMPTY:Y0,FILTERS_CONDITIONS_NOT_EQUAL:q0,FILTERS_CONDITIONS_TODAY:sP,FILTERS_CONDITIONS_TOMORROW:uP,FILTERS_CONDITIONS_YESTERDAY:fP,FILTERS_DIVS_FILTER_BY_CONDITION:cP,FILTERS_DIVS_FILTER_BY_VALUE:hP,FILTERS_LABELS_CONJUNCTION:dP,FILTERS_LABELS_DISJUNCTION:fg,FILTERS_NAMESPACE:gr,FILTERS_VALUES_BLANK_CELLS:Jp},Symbol.toStringTag,{value:"Module"}));function ih(e){return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}var se;function ue(e,t,r){return t=Nme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nme(e){var t=Hme(e,"string");return ih(t)==="symbol"?t:String(t)}function Hme(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lme=(se={languageCode:"en-US"},ue(se,r0,"No available options"),ue(se,n0,"Insert row above"),ue(se,o0,"Insert row below"),ue(se,i0,"Insert column left"),ue(se,a0,"Insert column right"),ue(se,l0,["Remove row","Remove rows"]),ue(se,s0,["Remove column","Remove columns"]),ue(se,u0,"Undo"),ue(se,f0,"Redo"),ue(se,c0,"Read only"),ue(se,h0,"Clear column"),ue(se,E0,"Alignment"),ue(se,P0,"Left"),ue(se,T0,"Center"),ue(se,k0,"Right"),ue(se,$0,"Justify"),ue(se,A0,"Top"),ue(se,I0,"Middle"),ue(se,M0,"Bottom"),ue(se,g0,"Freeze column"),ue(se,b0,"Unfreeze column"),ue(se,x0,"Borders"),ue(se,D0,"Top"),ue(se,N0,"Right"),ue(se,H0,"Bottom"),ue(se,L0,"Left"),ue(se,j0,"Remove border(s)"),ue(se,C0,"Add comment"),ue(se,_0,"Edit comment"),ue(se,O0,"Delete comment"),ue(se,R0,"Read-only comment"),ue(se,w0,"Merge cells"),ue(se,S0,"Unmerge cells"),ue(se,d0,"Copy"),ue(se,v0,["Copy with header","Copy with headers"]),ue(se,y0,["Copy with group header","Copy with group headers"]),ue(se,p0,["Copy header only","Copy headers only"]),ue(se,m0,"Cut"),ue(se,B0,"Insert child row"),ue(se,F0,"Detach from parent"),ue(se,V0,["Hide column","Hide columns"]),ue(se,W0,["Show column","Show columns"]),ue(se,U0,["Hide row","Hide rows"]),ue(se,z0,["Show row","Show rows"]),ue(se,ug,"None"),ue(se,G0,"Is empty"),ue(se,Y0,"Is not empty"),ue(se,K0,"Is equal to"),ue(se,q0,"Is not equal to"),ue(se,X0,"Begins with"),ue(se,Z0,"Ends with"),ue(se,Q0,"Contains"),ue(se,J0,"Does not contain"),ue(se,eP,"Greater than"),ue(se,tP,"Greater than or equal to"),ue(se,rP,"Less than"),ue(se,nP,"Less than or equal to"),ue(se,oP,"Is between"),ue(se,iP,"Is not between"),ue(se,aP,"After"),ue(se,lP,"Before"),ue(se,sP,"Today"),ue(se,uP,"Tomorrow"),ue(se,fP,"Yesterday"),ue(se,Jp,"Blank cells"),ue(se,cP,"Filter by condition"),ue(se,hP,"Filter by value"),ue(se,dP,"And"),ue(se,fg,"Or"),ue(se,vP,"Select all"),ue(se,yP,"Clear"),ue(se,pP,"OK"),ue(se,mP,"Cancel"),ue(se,gP,"Search"),ue(se,bP,"Value"),ue(se,wP,"Second value"),se);const sW=Lme;var n_=sW.languageCode,cg=Jr("languagesDictionaries"),jme=cg.register,uW=cg.getItem,Bme=cg.hasItem,Fme=cg.getValues;fW(sW);function fW(e,t){var r=e,n=t;return Ue(e)&&(n=e,r=n.languageCode),Vme(r,n),jme(r,yr(n)),yr(n)}function Vme(e,t){e!==n_&&Tme(t,uW(n_))}function cW(e){return SP(e)?yr(uW(e)):null}function SP(e){return Bme(e)}function Wme(){return Fme()}function hW(e,t,r){var n=cW(e);if(n===null)return null;var o=n[t];if(mt(o))return null;var i=Ume(o,r);return Array.isArray(i)?i[0]:i}function Ume(e,t){var r=e;return I(Mme(),function(n){r=n(e,t)}),r}function zme(e){var t=oW(e);return SP(t)||(t=n_,iW(e)),t}var Gme=Ae,Yme=Bt,Kme=EL,qme=Nr,Xme=xn,Zme=tf;Gme({target:"Object",stat:!0,sham:!Yme},{getOwnPropertyDescriptors:function(t){for(var r=qme(t),n=Xme.f,o=Kme(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&Zme(i,l,s);return i}});var hg="active-header",dg="area",ah="cell",CP="fill",tv="header",_P="custom-selection";function _s(e){return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function Qme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vW(n.key),n)}}function Jme(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hy(){return typeof Reflect<"u"&&Reflect.get?Hy=Reflect.get.bind():Hy=function(t,r,n){var o=ege(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hy.apply(this,arguments)}function ege(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Os(e),e!==null););return e}function tge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o_(e,t)}function o_(e,t){return o_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},o_(e,t)}function rge(e){var t=oge();return function(){var n=Os(e),o;if(t){var i=Os(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nge(this,o)}}function nge(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dW(e)}function dW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Os(e){return Os=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Os(e)}function ige(e,t,r){return t=vW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vW(e){var t=age(e,"string");return _s(t)==="symbol"?t:String(t)}function age(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lge=function(e){tge(r,e);var t=rge(r);function r(n,o){var i;return Qme(this,r),i=t.call(this,n,null),ige(dW(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return Jme(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,Hy(Os(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(Vve);const sf=lge;function lh(e){return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}var sge=["activeHeaderClassName"];function CI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _I(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CI(Object(r),!0).forEach(function(n){uge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uge(e,t,r){return t=fge(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fge(e){var t=cge(e,"string");return lh(t)==="symbol"?t:String(t)}function cge(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hge(e,t){if(e==null)return{};var r=dge(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function dge(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function vge(e){var t=e.activeHeaderClassName,r=hge(e,sge),n=new sf(_I(_I({highlightHeaderClassName:t},r),{},{selectionType:hg}));return n}function sh(e){return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}var yge=["layerLevel","areaCornerVisible"];function OI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function RI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OI(Object(r),!0).forEach(function(n){pge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pge(e,t,r){return t=mge(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mge(e){var t=gge(e,"string");return sh(t)==="symbol"?t:String(t)}function gge(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bge(e,t){if(e==null)return{};var r=wge(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wge(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Sge(e){var t=e.layerLevel,r=e.areaCornerVisible,n=bge(e,yge),o=new sf(RI(RI({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:dg}));return o}function uh(e){return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}var Cge=["cellCornerVisible"];function EI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function PI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EI(Object(r),!0).forEach(function(n){_ge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _ge(e,t,r){return t=Oge(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oge(e){var t=Rge(e,"string");return uh(t)==="symbol"?t:String(t)}function Rge(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ege(e,t){if(e==null)return{};var r=Pge(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Pge(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Tge(e){var t=e.cellCornerVisible,r=Ege(e,Cge),n=new sf(PI(PI({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:ah}));return n}function fh(e){return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}var kge=["border","visualCellRange"];function TI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TI(Object(r),!0).forEach(function(n){$ge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $ge(e,t,r){return t=Age(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Age(e){var t=Ige(e,"string");return fh(t)==="symbol"?t:String(t)}function Ige(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mge(e,t){if(e==null)return{};var r=xge(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xge(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Dge(e){var t=e.border,r=e.visualCellRange,n=Mge(e,kge),o=new sf(dw(dw(dw({},t),n),{},{selectionType:_P}),r);return o}var kI=Bt,Nge=Be,Hge=Gt,Lge=je,vw=Ad,jge=kd,Bge=Sd,Fge=Er,Vge=_d,ol=Object.assign,$I=Object.defineProperty,Wge=Nge([].concat),Uge=!ol||Lge(function(){if(kI&&ol({b:1},ol($I({},"a",{enumerable:!0,get:function(){$I(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),ol({},e)[r]!=7||vw(ol({},t)).join("")!=n})?function(t,r){for(var n=Fge(t),o=arguments.length,i=1,a=jge.f,l=Bge.f;o>i;)for(var s=Vge(arguments[i++]),u=a?Wge(vw(s),a(s)):vw(s),f=u.length,c=0,h;f>c;)h=u[c++],(!kI||Hge(l,s,h))&&(n[h]=s[h]);return n}:ol,zge=Ae,AI=Uge;zge({target:"Object",stat:!0,arity:2,forced:Object.assign!==AI},{assign:AI});function ch(e){return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function II(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function MI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?II(Object(r),!0).forEach(function(n){Gge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):II(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gge(e,t,r){return t=Yge(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yge(e){var t=Kge(e,"string");return ch(t)==="symbol"?t:String(t)}function Kge(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qge(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function Xge(e){var t=Object.assign({},(qge(e),e)),r=new sf(MI(MI({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:CP}));return r}function hh(e){return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}var Zge=["headerClassName","rowClassName","columnClassName"];function xI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function DI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xI(Object(r),!0).forEach(function(n){Qge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qge(e,t,r){return t=Jge(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jge(e){var t=ebe(e,"string");return hh(t)==="symbol"?t:String(t)}function ebe(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tbe(e,t){if(e==null)return{};var r=rbe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rbe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function nbe(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=tbe(e,Zge),i=new sf(DI(DI({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:tv}));return i}function dh(e){return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function NI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function obe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NI(Object(r),!0).forEach(function(n){ibe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ibe(e,t,r){return t=abe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function abe(e){var t=lbe(e,"string");return dh(t)==="symbol"?t:String(t)}function lbe(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yW=Jr("highlight/types"),uf=yW.register,sbe=yW.getItem;uf(hg,vge);uf(dg,Sge);uf(ah,Tge);uf(_P,Dge);uf(CP,Xge);uf(tv,nbe);function il(e,t){return sbe(e)(obe({type:e},t))}function vh(e){return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function Vo(e){return hbe(e)||cbe(e)||fbe(e)||ube()}function ube(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fbe(e,t){if(e){if(typeof e=="string")return i_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i_(e,t)}}function cbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hbe(e){if(Array.isArray(e))return i_(e)}function i_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Tf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HI(Object(r),!0).forEach(function(n){dbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dbe(e,t,r){return t=pW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pW(n.key),n)}}function ybe(e,t,r){return t&&LI(e.prototype,t),r&&LI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pW(e){var t=pbe(e,"string");return vh(t)==="symbol"?t:String(t)}function pbe(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mbe=function(e){function t(r){vbe(this,t),this.options=r,this.layerLevel=0,this.cell=il(ah,r),this.fill=il(CP,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return ybe(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===ah&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=il(dg,Tf({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Vo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=il(tv,Tf({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Vo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=il(hg,Tf({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Vo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Vo(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(il(_P,Tf(Tf({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),I(this.areas.values(),function(n){return void n.clear()}),I(this.headers.values(),function(n){return void n.clear()}),I(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Vo(this.areas.values()),Vo(this.headers.values()),Vo(this.activeHeaders.values()),Vo(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const gbe=mbe;function yh(e){return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function bbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sbe(n.key),n)}}function wbe(e,t,r){return t&&jI(e.prototype,t),r&&jI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sbe(e){var t=Cbe(e,"string");return yh(t)==="symbol"?t:String(t)}function Cbe(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _be=function(e){function t(r){bbe(this,t),this.ranges=[],this.createCellRange=r}return wbe(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Obe=_be;function ph(e){return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function Rbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pbe(n.key),n)}}function Ebe(e,t,r){return t&&BI(e.prototype,t),r&&BI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pbe(e){var t=Tbe(e,"string");return ph(t)==="symbol"?t:String(t)}function Tbe(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mW=function(){function e(t,r){Rbe(this,e),this.range=t,this.options=r}return Ebe(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),p=this.options.fixedRowsBottom(),g=this.options.minSpareRows(),w=this.options.minSpareCols(),S=this.options.autoWrapRow(),_=this.options.autoWrapCol();s+r>d-1?o&&g>0&&!(p&&s>=d-p-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):_&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):_&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var T=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,T.row<0?(c=-1,T.row=0):T.row>0&&T.row>=d&&(c=1,T.row=d-1),T.col<0?(h=-1,T.col=0):T.col>0&&T.col>=v&&(h=1,T.col=v-1),f=this.options.renderableToVisualCoords(T)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),p=v.row,g=v.col,w=this.options.createCellCoords(p+o.row,g+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();bt(mW,Pr);const kbe=mW;function gW(e,t){return Mbe(e)||Ibe(e,t)||Abe(e,t)||$be()}function $be(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Abe(e,t){if(e){if(typeof e=="string")return FI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FI(e,t)}}function FI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ibe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Mbe(e){if(Array.isArray(e))return e}function a_(e){return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a_(e)}var vg=0,yg=1,bW=2,OP=3,xbe=[OP,bW],Dbe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],yw=Symbol("root"),VI=Symbol("child");function Rs(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yw;if(t!==yw&&t!==VI)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===yw,o=vg;if(r){var i=e[0];if(e.length===0)o=yg;else if(n&&i instanceof LE)o=OP;else if(n&&Array.isArray(i))o=Rs(i,VI);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!Dbe[s].includes(a_(l))});a&&(o=bW)}}return o}function mh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!xbe.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===OP,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),mt(u)&&(u=l),mt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function Nbe(e){var t=Rs(e);if(t===vg||t===yg)return[];var r=mh(t),n=new Set;I(e,function(a){var l=r(a),s=gW(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;I(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=ir(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Hbe(e){var t=Rs(e);if(t===vg||t===yg)return[];var r=mh(t),n=new Set;I(e,function(a){var l=r(a),s=gW(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;I(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=ir(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Wo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function gh(e){return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}var WI;function UI(e,t){return Fbe(e)||Bbe(e,t)||jbe(e,t)||Lbe()}function Lbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jbe(e,t){if(e){if(typeof e=="string")return zI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zI(e,t)}}function zI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Fbe(e){if(Array.isArray(e))return e}function Vbe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Wbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zbe(n.key),n)}}function Ube(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zbe(e){var t=Gbe(e,"string");return gh(t)==="symbol"?t:String(t)}function Gbe(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wW=function(){function e(t,r){var n=this;Wbe(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Obe(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new gbe({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new kbe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Ube(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&mt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(ah,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(I(this.highlight.getAreas(),function(p){return void p.clear()}),I(this.highlight.getHeaders(),function(p){return void p.clear()}),I(this.highlight.getActiveHeaders(),function(p){return void p.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(dg,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(tv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=ql(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=Rs(r);if(o===yg)return!1;if(o===vg)throw new Error(ct(WI||(WI=Vbe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=mh(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=UI(f,4),h=c[0],d=c[1],v=c[2],p=c[3],g=Wo(h,a)&&Wo(d,l)&&Wo(v,a)&&Wo(p,l);return!g});return s&&(this.clear(),I(r,function(u){var f=i(u),c=UI(f,4),h=c[0],d=c[1],v=c[2],p=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,p)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Wo(i,l)&&Wo(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Wo(r,i)&&Wo(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();bt(wW,Pr);const Ybe=wW;var Kbe=Ae,SW=Md,qbe=xn.f,Xbe=Va,YI=Vt,Zbe=nE,Qbe=Rr,Jbe=oE,KI=SW("".startsWith),ewe=SW("".slice),twe=Math.min,CW=Jbe("startsWith"),rwe=!CW&&!!function(){var e=qbe(String.prototype,"startsWith");return e&&!e.writable}();Kbe({target:"String",proto:!0,forced:!rwe&&!CW},{startsWith:function(t){var r=YI(Qbe(this));Zbe(t);var n=Xbe(twe(arguments.length>1?arguments[1]:void 0,r.length)),o=YI(t);return KI?KI(r,o,n):ewe(r,n,n+o.length)===o}});var qI=/^(\r\n|\n\r|\r|\n)/,nwe=/^[^\t\r\n]+/,XI=/^\t/;function owe(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(XI))e=e.replace(XI,""),r+=1,t[n][r]="";else if(e.match(qI))e=e.replace(qI,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(nwe);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function nc(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function pw(e){return swe(e)||lwe(e)||awe(e)||iwe()}function iwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function awe(e,t){if(e){if(typeof e=="string")return l_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l_(e,t)}}function lwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function swe(e){if(Array.isArray(e))return l_(e)}function l_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Es(e){return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function uwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cwe(n.key),n)}}function fwe(e,t,r){return t&&ZI(e.prototype,t),r&&ZI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cwe(e){var t=hwe(e,"string");return Es(t)==="symbol"?t:String(t)}function hwe(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dwe=function(){function e(t,r,n){uwe(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return fwe(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=uE(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ue(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return GV(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),Es(r)==="object"&&!Array.isArray(r)&&Ye(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&pe(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(pe(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?vc(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,p=this.getSchema().length,g=[],w=function(){var T=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?T=yr(n.getSchema()):(T=[],Se(p-1,function(){return T.push(null)})):n.instance.dataType==="function"?T=n.tableMeta.dataSchema(h+c):(T={},Um(T,n.getSchema())),g.push(T),c+=1};c<o&&u+c<v;)w();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,g);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===g.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",S,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),p=this.instance.countCols(),g=0,w=d;l==="end"&&(w=Math.min(w+1,f));for(var S=w;g<n&&p<u;){if(typeof c!="number"||c>=p)if(v>0)for(var _=0;_<v;_+=1)typeof s[_]>"u"&&(s[_]=[]),s[_].push(null);else s.push([null]);else for(var T=0;T<v;T++)s[T].splice(w,0,null);g+=1,w+=1,p+=1}this.instance.columnIndexMapper.insertIndexes(c,g),g>0&&(r==null?this.metaManager.createColumn(null,g):i!=="auto"&&this.metaManager.createColumn(S,n));var R=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",R,g,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=pe(this.tableMeta.columns)||pe(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(S,_){return _-S}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var p=0,g=this.instance.countSourceRows();p<g;p++)for(var w=0;w<f;w++)c[p].splice(l[w],1),p===0&&this.metaManager.removeColumn(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];D$(u,l);for(var c=0;c<o;)u.push(null),c+=1;return jJ(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];D$(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(pw(this.dataSource.slice(0,r)),pw(o),pw(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&xt(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=ql(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=ql(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&xt(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return nc(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return nc(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const vwe=dwe;var rv=Jr("cellTypes"),ywe=rv.register,pwe=rv.getItem,_W=rv.hasItem;rv.getNames;rv.getValues;function mwe(e){if(!_W(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return pwe(e)}function Rn(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&FF(e,n),o&&Yn(e,o),i&&tse(e,i),ywe(e,t)}function gwe(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!xt(t,e)}function pg(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?mwe(t.type):t.type;if(e._automaticallyAssignedMetaProps&&Ye(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ue(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};Ye(n,function(i,a){if(gwe(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),zt(e,o)}}function bwe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Si(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function Ly(e){return Number.isInteger(e)&&e>=0}function jy(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function Bv(e){return e==null}function s_(e){return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}const OW=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),qt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),qt(o)===!1)return s_(o)==="object"?(i=this.getCellMeta(t,r),wB(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function bh(e){return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}function QI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function JI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QI(Object(r),!0).forEach(function(n){wwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wwe(e,t,r){return t=EW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EW(n.key),n)}}function RW(e,t,r){return t&&eM(e.prototype,t),r&&eM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EW(e){var t=Swe(e,"string");return bh(t)==="symbol"?t:String(t)}function Swe(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cwe(){return RW(function e(){PW(this,e)})}var _we=function(){function e(t){PW(this,e),this.metaCtor=Cwe(),this.meta=this.metaCtor.prototype,zt(this.meta,OW()),this.meta.instance=t}return RW(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;zt(this.meta,r),pg(this.meta,JI(JI({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function wh(e){return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wh(e)}function Owe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ewe(n.key),n)}}function Rwe(e,t,r){return t&&tM(e.prototype,t),r&&tM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ewe(e){var t=Pwe(e,"string");return wh(t)==="symbol"?t:String(t)}function Pwe(e,t){if(wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Twe=function(){function e(t){Owe(this,e);var r=t.getMetaConstructor();this.meta=new r}return Rwe(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){zt(this.meta,r),pg(this.meta,r,r)}}]),e}();function Sh(e){return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}function rM(e){return Iwe(e)||Awe(e)||$we(e)||kwe()}function kwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $we(e,t){if(e){if(typeof e=="string")return u_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u_(e,t)}}function Awe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Iwe(e){if(Array.isArray(e))return u_(e)}function u_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dwe(n.key),n)}}function xwe(e,t,r){return t&&nM(e.prototype,t),r&&nM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dwe(e){var t=Nwe(e,"string");return Sh(t)==="symbol"?t:String(t)}function Nwe(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f_=function(e){function t(r){Mwe(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return xwe(t,[{key:"obtain",value:function(n){jy(function(){return Ly(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;jy(function(){return Ly(n)||Bv(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=Bv(n)?this.index.length:n;this.index=[].concat(rM(this.index.slice(0,s)),i,rM(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;jy(function(){return Ly(n)||Bv(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(Bv(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Yr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function Ch(e){return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}function Hwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jwe(n.key),n)}}function Lwe(e,t,r){return t&&oM(e.prototype,t),r&&oM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jwe(e){var t=Bwe(e,"string");return Ch(t)==="symbol"?t:String(t)}function Bwe(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fwe=["data","width"],Vwe=function(){function e(t){var r=this;Hwe(this,e),this.globalMeta=t,this.metas=new f_(function(){return r._createMeta()})}return Lwe(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);zt(o,n),pg(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return bwe(this.globalMeta.getMetaConstructor(),Fwe).prototype}}]),e}();function _h(e){return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function Wwe(e){return Ywe(e)||Gwe(e)||zwe(e)||Uwe()}function Uwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zwe(e,t){if(e){if(typeof e=="string")return c_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c_(e,t)}}function Gwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ywe(e){if(Array.isArray(e))return c_(e)}function c_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xwe(n.key),n)}}function qwe(e,t,r){return t&&iM(e.prototype,t),r&&iM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xwe(e){var t=Zwe(e,"string");return _h(t)==="symbol"?t:String(t)}function Zwe(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qwe=function(){function e(t){var r=this;Kwe(this,e),this.columnMeta=t,this.metas=new f_(function(){return r._createRow()})}return qwe(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);zt(i,o),pg(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,Wwe(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){jy(function(){return Ly(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new f_(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function Oh(e){return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oh(e)}function Jwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tSe(n.key),n)}}function eSe(e,t,r){return t&&aM(e.prototype,t),r&&aM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tSe(e){var t=rSe(e,"string");return Oh(t)==="symbol"?t:String(t)}function rSe(e,t){if(Oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TW=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Jwe(this,e),this.hot=t,this.globalMeta=new _we(t),this.tableMeta=new Twe(this.globalMeta),this.columnMeta=new Vwe(this.globalMeta),this.cellMeta=new Qwe(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return eSe(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();bt(TW,Pr);function em(e){return em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},em(e)}function lM(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=Po(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":wt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new vwe(o,e,u);if(t(d),em(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var p,g=0,w=0;for(g=0,w=h.startRows;g<w;g++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)p=yr(v),e.push(p);else if(o.dataType==="array")p=yr(v[0]),e.push(p);else{p=[];for(var S=0,_=h.startCols;S<_;S++)p.push(null);e.push(p)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(em(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function Rh(e){return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}function nSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iSe(n.key),n)}}function oSe(e,t,r){return t&&sM(e.prototype,t),r&&sM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iSe(e){var t=aSe(e,"string");return Rh(t)==="symbol"?t:String(t)}function aSe(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lSe=function(){function e(t){var r=this;nSe(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),me.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return oSe(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=xt(r,"type")?r.type:null,c=wt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function Eh(e){return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}function sSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fSe(n.key),n)}}function uSe(e,t,r){return t&&uM(e.prototype,t),r&&uM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fSe(e){var t=cSe(e,"string");return Eh(t)==="symbol"?t:String(t)}function cSe(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hSe=function(){function e(t){sSe(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return uSe(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),fM=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Fv=function(t){return t.map(function(r){var n=r.toLowerCase();return fM.has(n)?fM.get(n):n}).sort().join("+")},dSe=function(t){return t.split("+")},cM=function(t){return t.toLowerCase()},hM;function vSe(e){return mSe(e)||pSe(e)||kW(e)||ySe()}function ySe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mSe(e){if(Array.isArray(e))return h_(e)}function gSe(e,t){return SSe(e)||wSe(e,t)||kW(e,t)||bSe()}function bSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kW(e,t){if(e){if(typeof e=="string")return h_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h_(e,t)}}function h_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function SSe(e){if(Array.isArray(e))return e}function CSe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var _Se=function(t){var r=ag({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,p=v===void 0?function(){return!0}:v,g=f.captureCtrl,w=g===void 0?!1:g,S=f.preventDefault,_=S===void 0?!0:S,T=f.stopPropagation,R=T===void 0?!1:T,W=f.relativeToGroup,z=f.position;if(mt(d))throw new Error("You need to define the shortcut's group.");if(wt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(ct(hM||(hM=CSe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var X={callback:h,group:d,runOnlyIf:p,captureCtrl:w,preventDefault:_,stopPropagation:R};if(pe(W)){var K=[W,z];X.relativeToGroup=K[0],X.position=K[1]}c.forEach(function(q){var Q=Fv(q),ae=r.hasItem(Q);if(ae){var Z=r.getItem(Q),fe=Z.findIndex(function(Oe){return Oe.group===W});fe!==-1?z==="before"?fe-=1:fe+=1:fe=Z.length,Z.splice(fe,0,X)}else r.addItem(Q,[X])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){Ye(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=Fv(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=gSe(h,2),v=d[0],p=d[1],g=p.filter(function(w){return w.group!==f});g.length===0?i(dSe(v)):(p.length=0,p.push.apply(p,vSe(g)))})},l=function(f){var c=Fv(f),h=r.getItem(c);return pe(h)?h.slice():[]},s=function(f){var c=Fv(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function OSe(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var RSe=["meta","alt","shift","control"],kf=OSe();function ESe(e,t,r,n,o){var i=function(d){return RSe.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,p=[];return d.altKey&&p.push("alt"),v&&(d.ctrlKey||d.metaKey)?p.push("control/meta"):(d.ctrlKey&&p.push("control"),d.metaKey&&p.push("meta")),d.shiftKey&&p.push("shift"),p},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||Pl(d))){var p=cM(d.key),g=[];i(p)?kf.press(p):g=a(d);var w=[p].concat(g),S=o(d,w);!S&&(B$()&&g.includes("meta")||!B$()&&g.includes("control"))&&o(d,[p].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=cM(d.key);i(v)!==!1&&kf.release(v)}},u=function(){kf.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=bp(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=bp(d)};return{mount:f,unmount:c,isPressed:function(d){return kf.isPressed(d)},releasePressedKeys:function(){return kf.releaseAll()}}}var PSe=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=ag({errorIdExists:function(p){return'The "'.concat(p,'" context name is already registered.')}}),l="grid",s=function(p){var g=_Se(p);return a.addItem(p,g),g},u=function(){return l},f=function(p){return a.getItem(p)},c=function(p){l=p},h=!1,d=ESe(r,n,o,i,function(v,p){var g=f(u()),w=!1;if(!g.hasShortcut(p))return w;for(var S=g.getShortcuts(p),_=0;_<S.length;_++){var T=S[_],R=T.callback,W=T.runOnlyIf,z=T.preventDefault,X=T.stopPropagation,K=T.captureCtrl;if(W(v)!==!1&&(h=K,w=R(v,p)===!1,h=!1,z&&v.preventDefault(),X&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},dM,vM;function wr(e){return wr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wr(e)}function yM(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function gn(e,t){return $Se(e)||kSe(e,t)||$W(e,t)||TSe()}function TSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $Se(e){if(Array.isArray(e))return e}function Uo(e){return MSe(e)||ISe(e)||$W(e)||ASe()}function ASe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $W(e,t){if(e){if(typeof e=="string")return d_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d_(e,t)}}function ISe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MSe(e){if(Array.isArray(e))return d_(e)}function d_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xSe="gridDefault",mw=null,Vv=new Set;function RP(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new At(a),s,u,f,c,h=!0;Gve(o)&&zve(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=zme(t.language);var p=new TW(a,t,[lSe,hSe]),g=p.getTableMeta(),w=p.getGlobalMeta(),S=ag();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),WC(this)&&Koe(t.licenseKey,e),this.guid="ht_".concat(bF()),this.columnIndexMapper=new r_,this.rowIndexMapper=new r_,u=new pye(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var _=function(m){var b=m.row,O=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,O>=0?a.columnIndexMapper.getRenderableFromVisualIndex(O):O)},T=function(m){var b=m.row,O=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,O>=0?a.columnIndexMapper.getVisualFromRenderableIndex(O):O)},R=new Ybe(g,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(m){return s.propToCol(m)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(m,b){return a._createCellCoords(m,b)},createCellRange:function(m,b,O){return a._createCellRange(m,b,O)},visualToRenderableCoords:_,renderableToVisualCoords:T,isDisabledCellSelection:function(m,b){return a.getCellMeta(m,b).disableVisualSelection}});this.selection=R;var W=function(m){var b=m.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",W),this.rowIndexMapper.addLocalHook("cacheUpdated",W),this.selection.addLocalHook("beforeSetRangeStart",function(y){n.runHooks("beforeSetRangeStart",y)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(y){n.runHooks("beforeSetRangeStartOnly",y)}),this.selection.addLocalHook("beforeSetRangeEnd",function(y){n.runHooks("beforeSetRangeEnd",y),y.row<0&&(y.row=n.view._wt.wtTable.getFirstVisibleRow()),y.col<0&&(y.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(y){var m=ql(!1),b=n.selection.getSelectedRange(),O=b.current(),P=O.from,A=O.to,B=b.size()-1;n.runHooks("afterSelection",P.row,P.col,A.row,A.col,m,B),n.runHooks("afterSelectionByProp",P.row,a.colToProp(P.col),A.row,a.colToProp(A.col),m,B);var V=n.selection.isSelectedByAnyHeader(),G=n.selection.selectedRange.current(),J=!0;i&&(J=!1),m.isTouched()&&(J=!m.value);var ee=n.selection.isSelectedByRowHeader(),le=n.selection.isSelectedByColumnHeader();J!==!1&&(V?ee?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(y.row)):le&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(y.col)):G&&!n.selection.isMultiple()?n.view.scrollViewport(_(G.from)):n.view.scrollViewport(_(y))),ee&&le?re(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ee?(He(n.rootElement,"ht__selection--columns"),re(n.rootElement,"ht__selection--rows")):le?(He(n.rootElement,"ht__selection--rows"),re(n.rootElement,"ht__selection--columns")):He(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(y){var m=y.length-1,b=y[m],O=b.from,P=b.to;n.runHooks("afterSelectionEnd",O.row,O.col,P.row,P.col,m),n.runHooks("afterSelectionEndByProp",O.row,a.colToProp(O.col),P.row,a.colToProp(P.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",function(y){var m=n.runHooks("afterIsMultipleSelection",y.value);y.value&&(y.value=m)}),this.selection.addLocalHook("beforeModifyTransformStart",function(y){n.runHooks("modifyTransformStart",y)}),this.selection.addLocalHook("afterModifyTransformStart",function(y,m,b){n.runHooks("afterModifyTransformStart",y,m,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(y){n.runHooks("modifyTransformEnd",y)}),this.selection.addLocalHook("afterModifyTransformEnd",function(y,m,b){n.runHooks("afterModifyTransformEnd",y,m,b)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),He(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(y){n.alter("insert_row_above",y,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(y){n.alter("insert_col_start",y,1,"auto")}),f={alter:function(m,b){var O,P,A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,B=arguments.length>3?arguments[3]:void 0,V=arguments.length>4?arguments[4]:void 0,G=function(xe){if(xe.length===0)return[];var De=Uo(xe);De.sort(function(ot,Je){var qe=gn(ot,1),Qe=qe[0],Nt=gn(Je,1),ht=Nt[0];return Qe===ht?0:Qe>ht?1:-1});var tt=ir(De,function(ot,Je){var qe=gn(Je,2),Qe=qe[0],Nt=qe[1],ht=ot[ot.length-1],lt=gn(ht,2),rt=lt[0],Oi=lt[1],jo=rt+Oi;if(Qe<=jo){var Ka=Math.max(Nt-(jo-Qe),0);ht[1]+=Ka}else ot.push([Qe,Nt]);return ot},[De[0]]);return tt};switch(m){case"insert_row":Vv.has(m)||(Vv.add(m),dt(ct(dM||(dM=yM(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),m)));case"insert_row_below":case"insert_row_above":var J=a.countSourceRows();if(g.maxRows===J)return;var ee=m==="insert_row_below"?"below":"above";b=(O=b)!==null&&O!==void 0?O:m==="insert_row"||ee==="below"?J:0;var le=s.createRow(b,A,{source:B,mode:ee}),Re=le.delta,ce=le.startPhysicalIndex;if(Re){var he=R.selectedRange.current(),Y=he==null?void 0:he.from,Ie=Y==null?void 0:Y.row,ze=a.toVisualRow(ce);if(R.isSelectedByCorner())a.selectAll();else if(pe(Ie)&&Ie>=ze){var Te=he.to,$e=Te.row,ke=Te.col,C=Y.col;R.isSelectedByRowHeader()&&(C=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(Ie+Re,C),!0),R.setRangeEnd(a._createCellCoords($e+Re,ke))}else a._refreshBorders()}break;case"insert_col":Vv.has(m)||(Vv.add(m),dt(ct(vM||(vM=yM(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),m)));case"insert_col_start":case"insert_col_end":var E=m==="insert_col_end"?"end":"start";b=(P=b)!==null&&P!==void 0?P:m==="insert_col"||E==="end"?a.countSourceCols():0;var $=s.createCol(b,A,{source:B,mode:E}),H=$.delta,M=$.startPhysicalIndex;if(H){if(Array.isArray(g.colHeaders)){var j=[a.toVisualColumn(M),0];j.length+=H,Array.prototype.splice.apply(g.colHeaders,j)}var x=R.selectedRange.current(),D=x==null?void 0:x.from,F=D==null?void 0:D.col,L=a.toVisualColumn(M);if(R.isSelectedByCorner())a.selectAll();else if(pe(F)&&F>=L){var U=x.to,ie=U.row,ye=U.col,_e=D.row;R.isSelectedByColumnHeader()&&(_e=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(a._createCellCoords(_e,F+H),!0),R.setRangeEnd(a._createCellCoords(ie,ye+H))}else a._refreshBorders()}break;case"remove_row":var Me=function(xe){var De=0;I(xe,function(tt){var ot=gn(tt,2),Je=ot[0],qe=ot[1],Qe=qt(Je)?a.countRows()-1:Math.max(Je-De,0);Number.isInteger(Je)&&(Je=Math.max(Je-De,0));var Nt=s.removeRow(Je,qe,B);if(Nt){var ht=a.countRows(),lt=g.fixedRowsTop;lt>=Qe+1&&(g.fixedRowsTop-=Math.min(qe,lt-Qe));var rt=g.fixedRowsBottom;rt&&Qe>=ht-rt&&(g.fixedRowsBottom-=Math.min(qe,rt)),De+=qe}})};Array.isArray(b)?Me(G(b)):Me([[b,A]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var Ke=function(xe){var De=0;I(xe,function(tt){var ot=gn(tt,2),Je=ot[0],qe=ot[1],Qe=qt(Je)?a.countCols()-1:Math.max(Je-De,0),Nt=a.toPhysicalColumn(Qe);Number.isInteger(Je)&&(Je=Math.max(Je-De,0));var ht=s.removeCol(Je,qe,B);if(ht){var lt=g.fixedColumnsStart;lt>=Qe+1&&(g.fixedColumnsStart-=Math.min(qe,lt-Qe)),Array.isArray(g.colHeaders)&&(typeof Nt>"u"&&(Nt=-1),g.colHeaders.splice(Nt,qe)),De+=qe}})};Array.isArray(b)?Ke(G(b)):Ke([[b,A]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(m,'"'))}V||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var m=g.minRows,b=g.minSpareRows,O=g.minCols,P=g.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&R.deselect(),m){var A=a.countRows();A<m&&s.createRow(A,m-A,{source:"auto"})}if(b){var B=a.countEmptyRows(!0);if(B<b){var V=b-B,G=Math.min(V,g.maxRows-a.countSourceRows());s.createRow(a.countRows(),G,{source:"auto"})}}{var J;(O||P)&&(J=a.countEmptyCols(!0));var ee=a.countCols();if(O&&!g.columns&&ee<O){var le=O-ee;J+=le,s.createCol(ee,le,{source:"auto"})}if(P&&!g.columns&&a.dataType==="array"&&J<P){ee=a.countCols();var Re=P-J,ce=Math.min(Re,g.maxCols-ee);s.createCol(ee,ce,{source:"auto"})}}if(R.isSelected()){var he=a.countRows(),Y=a.countCols();I(R.selectedRange,function(Ie){var ze=!1,Te=Ie.from.row,$e=Ie.from.col,ke=Ie.to.row,C=Ie.to.col;Te>he-1?(Te=he-1,ze=!0,ke>Te&&(ke=Te)):ke>he-1&&(ke=he-1,ze=!0,Te>ke&&(Te=ke)),$e>Y-1?($e=Y-1,ze=!0,C>$e&&(C=$e)):C>Y-1&&(C=Y-1,ze=!0,$e>C&&($e=C)),ze&&a.selectCell(Te,$e,ke,C)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(m,b,O,P,A,B,V){var G,J,ee,le,Re=[],ce={},he=[],Y=m.row,Ie=m.col;if(J=b.length,J===0)return!1;var ze=0,Te=0;switch(Ue(O)&&(ze=O.col-Ie+1,Te=O.row-Y+1),A){case"shift_down":var $e=Cy(b),ke=$e.length,C=Math.max(ke,ze),E=a.getData().slice(Y),$=Cy(E).slice(Ie,Ie+C);for(ee=0;ee<C;ee+=1)if(ee<ke){for(G=0,J=$e[ee].length;G<Te-J;G+=1)$e[ee].push($e[ee][G%J]);ee<$.length?he.push($e[ee].concat($[ee])):he.push($e[ee].concat(new Array(E.length).fill(null)))}else he.push($e[ee%ke].concat($[ee]));a.populateFromArray(Y,Ie,Cy(he));break;case"shift_right":var H=b.length,M=Math.max(H,Te),j=a.getData().slice(Y).map(function(lt){return lt.slice(Ie)});for(G=0;G<M;G+=1)if(G<H){for(ee=0,le=b[G].length;ee<ze-le;ee+=1)b[G].push(b[G][ee%le]);if(G<j.length)for(var x=0;x<j[G].length;x+=1)b[G].push(j[G][x]);else{var D;(D=b[G]).push.apply(D,Uo(new Array(j[0].length).fill(null)))}}else b.push(b[G%J].slice(0,M).concat(j[G]));a.populateFromArray(Y,Ie,b);break;case"overwrite":default:ce.row=m.row,ce.col=m.col;var F={row:O&&m?O.row-m.row+1:1,col:O&&m?O.col-m.col+1:1},L=0,U=0,ie=!0,ye,_e=function(rt){var Oi=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,jo=b[rt%b.length];return Oi!==null?jo[Oi%jo.length]:jo},Me=b.length,Ke=O?O.row-m.row+1:0;for(O?J=Ke:J=Math.max(Me,Ke),G=0;G<J&&!(O&&ce.row>O.row&&Ke>Me||!g.allowInsertRow&&ce.row>a.countRows()-1||ce.row>=g.maxRows);G++){var ft=G-L,xe=_e(ft).length,De=O?O.col-m.col+1:0;if(O?le=De:le=Math.max(xe,De),ce.col=m.col,ye=a.getCellMeta(ce.row,ce.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&ye.skipRowOnPaste){L+=1,ce.row+=1,J+=1;continue}for(U=0,ee=0;ee<le&&!(O&&ce.col>O.col&&De>xe||!g.allowInsertColumn&&ce.col>a.countCols()-1||ce.col>=g.maxCols);ee++){if(ye=a.getCellMeta(ce.row,ce.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&ye.skipColumnOnPaste){U+=1,ce.col+=1,le+=1;continue}if(ye.readOnly&&P!=="UndoRedo.undo"){ce.col+=1;continue}var tt=ee-U,ot=_e(ft,tt),Je=a.getDataAtCell(ce.row,ce.col),qe={row:ft,col:tt};if(P==="Autofill.fill"){var Qe=a.runHooks("beforeAutofillInsidePopulate",qe,B,b,V,{},F);Qe&&(ot=mt(Qe.value)?ot:Qe.value)}if(ot!==null&&wr(ot)==="object")if(Array.isArray(ot)&&Je===null&&(Je=[]),Je===null||wr(Je)!=="object")ie=!1;else{var Nt=vc(Array.isArray(Je)?Je:Je[0]||Je),ht=vc(Array.isArray(ot)?ot:ot[0]||ot);wB(Nt,ht)||Array.isArray(Nt)&&Array.isArray(ht)?ot=yr(ot):ie=!1}else Je!==null&&wr(Je)==="object"&&(ie=!1);ie&&Re.push([ce.row,ce.col,ot]),ie=!0,ce.col+=1}ce.row+=1}a.setDataAtCell(Re,null,null,P||"populateFromArray");break}}};function z(y){var m=oW(y);SP(m)?(a.runHooks("beforeLanguageChange",m),w.language=m,a.runHooks("afterLanguageChange",m)):iW(y)}function X(y,m){var b=y==="className"?a.rootElement:a.table;if(h)re(b,m);else{var O=[],P=[];w[y]&&(O=Array.isArray(w[y])?w[y]:H$(w[y])),m&&(P=Array.isArray(m)?m:H$(m));var A=N$(O,P),B=N$(P,O);A.length&&He(b,A),B.length&&re(b,B)}w[y]=m}this.init=function(){u.setData(g.data),a.runHooks("beforeInit"),($n()||_B())&&re(a.rootElement,"mobile"),this.updateSettings(g,!0),this.view=new aye(this),c=cae.getInstance(a,g,R),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&fie(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),wr(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function K(){var y=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,y=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&y===!1&&(y=!0,this.onQueueEmpty(this.valid))}}}function q(y){var m=y.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):y}function Q(y,m,b){if(y.length){var O=a.getActiveEditor(),P=a.runHooks("beforeChange",y,m||"edit"),A=!0;if(P===!1){O&&O.cancelChanges();return}var B=new K;B.onQueueEmpty=function(he){O&&A&&O.cancelChanges(),b(he)};for(var V=y.length-1;V>=0;V--)if(y[V]===null)y.splice(V,1);else{var G=gn(y[V],4),J=G[0],ee=G[1],le=G[3],Re=s.propToCol(ee),ce=a.getCellMeta(J,Re);ce.type==="numeric"&&typeof le=="string"&&lle(le)&&(y[V][3]=q(le)),a.getCellValidator(ce)&&(B.addValidatorToQueue(),a.validateCell(y[V][3],ce,function(he,Y){return function(Ie){if(typeof Ie!="boolean")throw new Error("Validation error: result is not boolean");if(Ie===!1&&Y.allowInvalid===!1){A=!1,y.splice(he,1),Y.valid=!0;var ze=a.getCell(Y.visualRow,Y.visualCol);ze!==null&&He(ze,g.invalidCellClassName)}B.removeValidatorFormQueue()}}(V,ce),m))}B.checkIfQueueIsEmpty()}}function ae(y,m){var b=y.length-1;if(!(b<0)){for(;b>=0;b--){var O=!1;if(y[b]===null){y.splice(b,1);continue}if(!((y[b][2]===null||y[b][2]===void 0)&&(y[b][3]===null||y[b][3]===void 0))){if(g.allowInsertRow)for(;y[b][0]>a.countRows()-1;){var P=s.createRow(void 0,void 0,{source:m}),A=P.delta;if(A===0){O=!0;break}}if(a.dataType==="array"&&(!g.columns||g.columns.length===0)&&g.allowInsertColumn)for(;s.propToCol(y[b][1])>a.countCols()-1;){var B=s.createCol(void 0,void 0,{source:m}),V=B.delta;if(V===0){O=!0;break}}O||s.set(y[b][0],y[b][1],y[b][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",y,m),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",y,m||"edit");var G=a.getActiveEditor();G&&pe(G.refreshValue)&&G.refreshValue()}}this._createCellCoords=function(y,m){return a.view._wt.createCellCoords(y,m)},this._createCellRange=function(y,m,b){return a.view._wt.createCellRange(y,m,b)},this.validateCell=function(y,m,b,O){var P=a.getCellValidator(m);function A(B){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!V||m.hidden===!0){b(B);return}var G=m.visualCol,J=m.visualRow,ee=a.getCell(J,G,!0);if(ee&&ee.nodeName!=="TH"){var le=a.rowIndexMapper.getRenderableFromVisualIndex(J),Re=a.columnIndexMapper.getRenderableFromVisualIndex(G);a.view._wt.getSetting("cellRenderer",le,Re,ee)}b(B)}zoe(P)&&(P=function(B){return function(V,G){G(B.test(V))}}(P)),wt(P)?(y=a.runHooks("beforeValidate",y,m.visualRow,m.prop,O),a._registerImmediate(function(){P.call(m,y,function(B){a&&(B=a.runHooks("afterValidate",B,y,m.visualRow,m.prop,O),m.valid=B,A(B),a.runHooks("postAfterValidate",B,y,m.visualRow,m.prop,O))})})):a._registerImmediate(function(){m.valid=!0,A(m.valid,!1)})};function Z(y,m,b){return Array.isArray(y)?y:[[y,m,b]]}this.setDataAtCell=function(y,m,b,O){var P=Z(y,m,b),A=[],B=O,V,G,J;for(V=0,G=P.length;V<G;V++){if(wr(P[V])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof P[V][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");P[V][1]>=this.countCols()?J=P[V][1]:J=s.colToProp(P[V][1]),A.push([P[V][0],J,u.getAtCell(this.toPhysicalRow(P[V][0]),P[V][1]),P[V][2]])}!B&&wr(y)==="object"&&(B=m),a.runHooks("afterSetDataAtCell",A,B),Q(A,B,function(){ae(A,B)})},this.setDataAtRowProp=function(y,m,b,O){var P=Z(y,m,b),A=[],B=O,V,G;for(V=0,G=P.length;V<G;V++)A.push([P[V][0],P[V][1],u.getAtCell(this.toPhysicalRow(P[V][0]),P[V][1]),P[V][2]]);!B&&wr(y)==="object"&&(B=m),a.runHooks("afterSetDataAtRowProp",A,B),Q(A,B,function(){ae(A,B)})},this.listen=function(){a&&!a.isListening()&&(mw=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(mw=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return mw===a.guid},this.destroyEditor=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(y,m)},this.populateFromArray=function(y,m,b,O,P,A,B,V,G){if(!(wr(b)==="object"&&wr(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var J=typeof O=="number"?a._createCellCoords(O,P):null;return f.populateFromArray(a._createCellCoords(y,m),b,J,A,B,V,G)},this.spliceCol=function(y,m,b){for(var O,P=arguments.length,A=new Array(P>3?P-3:0),B=3;B<P;B++)A[B-3]=arguments[B];return(O=s).spliceCol.apply(O,[y,m,b].concat(A))},this.spliceRow=function(y,m,b){for(var O,P=arguments.length,A=new Array(P>3?P-3:0),B=3;B<P;B++)A[B-3]=arguments[B];return(O=s).spliceRow.apply(O,[y,m,b].concat(A))},this.getSelected=function(){if(R.isSelected())return We(R.getSelectedRange(),function(y){var m=y.from,b=y.to;return[m.row,m.col,b.row,b.col]})},this.getSelectedLast=function(){var y=this.getSelected(),m;return y&&y.length>0&&(m=y[y.length-1]),m},this.getSelectedRange=function(){if(R.isSelected())return Array.from(R.getSelectedRange())},this.getSelectedRangeLast=function(){var y=this.getSelectedRange(),m;return y&&y.length>0&&(m=y[y.length-1]),m},this.emptySelectedCells=function(y){var m=this;if(!(!R.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];I(R.getSelectedRange(),function(O){var P=O.getTopStartCorner(),A=O.getBottomEndCorner();Se(P.row,A.row,function(B){Se(P.col,A.col,function(V){m.getCellMeta(B,V).readOnly||b.push([B,V,null])})})}),b.length>0&&this.setDataAtCell(b,y)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var y=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(y,0),!this.isRenderSuspended()&&y===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(y){this.suspendRender();var m=y();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||y)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=y();return this.resumeExecution(m),b},this.batch=function(y){this.suspendRender(),this.suspendExecution();var m=y();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(a.view){var y=a.view.getLastSize(),m=y.width,b=y.height,O=a.rootElement.getBoundingClientRect(),P=O.width,A=O.height,B=P!==m||A!==b,V=a.runHooks("beforeRefreshDimensions",{width:m,height:b},{width:P,height:A},B)===!1;V||((B||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(P,A),a.render()),a.runHooks("afterRefreshDimensions",{width:m,height:b},{width:P,height:A},B))}},this.updateData=function(y,m){var b=this;lM(y,function(O){s=O},function(O){s=O,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:m,metaManager:p,firstRun:h})},this.loadData=function(y,m){lM(y,function(b){s=b},function(){p.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:m,metaManager:p,firstRun:h})},this.getInitialColumnCount=function(){var y=g.columns,m=0;if(Array.isArray(y))m=y.length;else if(wt(y))if(a.dataType==="array")for(var b=this.countSourceCols(),O=0;O<b;O+=1)y(O)&&(m+=1);else(a.dataType==="object"||a.dataType==="function")&&(m=s.colToPropCache.length);else if(pe(g.dataSchema)){var P=s.getSchema();m=Array.isArray(P)?P.length:uE(P)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(y,m,b,O){return mt(y)?s.getAll():s.getRange(a._createCellCoords(y,m),a._createCellCoords(b,O),s.DESTINATION_RENDERER)},this.getCopyableText=function(y,m,b,O){return s.getCopyableText(a._createCellCoords(y,m),a._createCellCoords(b,O))},this.getCopyableData=function(y,m){return s.getCopyable(y,s.colToProp(m))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),O=!1,P,A;if(pe(y.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(pe(y.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(pe(y.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(P in y)P==="data"||(P==="language"?z(y.language):P==="className"?X("className",y.className):P==="tableClassName"&&a.table?(X("tableClassName",y.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):me.getSingleton().isRegistered(P)||me.getSingleton().isDeprecated(P)?(wt(y[P])||Array.isArray(y[P]))&&(y[P].initialHook=!0,a.addHook(P,y[P])):!m&&xt(y,P)&&(w[P]=y[P]));y.data===void 0&&g.data===void 0?b(null,"updateSettings"):y.data!==void 0?b(y.data,"updateSettings"):y.columns!==void 0&&(s.createMap(),a.initIndexMappers());var B=a.countCols(),V=g.columns;if(V&&wt(V)&&(O=!0),(y.cell!==void 0||y.cells!==void 0||y.columns!==void 0)&&p.clearCache(),B>0)for(P=0,A=0;P<B;P++){if(V){var G=O?V(P):V[A];G&&p.updateColumnMeta(A,G)}A+=1}pe(y.cell)&&Ye(y.cell,function(he){a.setCellMetaObject(he.row,he.col,he)}),a.runHooks("afterCellMetaReset");var J=a.rootElement.style.height;J!==""&&(J=parseInt(a.rootElement.style.height,10));var ee=y.height;if(wt(ee)&&(ee=ee()),m){var le=a.rootElement.getAttribute("style");le&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ee===null){var Re=a.rootElement.getAttribute("data-initialstyle");Re&&(Re.indexOf("height")>-1||Re.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",Re):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ee!==void 0&&(a.rootElement.style.height=isNaN(ee)?"".concat(ee):"".concat(ee,"px"),a.rootElement.style.overflow="hidden");if(typeof y.width<"u"){var ce=y.width;wt(ce)&&(ce=ce()),a.rootElement.style.width=isNaN(ce)?"".concat(ce):"".concat(ce,"px")}m||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",y)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!m&&a.view&&(J===""||ee===""||ee===void 0)&&J!==ee&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var y=a.getSelectedLast();if(g.getValue){if(wt(g.getValue))return g.getValue.call(a);if(y)return a.getData()[y[0][0]][g.getValue]}else if(y)return a.getDataAtCell(y[0],y[1])},this.getSettings=function(){return g},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(y,m,b,O,P){f.alter(y,m,b,O,P)},this.getCell=function(y,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=m,P=y;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;O=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(y>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(y)))return null;P=this.rowIndexMapper.getRenderableFromVisualIndex(y)}return P===null||O===null?null:a.view.getCellAtCoords(a._createCellCoords(P,O),b)},this.getCoords=function(y){var m=this.view._wt.wtTable.getCoords(y);if(m===null)return null;var b=m.row,O=m.col,P=b,A=O;return b>=0&&(P=this.rowIndexMapper.getVisualFromRenderableIndex(b)),O>=0&&(A=this.columnIndexMapper.getVisualFromRenderableIndex(O)),a._createCellCoords(P,A)},this.colToProp=function(y){return s.colToProp(y)},this.propToCol=function(y){return s.propToCol(y)},this.toVisualRow=function(y){return n.rowIndexMapper.getVisualFromPhysicalIndex(y)},this.toVisualColumn=function(y){return n.columnIndexMapper.getVisualFromPhysicalIndex(y)},this.toPhysicalRow=function(y){return n.rowIndexMapper.getPhysicalFromVisualIndex(y)},this.toPhysicalColumn=function(y){return n.columnIndexMapper.getPhysicalFromVisualIndex(y)},this.getDataAtCell=function(y,m){return s.get(y,s.colToProp(m))},this.getDataAtRowProp=function(y,m){return s.get(y,m)},this.getDataAtCol=function(y){var m;return(m=[]).concat.apply(m,Uo(s.getRange(a._createCellCoords(0,y),a._createCellCoords(g.data.length-1,y),s.DESTINATION_RENDERER)))},this.getDataAtProp=function(y){var m,b=s.getRange(a._createCellCoords(0,s.propToCol(y)),a._createCellCoords(g.data.length-1,s.propToCol(y)),s.DESTINATION_RENDERER);return(m=[]).concat.apply(m,Uo(b))},this.getSourceData=function(y,m,b,O){var P;return y===void 0?P=u.getData():P=u.getByRange(a._createCellCoords(y,m),a._createCellCoords(b,O)),P},this.getSourceDataArray=function(y,m,b,O){var P;return y===void 0?P=u.getData(!0):P=u.getByRange(a._createCellCoords(y,m),a._createCellCoords(b,O),!0),P},this.getSourceDataAtCol=function(y){return u.getAtColumn(y)},this.setSourceDataAtCell=function(y,m,b,O){var P=Z(y,m,b),A=this.hasHook("afterSetSourceDataAtCell"),B=[];A&&I(P,function(G){var J=gn(G,3),ee=J[0],le=J[1],Re=J[2];B.push([ee,le,u.getAtCell(ee,le),Re])}),I(P,function(G){var J=gn(G,3),ee=J[0],le=J[1],Re=J[2];u.setAtCell(ee,le,Re)}),A&&this.runHooks("afterSetSourceDataAtCell",B,O),this.render();var V=a.getActiveEditor();V&&pe(V.refreshValue)&&V.refreshValue()},this.getSourceDataAtRow=function(y){return u.getAtRow(y)},this.getSourceDataAtCell=function(y,m){return u.getAtCell(y,m)},this.getDataAtRow=function(y){var m=s.getRange(a._createCellCoords(y,0),a._createCellCoords(y,this.countCols()-1),s.DESTINATION_RENDERER);return m[0]||[]},this.getDataType=function(y,m,b,O){var P=this,A=y===void 0?[0,0,this.countRows(),this.countCols()]:[y,m,b,O],B=A[0],V=A[1],G=A[2],J=A[3],ee=null,le=null;G===void 0&&(G=B),J===void 0&&(J=V);var Re="mixed";return Se(Math.max(Math.min(B,G),0),Math.max(B,G),function(ce){var he=!0;return Se(Math.max(Math.min(V,J),0),Math.max(V,J),function(Y){var Ie=P.getCellMeta(ce,Y);return le=Ie.type,ee?he=ee===le:ee=le,he}),Re=he?le:"mixed",he}),Re},this.removeCellMeta=function(y,m,b){var O=[this.toPhysicalRow(y),this.toPhysicalColumn(m)],P=O[0],A=O[1],B=p.getCellMetaKeyValue(P,A,b),V=a.runHooks("beforeRemoveCellMeta",y,m,b,B);V!==!1&&(p.removeCellMeta(P,A,b),a.runHooks("afterRemoveCellMeta",y,m,b,B)),B=null},this.spliceCellsMeta=function(y){for(var m=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,O=arguments.length,P=new Array(O>2?O-2:0),A=2;A<O;A++)P[A-2]=arguments[A];if(P.length>0&&!Array.isArray(P[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&p.removeRow(this.toPhysicalRow(y),b),P.length>0&&I(P.reverse(),function(B){p.createRow(m.toPhysicalRow(y)),I(B,function(V,G){return m.setCellMetaObject(y,G,V)})}),a.render()},this.setCellMetaObject=function(y,m,b){var O=this;wr(b)==="object"&&Ye(b,function(P,A){O.setCellMeta(y,m,A,P)})},this.setCellMeta=function(y,m,b,O){var P=a.runHooks("beforeSetCellMeta",y,m,b,O);if(P!==!1){var A=y,B=m;y<this.countRows()&&(A=this.toPhysicalRow(y)),m<this.countCols()&&(B=this.toPhysicalColumn(m)),p.setCellMeta(A,B,b,O),a.runHooks("afterSetCellMeta",y,m,b,O)}},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(y,m){var b=this.toPhysicalRow(y),O=this.toPhysicalColumn(m);return b===null&&(b=y),O===null&&(O=m),p.getCellMeta(b,O,{visualRow:y,visualColumn:m})},this.getCellMetaAtRow=function(y){return p.getCellsMetaAtRow(y)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||g.columns)},this.getCellRenderer=function(y,m){var b=typeof y=="number"?a.getCellMeta(y,m).renderer:y.renderer;return typeof b=="string"?j1(b):mt(b)?j1("text"):b},this.getCellEditor=function(y,m){var b=typeof y=="number"?a.getCellMeta(y,m).editor:y.editor;return typeof b=="string"?R1(b):mt(b)?R1("text"):b},this.getCellValidator=function(y,m){var b=typeof y=="number"?a.getCellMeta(y,m).validator:y.validator;return typeof b=="string"?ese(b):b},this.validateCells=function(y){this._validateCells(y)},this.validateRows=function(y,m){if(!Array.isArray(y))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,y)},this.validateColumns=function(y,m){if(!Array.isArray(y))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,y)},this._validateCells=function(y,m,b){var O=new K;y&&(O.onQueueEmpty=y);for(var P=a.countRows()-1;P>=0;){if(m!==void 0&&m.indexOf(P)===-1){P-=1;continue}for(var A=a.countCols()-1;A>=0;){if(b!==void 0&&b.indexOf(A)===-1){A-=1;continue}O.addValidatorToQueue(),a.validateCell(a.getDataAtCell(P,A),a.getCellMeta(P,A),function(B){if(typeof B!="boolean")throw new Error("Validation error: result is not boolean");B===!1&&(O.valid=!1),O.removeValidatorFormQueue()},"validateCells"),A-=1}P-=1}O.checkIfQueueIsEmpty()},this.getRowHeader=function(y){var m=g.rowHeaders,b=y;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(m=[],Se(a.countRows()-1,function(O){m.push(a.getRowHeader(O))})):Array.isArray(m)&&m[b]!==void 0?m=m[b]:wt(m)?m=m(b):m&&typeof m!="string"&&typeof m!="number"&&(m=b+1),m},this.hasRowHeaders=function(){return!!g.rowHeaders},this.hasColHeaders=function(){if(g.colHeaders!==void 0&&g.colHeaders!==null)return!!g.colHeaders;for(var y=0,m=a.countCols();y<m;y++)if(a.getColHeader(y))return!0;return!1},this.getColHeader=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",y);if(b===void 0){for(var O=[],P=a.countCols(),A=0;A<P;A++)O.push(a.getColHeader(A));return O}var B=g.colHeaders,V=function(le){for(var Re=[],ce=a.countCols(),he=0;he<ce;he++)wt(g.columns)&&g.columns(he)&&Re.push(he);return Re[le]},G=a.toPhysicalColumn(b),J=V(G);return g.colHeaders===!1?B=null:g.columns&&wt(g.columns)&&g.columns(J)&&g.columns(J).title?B=g.columns(J).title:g.columns&&g.columns[G]&&g.columns[G].title?B=g.columns[G].title:Array.isArray(g.colHeaders)&&g.colHeaders[G]!==void 0?B=g.colHeaders[G]:wt(g.colHeaders)?B=g.colHeaders(G):g.colHeaders&&typeof g.colHeaders!="string"&&typeof g.colHeaders!="number"&&(B=sye(b)),B=a.runHooks("modifyColumnHeaderValue",B,y,m),B},this._getColWidthFromSettings=function(y){var m;if(y>=0){var b=a.getCellMeta(0,y);m=b.width}if((m===void 0||m===g.width)&&(m=g.colWidths),m!=null){switch(wr(m)){case"object":m=m[y];break;case"function":m=m(y);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(y){var m=a._getColWidthFromSettings(y);return m=a.runHooks("modifyColWidth",m,y),m===void 0&&(m=HE.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(y){var m=g.rowHeights;if(m!=null){switch(wr(m)){case"object":m=m[y];break;case"function":m=m(y);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(y){var m=a._getRowHeightFromSettings(y);return m=a.runHooks("modifyRowHeight",m,y),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var y=g.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(y,m)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return mC(a.countRows()-1,function(b){if(a.isEmptyRow(b))m+=1;else if(y===!0)return!1}),m},this.countEmptyCols=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return mC(a.countCols()-1,function(b){if(a.isEmptyCol(b))m+=1;else if(y===!0)return!1}),m},this.isEmptyRow=function(y){return g.isEmptyRow.call(a,y)},this.isEmptyCol=function(y){return g.isEmptyCol.call(a,y)},this.selectCell=function(y,m,b,O){var P=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return mt(y)||mt(m)?!1:this.selectCells([[y,m,b,O]],P,A)},this.selectCells=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(i=!0);var O=R.selectCells(y);return O&&b&&a.listen(),i=!1,O},this.selectColumns=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return R.selectColumns(y,m)},this.selectRows=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return R.selectRows(y,m)},this.deselectCell=function(){R.deselect()},this.selectAll=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=y&&this.hasRowHeaders(),b=y&&this.hasColHeaders();i=!0,R.selectAll(m,b),i=!1};var fe=function(m,b){return m.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(y,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,P=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=!b,B=!O,V=y,G=m;if(P){var J=Number.isInteger(y),ee=Number.isInteger(m),le=J?fe(this.rowIndexMapper,y):void 0,Re=ee?fe(this.columnIndexMapper,m):void 0;if(le===null||Re===null)return!1;V=J?a.rowIndexMapper.getRenderableFromVisualIndex(le):void 0,G=ee?a.columnIndexMapper.getRenderableFromVisualIndex(Re):void 0}var ce=Number.isInteger(V),he=Number.isInteger(G);return ce&&he?a.view.scrollViewport(a._createCellCoords(V,G),A,O,b,B):ce&&he===!1?a.view.scrollViewportVertically(V,A,b):he&&ce===!1?a.view.scrollViewportHorizontally(G,O,B):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),p.clearCache(),WC(a)){var y=this.rootDocument.querySelector(".hot-display-license-info");y&&y.parentNode.removeChild(y)}Io(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(m){var b=gn(m,2),O=b[1];O.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),me.getSingleton().destroy(a),Ye(a,function(m,b,O){wt(m)?O[b]=Oe(b):b!=="guid"&&(O[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),a.rowIndexMapper=null,a.columnIndexMapper=null,s=null,f=null,R=null,c=null,a=null};function Oe(y){return function(){throw new Error('The "'.concat(y,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(y){var m=Po(y);return m==="UndoRedo"?this.undoRedo:S.getItem(m)},this.getPluginName=function(y){return y===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(y)},this.getInstance=function(){return a},this.addHook=function(y,m){me.getSingleton().add(y,m,a)},this.hasHook=function(y){return me.getSingleton().has(y,a)||me.getSingleton().has(y)},this.addHookOnce=function(y,m){me.getSingleton().once(y,m,a)},this.removeHook=function(y,m){me.getSingleton().remove(y,m,a)},this.runHooks=function(y,m,b,O,P,A,B){return me.getSingleton().run(a,y,m,b,O,P,A,B)},this.getTranslatedPhrase=function(y,m){return hW(g.language,y,m)},this.toHTML=function(){return x1(n)},this.toTableElement=function(){var y=n.rootDocument.createElement("div");return y.insertAdjacentHTML("afterbegin",x1(n)),y.firstElementChild},this.timeouts=[],this._registerTimeout=function(y){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=y;typeof b=="function"&&(b=setTimeout(b,m)),this.timeouts.push(b)},this._clearTimeouts=function(){I(this.timeouts,function(y){clearTimeout(y)})},this.immediates=[],this._registerImmediate=function(y){this.immediates.push(setImmediate(y))},this._clearImmediates=function(){I(this.immediates,function(y){clearImmediate(y)})},this._refreshBorders=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(y),a.view.render(),m&&R.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var be=PSe({handleEvent:function(m){var b=a.isListening(),O=(m==null?void 0:m.key)!==void 0;return b&&O},beforeKeyDown:function(m){return n.runHooks("beforeKeyDown",m)},afterKeyDown:function(m){n.isDestroyed||a.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(y){y.ctrlKey===!1&&y.metaKey===!1&&be.releasePressedKeys()}),this.getShortcutManager=function(){return be};var Ce=be.addContext("grid"),k={runOnlyIf:function(){return pe(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:xSe};be.setActiveContextName("grid"),Ce.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var m=a.getSelectedRange(),b=m[m.length-1].highlight,O=b.row,P=b.col,A=a.getDataAtCell(O,P),B=new Map,V=0;V<m.length;V++)m[V].forAll(function(G,J){if(G>=0&&J>=0&&(G!==O||J!==P)){var ee=a.getCellMeta(G,J),le=ee.readOnly;le||B.set("".concat(G,"x").concat(J),[G,J,A])}});a.setDataAtCell(Array.from(B.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){R.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){R.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,O=m.to,P=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(P,O.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){R.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){R.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,O=m.to,P=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);R.setRangeStart(b.clone()),R.setRangeEnd(a._createCellCoords(P,O.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){R.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,O=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,Uo(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(a._createCellCoords(b,O))}},{keys:[["ArrowLeft","Shift"]],callback:function(){R.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),O=b.from,P=b.to,A=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,Uo(a.isRtl()?[a.countCols()-1,-1]:[0,1]));R.setRangeStart(O.clone()),R.setRangeEnd(a._createCellCoords(P.row,A))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){R.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,O=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,Uo(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(a._createCellCoords(b,O))}},{keys:[["ArrowRight","Shift"]],callback:function(){R.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),O=b.from,P=b.to,A=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,Uo(a.isRtl()?[0,1]:[a.countCols()-1,-1]));R.setRangeStart(O.clone()),R.setRangeEnd(a._createCellCoords(P.row,A))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,O=a.columnIndexMapper.getNearestNotHiddenIndex(m,1);R.setRangeStart(a._createCellCoords(b,O))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),O=a.rowIndexMapper.getNearestNotHiddenIndex(m,1),P=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);R.setRangeStart(a._createCellCoords(O,P))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){R.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){R.setRangeEnd(a._createCellCoords(R.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-m-1,-1),O=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);R.setRangeStart(a._createCellCoords(b,O))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){R.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,O=Math.max(b.row-a.countVisibleRows(),0),P=a.rowIndexMapper.getNearestNotHiddenIndex(O,1);if(P!==null){var A=a._createCellCoords(P,b.col),B=b.row-a.view.getFirstFullyVisibleRow(),V=Math.max(A.row-B,0);R.setRangeEnd(A),a.scrollViewportTo(V)}}},{keys:[["PageDown"]],callback:function(){R.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,O=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),P=a.rowIndexMapper.getNearestNotHiddenIndex(O,-1);if(P!==null){var A=a._createCellCoords(P,b.col),B=b.row-a.view.getFirstFullyVisibleRow(),V=Math.min(A.row-B,a.countRows()-1);R.setRangeEnd(A),a.scrollViewportTo(V)}}},{keys:[["Tab"]],callback:function(m){var b=typeof g.tabMoves=="function"?g.tabMoves(m):g.tabMoves;R.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(m){var b=typeof g.tabMoves=="function"?g.tabMoves(m):g.tabMoves;R.transformStart(-b.row,-b.col)}}],k),JF().forEach(function(y){var m=NE(y);S.addItem(y,new m(n))}),me.getSingleton().run(a,"construct")}var DSe="hooksRefRegisterer",AW={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;I(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;Ye(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};No(AW,"MIXIN_NAME",DSe,{writable:!1,enumerable:!1});const NSe=AW;function Ps(e){return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function HSe(e,t){return FSe(e)||BSe(e,t)||jSe(e,t)||LSe()}function LSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jSe(e,t){if(e){if(typeof e=="string")return pM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pM(e,t)}}function pM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function FSe(e){if(Array.isArray(e))return e}function VSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v_(e,t)}function v_(e,t){return v_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},v_(e,t)}function WSe(e){var t=GSe();return function(){var n=tm(e),o;if(t){var i=tm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return USe(this,o)}}function USe(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zSe(e)}function zSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tm(e){return tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tm(e)}function mM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YSe(n.key),n)}}function bM(e,t,r){return t&&gM(e.prototype,t),r&&gM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YSe(e){var t=KSe(e,"string");return Ps(t)==="symbol"?t:String(t)}function KSe(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qSe="base",rr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),y_="baseEditor",mg=function(){function e(t){mM(this,e),this.hot=t,this.instance=t,this.state=rr.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return bM(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=rr.VIRGIN}},{key:"extend",value:function(){return function(r){VSe(o,r);var n=WSe(o);function o(){return mM(this,o),n.apply(this,arguments)}return bM(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=HSe(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),p={runOnlyIf:function(){return pe(o.hot.getSelected())},group:y_};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],p),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===rr.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=rr.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:jt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(y_),u.removeShortcutsByGroup(ig),this.state===rr.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===rr.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=rr.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=rr.FINISHED,i.discardEditor(c)}):(this.state=rr.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=rr.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===rr.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=rr.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=rr.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===rr.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Ut(n),u=vt(n),f=Ut(this.hot.rootElement),c=vt(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,p=d!==l?d.scrollLeft:0,g=l.innerWidth-f.left-c,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=w.wtTable,_=S.name,T=["master","inline_start"].includes(_)?v:0,R=["master","top","bottom"].includes(_)?p:0,W=s.top===f.top?0:1,z=s.top-f.top-W-T,X=0;this.hot.isRtl()?X=l.innerWidth-s.left-u-g-1+R:X=s.left-f.left-1-R,["top","top_inline_start_corner"].includes(_)&&(z+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(_)&&(X+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var K=this.hot.hasColHeaders(),q=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ae=this.hot.rowIndexMapper.getRenderableIndexesLength(),Z=ae-this.hot.view._wt.getSetting("fixedRowsBottom");(K&&q<=0||q===Z)&&(z+=1),Q<=0&&(X+=1);var fe=a.rowsRenderCalculator.startPosition,Oe=a.columnsRenderCalculator.startPosition,be=Math.abs(i.inlineStartOverlay.getScrollPosition()),Ce=i.topOverlay.getScrollPosition(),k=Jt(this.hot.rootDocument),y=n.offsetTop+fe-Ce,m=0;if(this.hot.isRtl()){var b=n.offsetLeft;b>=0?m=S.getWidth()-n.offsetLeft:m=Math.abs(b),m+=Oe-be-u}else m=n.offsetLeft+Oe-be;var O=Ea(this.TD,this.hot.rootWindow),P=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",A=parseInt(O[P],10)>0?0:1,B=parseInt(O.borderTopWidth,10)>0?0:1,V=vt(n)+A,G=kt(n)+B,J=lie(h)?k:0,ee=sie(d)?k:0,le=this.hot.view.maximumVisibleElementWidth(m)-J+A,Re=Math.max(this.hot.view.maximumVisibleElementHeight(y)-ee+B,23);return{top:z,start:X,height:G,maxHeight:Re,width:V,maxWidth:le}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return qSe}}]),e}();bt(mg,NSe);function XSe(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,p){d.addEventListener(v,p,!1)},a=function(d,v,p){d.removeEventListener(v,p,!1)},l=function(d){var v,p;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",p=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>p?t.style.height=e.minHeight+"px":e.maxHeight<p?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=p+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var p=parseInt(d.maxHeight);isNaN(p)||(e.maxHeight=p)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var g=parseInt(d.minWidth);isNaN(g)||(e.minWidth=g)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,p){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),p&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,p){f(d,v,p)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function wM(e,t){for(var r=_F(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}ng(t,o)}function Ts(e){return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function SM(e,t){return eCe(e)||JSe(e,t)||QSe(e,t)||ZSe()}function ZSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QSe(e,t){if(e){if(typeof e=="string")return CM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CM(e,t)}}function CM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function eCe(e){if(Array.isArray(e))return e}function tCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nCe(n.key),n)}}function rCe(e,t,r){return t&&_M(e.prototype,t),r&&_M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nCe(e){var t=oCe(e,"string");return Ts(t)==="symbol"?t:String(t)}function oCe(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oc(){return typeof Reflect<"u"&&Reflect.get?oc=Reflect.get.bind():oc=function(t,r,n){var o=iCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oc.apply(this,arguments)}function iCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ma(e),e!==null););return e}function aCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p_(e,t)}function p_(e,t){return p_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},p_(e,t)}function lCe(e){var t=uCe();return function(){var n=Ma(e),o;if(t){var i=Ma(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sCe(this,o)}}function sCe(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IW(e)}function IW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ma(e){return Ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ma(e)}var fCe="ht_editor_visible",Wv="ht_editor_hidden",OM="textEditor",cCe="text",ff=function(e){aCe(r,e);var t=lCe(r);function r(n){var o;return tCe(this,r),o=t.call(this,n),o.eventManager=new At(IW(o)),o.autoResize=XSe(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return rCe(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if(oc(Ma(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==rr.FINISHED&&this.hideEditableElement();var d=!h;d&&!$n()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===rr.VIRGIN&&(this.TEXTAREA.value="",oc(Ma(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),ng(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,re(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),re(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ne(this.TEXTAREA_PARENT,this.layerClass)&&He(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,Wv),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(qJ()||KJ())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",He(this.TEXTAREA_PARENT,this.layerClass),re(this.TEXTAREA_PARENT,Wv)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;Se(o.length-1,function(a){var l=o[a];if(Ne(l,"handsontableEditor"))return i=!0,!1}),Ne(this.TEXTAREA_PARENT,Wv)&&He(this.TEXTAREA_PARENT,Wv),i?(this.layerClass=fCe,re(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),re(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==rr.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Ea(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ea(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),p=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),g=s-v,w=f-p,S=u-v,_=c-p;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,S),minHeight:Math.min(w,_),maxWidth:S,maxHeight:_},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),CB()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return pe(o.hot.getSelected())},group:OM},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:ec,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:ec,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:ec,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=SM(c,1),d=h[0];wM(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=SM(c,1),d=h[0];wM(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(ig),i.removeShortcutsByGroup(OM),i.removeShortcutsByGroup(y_)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[we.ARROW_UP,we.ARROW_RIGHT,we.ARROW_DOWN,we.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return cCe}}]),r}(mg),hCe="base";function nv(e,t,r,n,o,i,a){var l=[],s=[];a.className&&re(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),He(t,s),re(t,l)}nv.RENDERER_TYPE=hCe;var dCe="text";function _i(e,t,r,n,o,i,a){nv.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=jt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Io(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else Ra(t,l)}_i.RENDERER_TYPE=dCe;var vCe="text",MW={CELL_TYPE:vCe,editor:ff,renderer:_i};Rn(MW);Xe.editors={BaseEditor:mg};function Xe(e,t){var r=new RP(e,t||{},qE);return r.init(),r}Xe.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new RP(e,t,qE)};Xe.DefaultSettings=OW();Xe.hooks=me.getSingleton();Xe.CellCoords=_p;Xe.CellRange=LE;Xe.packageName="handsontable";Xe.buildDate="06/02/2023 12:34:58";Xe.version="12.3.1";Xe.languages={dictionaryKeys:Dme,getLanguageDictionary:cW,getLanguagesDictionaries:Wme,registerLanguageDictionary:fW,getTranslatedPhrase:hW};function RM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RM(Object(r),!0).forEach(function(n){pCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ph(e){return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}function ks(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xW(n.key),n)}}function $s(e,t,r){return t&&EM(e.prototype,t),r&&EM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pCe(e,t,r){return t=xW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Th(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m_(e,t)}function rm(e){return rm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rm(e)}function m_(e,t){return m_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},m_(e,t)}function mCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kh(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gCe(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kh(e)}function $h(e){var t=mCe();return function(){var n=rm(e),o;if(t){var i=rm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gCe(this,o)}}function bCe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xW(e){var t=bCe(e,"string");return typeof t=="symbol"?t:String(t)}var gw=null,wCe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",SCe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",nm="global",DW="hot-wrapper-editor-container";function CCe(){if(typeof console<"u"){var e;(e=console).warn.apply(e,arguments)}}function g_(e,t){var r=Yt.Children.toArray(e),n=Yt.Children.count(e),o=null;return n!==0&&(n===1&&r[0].props[t]?o=r[0]:o=r.find(function(i){return i.props[t]!==void 0})),o||null}function NW(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function bw(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;e.querySelectorAll('[class^="'.concat(DW,'"]')).forEach(function(t){t.parentNode&&t.parentNode.removeChild(t)})}function HW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;if(t!==null){var r=e.createElement("DIV"),n=LW(t.props,!1),o=n.id,i=n.className,a=n.style;return o&&(r.id=o),r.className=[DW,i].join(" "),a&&Object.assign(r.style,a),e.body.appendChild(r),iL.createPortal(t,r)}}function b_(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:nm,n=g_(e,"hot-editor"),o=NW(n);return n?Yt.cloneElement(n,{emitEditorInstance:function(a,l){t.get(o)||t.set(o,new Map);var s=t.get(o);s.set(l??nm,a)},editorColumnScope:r,isEditor:!0}):null}function _Ce(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:document;n||(n=document),gw||(gw=n.createDocumentFragment());var o=n.createElement("DIV");gw.appendChild(o);var i=Yt.cloneElement(e,yCe({key:"".concat(t.row,"-").concat(t.col)},t));return{portal:iL.createPortal(i,o,"".concat(t.row,"-").concat(t.col,"-").concat(Math.random())),portalContainer:o}}function LW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}function jW(e){var t=Yt.version.split(".").map(function(n){return parseInt(n)}),r=t[0]>=16&&t[1]>=3||t[0]>=17;r&&(e.UNSAFE_componentWillUpdate=e.componentWillUpdate,e.componentWillUpdate=void 0,e.UNSAFE_componentWillMount=e.componentWillMount,e.componentWillMount=void 0)}var BW=function(){function e(){ks(this,e)}return $s(e,null,[{key:"getSettings",value:function(r){var n={};if(r.settings){var o=r.settings;for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])}for(var a in r)a!=="settings"&&a!=="children"&&r.hasOwnProperty(a)&&(n[a]=r[a]);return n}}]),e}(),OCe=function(e){Th(r,e);var t=$h(r);function r(n,o){var i;return ks(this,r),i=t.call(this,n,o),i.localEditorPortal=null,jW(kh(i)),i}return $s(r,[{key:"getLocalEditorPortal",value:function(){return this.localEditorPortal}},{key:"setLocalEditorPortal",value:function(o){this.localEditorPortal=o}},{key:"getSettingsProps",value:function(){var o=this;return this.internalProps=["__componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!o.internalProps.includes(i)}).reduce(function(i,a){return i[a]=o.props[a],i},{})}},{key:"getLocalEditorElement",value:function(){return b_(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var o=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=BW.getSettings(this.getSettingsProps()),o!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(o),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"createLocalEditorPortal",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.children,i=this.props._getEditorCache(),a=b_(o,i,this.props._columnIndex);a&&this.setLocalEditorPortal(HW(this.props._getOwnerDocument(),a,i))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentWillMount",value:function(){this.createLocalEditorPortal()}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentWillUpdate",value:function(o,i,a){this.createLocalEditorPortal(o.children)}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){return Yt.createElement(Yt.Fragment,null,this.getLocalEditorPortal())}}]),r}(Yt.Component),RCe=function(e){Th(r,e);var t=$h(r);function r(n){var o;return ks(this,r),o=t.call(this,n),o.state={portals:[]},o}return $s(r,[{key:"render",value:function(){return Yt.createElement(Yt.Fragment,null,this.state.portals)}}]),r}(Yt.Component),ECe="12.3.1";function EP(e,t){return t={exports:{}},e(t,t.exports),t.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var er=typeof Symbol=="function"&&Symbol.for,PP=er?Symbol.for("react.element"):60103,TP=er?Symbol.for("react.portal"):60106,gg=er?Symbol.for("react.fragment"):60107,bg=er?Symbol.for("react.strict_mode"):60108,wg=er?Symbol.for("react.profiler"):60114,Sg=er?Symbol.for("react.provider"):60109,Cg=er?Symbol.for("react.context"):60110,kP=er?Symbol.for("react.async_mode"):60111,_g=er?Symbol.for("react.concurrent_mode"):60111,Og=er?Symbol.for("react.forward_ref"):60112,Rg=er?Symbol.for("react.suspense"):60113,PCe=er?Symbol.for("react.suspense_list"):60120,Eg=er?Symbol.for("react.memo"):60115,Pg=er?Symbol.for("react.lazy"):60116,TCe=er?Symbol.for("react.block"):60121,kCe=er?Symbol.for("react.fundamental"):60117,$Ce=er?Symbol.for("react.responder"):60118,ACe=er?Symbol.for("react.scope"):60119;function Lr(e){if(Ph(e)==="object"&&e!==null){var t=e.$$typeof;switch(t){case PP:switch(e=e.type,e){case kP:case _g:case gg:case wg:case bg:case Rg:return e;default:switch(e=e&&e.$$typeof,e){case Cg:case Og:case Pg:case Eg:case Sg:return e;default:return t}}case TP:return t}}}function FW(e){return Lr(e)===_g}var ICe=kP,MCe=_g,xCe=Cg,DCe=Sg,NCe=PP,HCe=Og,LCe=gg,jCe=Pg,BCe=Eg,FCe=TP,VCe=wg,WCe=bg,UCe=Rg,zCe=function(t){return FW(t)||Lr(t)===kP},GCe=FW,YCe=function(t){return Lr(t)===Cg},KCe=function(t){return Lr(t)===Sg},qCe=function(t){return Ph(t)==="object"&&t!==null&&t.$$typeof===PP},XCe=function(t){return Lr(t)===Og},ZCe=function(t){return Lr(t)===gg},QCe=function(t){return Lr(t)===Pg},JCe=function(t){return Lr(t)===Eg},e_e=function(t){return Lr(t)===TP},t_e=function(t){return Lr(t)===wg},r_e=function(t){return Lr(t)===bg},n_e=function(t){return Lr(t)===Rg},o_e=function(t){return typeof t=="string"||typeof t=="function"||t===gg||t===_g||t===wg||t===bg||t===Rg||t===PCe||Ph(t)==="object"&&t!==null&&(t.$$typeof===Pg||t.$$typeof===Eg||t.$$typeof===Sg||t.$$typeof===Cg||t.$$typeof===Og||t.$$typeof===kCe||t.$$typeof===$Ce||t.$$typeof===ACe||t.$$typeof===TCe)},i_e=Lr,a_e={AsyncMode:ICe,ConcurrentMode:MCe,ContextConsumer:xCe,ContextProvider:DCe,Element:NCe,ForwardRef:HCe,Fragment:LCe,Lazy:jCe,Memo:BCe,Portal:FCe,Profiler:VCe,StrictMode:WCe,Suspense:UCe,isAsyncMode:zCe,isConcurrentMode:GCe,isContextConsumer:YCe,isContextProvider:KCe,isElement:qCe,isForwardRef:XCe,isFragment:ZCe,isLazy:QCe,isMemo:JCe,isPortal:e_e,isProfiler:t_e,isStrictMode:r_e,isSuspense:n_e,isValidElementType:o_e,typeOf:i_e},pt=EP(function(e,t){});pt.AsyncMode;pt.ConcurrentMode;pt.ContextConsumer;pt.ContextProvider;pt.Element;pt.ForwardRef;pt.Fragment;pt.Lazy;pt.Memo;pt.Portal;pt.Profiler;pt.StrictMode;pt.Suspense;pt.isAsyncMode;pt.isConcurrentMode;pt.isContextConsumer;pt.isContextProvider;pt.isElement;pt.isForwardRef;pt.isFragment;pt.isLazy;pt.isMemo;pt.isPortal;pt.isProfiler;pt.isStrictMode;pt.isSuspense;pt.isValidElementType;pt.typeOf;EP(function(e){e.exports=a_e});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var PM=Object.getOwnPropertySymbols,l_e=Object.prototype.hasOwnProperty,s_e=Object.prototype.propertyIsEnumerable;function u_e(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function f_e(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(i){return t[i]});if(n.join("")!=="0123456789")return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(i){o[i]=i}),Object.keys(Object.assign({},o)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}f_e();var c_e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",h_e=c_e;Function.call.bind(Object.prototype.hasOwnProperty);function VW(){}function WW(){}WW.resetWarningCache=VW;var d_e=function(){function t(o,i,a,l,s,u){if(u!==h_e){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}t.isRequired=t;function r(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:WW,resetWarningCache:VW};return n.PropTypes=n,n},v_e=EP(function(e){e.exports=d_e()}),ww=v_e,UW=function(e){Th(r,e);var t=$h(r);function r(n,o){var i;return ks(this,r),i=t.call(this,n,o),i.id=null,i.__hotInstance=null,i.hotElementRef=null,i.columnSettings=[],i.portalManager=null,i.portalCacheArray=[],i.globalEditorPortal=null,i.renderedCellCache=new Map,i.editorCache=new Map,i.componentRendererColumns=new Map,jW(kh(i)),i}return $s(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(SCe),null)},set:function(o){this.__hotInstance=o}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"getGlobalEditorPortal",value:function(){return this.globalEditorPortal}},{key:"setGlobalEditorPortal",value:function(o){this.globalEditorPortal=o}},{key:"clearCache",value:function(){var o=this.getRenderedCellCache();this.setGlobalEditorPortal(null),bw(this.getOwnerDocument()),this.getEditorCache().clear(),o.clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(o){this.hotElementRef=o}},{key:"getRendererWrapper",value:function(o){var i=this;return function(a,l,s,u,f,c,h){var d=i.getRenderedCellCache();if(d.has("".concat(s,"-").concat(u))&&(l.innerHTML=d.get("".concat(s,"-").concat(u)).innerHTML),l&&!l.getAttribute("ghost-table")){for(var v=_Ce(o,{TD:l,row:s,col:u,prop:f,value:c,cellProperties:h,isRenderer:!0},function(){},l.ownerDocument),p=v.portal,g=v.portalContainer;l.firstChild;)l.removeChild(l.firstChild);l.appendChild(g),i.portalCacheArray.push(p)}return d.set("".concat(s,"-").concat(u),l),l}}},{key:"getEditorClass",value:function(o){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:nm,l=NW(o),s=this.getEditorCache(),u=(i=s.get(l))===null||i===void 0?void 0:i.get(a);return this.makeEditorClass(u)}},{key:"makeEditorClass",value:function(o){var i=function(a){Th(s,a);var l=$h(s);function s(u){var f;return ks(this,s),f=l.call(this,u),o.hotCustomEditorInstance=kh(f),f.editorComponent=o,f}return $s(s,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),s}(Xe.editors.BaseEditor);return Object.getOwnPropertyNames(Xe.editors.BaseEditor.prototype).forEach(function(a){a!=="constructor"&&(i.prototype[a]=function(){for(var l,s=arguments.length,u=new Array(s),f=0;f<s;f++)u[f]=arguments[f];return(l=o[a]).call.apply(l,[o].concat(u))})}),i}},{key:"getGlobalRendererElement",value:function(){var o=this.props.children;return g_(o,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.children;return b_(o,this.getEditorCache())}},{key:"createGlobalEditorPortal",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.children,i=this.getGlobalEditorElement(o);i&&this.setGlobalEditorPortal(HW(this.getOwnerDocument(),i,this.getEditorCache()))}},{key:"createNewGlobalSettings",value:function(){var o=BW.getSettings(this.props),i=this.getGlobalRendererElement(),a=this.getGlobalEditorElement();return o.columns=this.columnSettings.length?this.columnSettings:o.columns,a?o.editor=this.getEditorClass(a,nm):o.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),i?(o.renderer=this.getRendererWrapper(i),this.componentRendererColumns.set("global",!0)):o.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),o}},{key:"displayAutoSizeWarning",value:function(o){var i,a;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(a=this.hotInstance.getPlugin("autoColumnSize"))!==null&&a!==void 0&&a.enabled)&&this.componentRendererColumns.size>0&&CCe(wCe)}},{key:"setHotColumnSettings",value:function(o,i){this.columnSettings[i]=o}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var o=this;this.portalManager.setState(function(){return Object.assign({},{portals:o.portalCacheArray})},function(){o.portalCacheArray.length=0})}},{key:"updateHot",value:function(o){this.hotInstance&&this.hotInstance.updateSettings(o,!1)}},{key:"setPortalManagerRef",value:function(o){this.portalManager=o}},{key:"componentWillMount",value:function(){this.clearCache(),this.createGlobalEditorPortal()}},{key:"componentDidMount",value:function(){var o=this,i=this.createNewGlobalSettings();this.hotInstance=new Xe.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(a){o.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){o.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentWillUpdate",value:function(o,i,a){this.clearCache(),bw(this.getOwnerDocument()),this.createGlobalEditorPortal(o.children)}},{key:"componentDidUpdate",value:function(){var o=this.createNewGlobalSettings();this.updateHot(o),this.displayAutoSizeWarning(o)}},{key:"componentWillUnmount",value:function(){this.hotInstance&&this.hotInstance.destroy(),bw(this.getOwnerDocument())}},{key:"render",value:function(){var o=this,i=LW(this.props),a=i.id,l=i.className,s=i.style,u=function(d){return d.type===OCe},f=Yt.Children.toArray(this.props.children);f=f.filter(function(h){return u(h)});var c=f.map(function(h,d){return Yt.cloneElement(h,{_componentRendererColumns:o.componentRendererColumns,_emitColumnSettings:o.setHotColumnSettings.bind(o),_columnIndex:d,_getChildElementByType:g_.bind(o),_getRendererWrapper:o.getRendererWrapper.bind(o),_getEditorClass:o.getEditorClass.bind(o),_getOwnerDocument:o.getOwnerDocument.bind(o),_getEditorCache:o.getEditorCache.bind(o),children:h.props.children})});return c.push(this.getGlobalEditorPortal()),Yt.createElement(Yt.Fragment,null,Yt.createElement("div",{ref:this.setHotElementRef.bind(this),id:a,className:l,style:s},c),Yt.createElement(RCe,{ref:this.setPortalManagerRef.bind(this)}))}}],[{key:"version",get:function(){return ECe}}]),r}(Yt.Component);UW.propTypes={style:ww.object,id:ww.string,className:ww.string};Yt.Component;function As(e){return As=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},As(e)}function y_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m_e(n.key),n)}}function p_e(e,t,r){return t&&TM(e.prototype,t),r&&TM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m_e(e){var t=g_e(e,"string");return As(t)==="symbol"?t:String(t)}function g_e(e,t){if(As(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(As(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function on(){return typeof Reflect<"u"&&Reflect.get?on=Reflect.get.bind():on=function(t,r,n){var o=b_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},on.apply(this,arguments)}function b_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mr(e),e!==null););return e}function w_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w_(e,t)}function w_(e,t){return w_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},w_(e,t)}function S_e(e){var t=O_e();return function(){var n=Mr(e),o;if(t){var i=Mr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return C_e(this,o)}}function C_e(e,t){if(t&&(As(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return __e(e)}function __e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mr(e){return Mr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mr(e)}var kM="handsontableEditor",R_e="handsontable",zW=function(e){w_e(r,e);var t=S_e(r);function r(){return y_e(this,r),t.apply(this,arguments)}return p_e(r,[{key:"open",value:function(){on(Mr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),ng(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),on(Mr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){on(Mr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var p=this.getSourceData(v.row,v.col);p!==void 0&&f.setValue(p),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&zt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||on(Mr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){on(Mr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}on(Mr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");on(Mr(r.prototype),"registerShortcuts",this).call(this);var l={group:kM,relativeToGroup:ig,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),Mn(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){on(Mr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(kM)}}],[{key:"EDITOR_TYPE",get:function(){return R_e}}]),r}(ff);function Is(e){return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(e)}function E_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GW(n.key),n)}}function P_e(e,t,r){return t&&$M(e.prototype,t),r&&$M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gi(){return typeof Reflect<"u"&&Reflect.get?Gi=Reflect.get.bind():Gi=function(t,r,n){var o=T_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Gi.apply(this,arguments)}function T_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=to(e),e!==null););return e}function k_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S_(e,t)}function S_(e,t){return S_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},S_(e,t)}function $_e(e){var t=I_e();return function(){var n=to(e),o;if(t){var i=to(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return A_e(this,o)}}function A_e(e,t){if(t&&(Is(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C_(e)}function C_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function to(e){return to=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},to(e)}function M_e(e,t,r){return t=GW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GW(e){var t=x_e(e,"string");return Is(t)==="symbol"?t:String(t)}function x_e(e,t){if(Is(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Is(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sw=new WeakMap,D_e="autocomplete",YW=function(e){k_e(r,e);var t=$_e(r);function r(n){var o;return E_e(this,r),o=t.call(this,n),M_e(C_(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,p;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=f1(jt(a[v])),l)p=d.indexOf(i);else{var g=this.cellProperties.locale;p=d.toLocaleLowerCase(g).indexOf(i.toLocaleLowerCase(g))}p!==-1&&(h=d.length-p-f,s.push({baseIndex:v,index:p,charsLeft:h,value:d}))}for(s.sort(function(w,S){if(S.index===-1)return-1;if(w.index===-1)return 1;if(w.index<S.index)return-1;if(S.index<w.index)return 1;if(w.index===S.index){if(w.charsLeft<S.charsLeft)return-1;if(w.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],Sw.set(C_(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return P_e(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return pe(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){Gi(to(r.prototype),"createElements",this).call(this),re(this.htContainer,"autocompleteEditor"),re(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=Sw.get(this);Gi(to(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Jt();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[vt(this.TEXTAREA)-2]:void 0,width:l?vt(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,p,g){_i(f,c,h,d,v,p,g);var w=o.cellProperties,S=w.filteringCaseSensitive,_=w.allowHtml,T=w.locale,R=o.query,W=jt(p),z,X;W&&!_&&(z=S===!0?W.indexOf(R):W.toLocaleLowerCase(T).indexOf(R.toLocaleLowerCase(T)),z!==-1&&(X=W.substr(z,R.length),W=W.replace(X,"<strong>".concat(X,"</strong>")))),c.innerHTML=W},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Gi(to(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){Gi(to(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=_F(this.TEXTAREA),a=oie(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,p=c.length;v<p&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(Cy([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),ng(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=wc(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Ut(this.TEXTAREA),s=kt(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=kt(this.hot.view._wt.wtTable.THEAD),h=Ut(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,p=u>v&&d>v;return p?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(p?d:v,u),p}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Jt(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=We(o,function(s){return jt(s)}),l=We(a,function(s){return i?s:f1(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===we.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===we.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=Sw.get(this);if(a.skipOne=!1,xie(o.keyCode)||o.keyCode===we.BACKSPACE||o.keyCode===we.DELETE||o.keyCode===we.INSERT){var l=10;if(o.keyCode===we.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return D_e}}]),r}(zW);function Ms(e){return Ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ms(e)}function N_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L_e(n.key),n)}}function H_e(e,t,r){return t&&AM(e.prototype,t),r&&AM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function L_e(e){var t=j_e(e,"string");return Ms(t)==="symbol"?t:String(t)}function j_e(e,t){if(Ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&__(e,t)}function __(e,t){return __=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},__(e,t)}function F_e(e){var t=U_e();return function(){var n=om(e),o;if(t){var i=om(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return V_e(this,o)}}function V_e(e,t){if(t&&(Ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W_e(e)}function W_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function om(e){return om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},om(e)}var z_e="checkbox",G_e=function(e){B_e(r,e);var t=F_e(r);function r(){return N_e(this,r),t.apply(this,arguments)}return H_e(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');Ne(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return z_e}}]),r}(mg),O_={},Y_e={get exports(){return O_},set exports(e){O_=e}};const K_e=dz(Uoe);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=K_e}catch{}e.exports=n(o)}})(vS,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function(k,y,m,b){o?k.addEventListener(y,m,!!b):k.attachEvent("on"+y,m)},s=function(k,y,m,b){o?k.removeEventListener(y,m,!!b):k.detachEvent("on"+y,m)},u=function(k){return k.trim?k.trim():k.replace(/^\s+|\s+$/g,"")},f=function(k,y){return(" "+k.className+" ").indexOf(" "+y+" ")!==-1},c=function(k,y){f(k,y)||(k.className=k.className===""?y:k.className+" "+y)},h=function(k,y){k.className=u((" "+k.className+" ").replace(" "+y+" "," "))},d=function(k){return/Array/.test(Object.prototype.toString.call(k))},v=function(k){return/Date/.test(Object.prototype.toString.call(k))&&!isNaN(k.getTime())},p=function(k){var y=k.getDay();return y===0||y===6},g=function(k){return k%4===0&&k%100!==0||k%400===0},w=function(k,y){return[31,g(k)?29:28,31,30,31,30,31,31,30,31,30,31][y]},S=function(k){v(k)&&k.setHours(0,0,0,0)},_=function(k,y){return k.getTime()===y.getTime()},T=function(k,y,m){var b,O;for(b in y)O=k[b]!==void 0,O&&typeof y[b]=="object"&&y[b]!==null&&y[b].nodeName===void 0?v(y[b])?m&&(k[b]=new Date(y[b].getTime())):d(y[b])?m&&(k[b]=y[b].slice(0)):k[b]=T({},y[b],m):(m||!O)&&(k[b]=y[b]);return k},R=function(k,y,m){var b;i.createEvent?(b=i.createEvent("HTMLEvents"),b.initEvent(y,!0,!1),b=T(b,m),k.dispatchEvent(b)):i.createEventObject&&(b=i.createEventObject(),b=T(b,m),k.fireEvent("on"+y,b))},W=function(k){return k.month<0&&(k.year-=Math.ceil(Math.abs(k.month)/12),k.month+=12),k.month>11&&(k.year+=Math.floor(Math.abs(k.month)/12),k.month-=12),k},z={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},X=function(k,y,m){for(y+=k.firstDay;y>=7;)y-=7;return m?k.i18n.weekdaysShort[y]:k.i18n.weekdays[y]},K=function(k){var y=[],m="false";if(k.isEmpty)if(k.showDaysInNextAndPreviousMonths)y.push("is-outside-current-month"),k.enableSelectionDaysInNextAndPreviousMonths||y.push("is-selection-disabled");else return'<td class="is-empty"></td>';return k.isDisabled&&y.push("is-disabled"),k.isToday&&y.push("is-today"),k.isSelected&&(y.push("is-selected"),m="true"),k.hasEvent&&y.push("has-event"),k.isInRange&&y.push("is-inrange"),k.isStartRange&&y.push("is-startrange"),k.isEndRange&&y.push("is-endrange"),'<td data-day="'+k.day+'" class="'+y.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+k.year+'" data-pika-month="'+k.month+'" data-pika-day="'+k.day+'">'+k.day+"</button></td>"},q=function(k,y){k.setHours(0,0,0,0);var m=k.getDate(),b=k.getDay(),O=y,P=O-1,A=7,B=function(le){return(le+A-1)%A};k.setDate(m+P-B(b));var V=new Date(k.getFullYear(),0,O),G=24*60*60*1e3,J=(k.getTime()-V.getTime())/G,ee=1+Math.round((J-P+B(V.getDay()))/A);return ee},Q=function(k,y,m,b){var O=new Date(m,y,k),P=n?r(O).isoWeek():q(O,b);return'<td class="pika-week">'+P+"</td>"},ae=function(k,y,m,b){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(b?" is-selected":"")+'">'+(y?k.reverse():k).join("")+"</tr>"},Z=function(k){return"<tbody>"+k.join("")+"</tbody>"},fe=function(k){var y,m=[];for(k.showWeekNumber&&m.push("<th></th>"),y=0;y<7;y++)m.push('<th scope="col"><abbr title="'+X(k,y)+'">'+X(k,y,!0)+"</abbr></th>");return"<thead><tr>"+(k.isRTL?m.reverse():m).join("")+"</tr></thead>"},Oe=function(k,y,m,b,O,P){var A,B,V,G=k._o,J=m===G.minYear,ee=m===G.maxYear,le='<div id="'+P+'" class="pika-title" role="heading" aria-live="assertive">',Re,ce,he=!0,Y=!0;for(V=[],A=0;A<12;A++)V.push('<option value="'+(m===O?A-y:12+A-y)+'"'+(A===b?' selected="selected"':"")+(J&&A<G.minMonth||ee&&A>G.maxMonth?' disabled="disabled"':"")+">"+G.i18n.months[A]+"</option>");for(Re='<div class="pika-label">'+G.i18n.months[b]+'<select class="pika-select pika-select-month" tabindex="-1">'+V.join("")+"</select></div>",d(G.yearRange)?(A=G.yearRange[0],B=G.yearRange[1]+1):(A=m-G.yearRange,B=1+m+G.yearRange),V=[];A<B&&A<=G.maxYear;A++)A>=G.minYear&&V.push('<option value="'+A+'"'+(A===m?' selected="selected"':"")+">"+A+"</option>");return ce='<div class="pika-label">'+m+G.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+V.join("")+"</select></div>",G.showMonthAfterYear?le+=ce+Re:le+=Re+ce,J&&(b===0||G.minMonth>=b)&&(he=!1),ee&&(b===11||G.maxMonth<=b)&&(Y=!1),y===0&&(le+='<button class="pika-prev'+(he?"":" is-disabled")+'" type="button">'+G.i18n.previousMonth+"</button>"),y===k._o.numberOfMonths-1&&(le+='<button class="pika-next'+(Y?"":" is-disabled")+'" type="button">'+G.i18n.nextMonth+"</button>"),le+="</div>"},be=function(k,y,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+fe(k)+Z(y)+"</table>"},Ce=function(k){var y=this,m=y.config(k);y._onMouseDown=function(O){if(y._v){O=O||window.event;var P=O.target||O.srcElement;if(P)if(f(P,"is-disabled")||(f(P,"pika-button")&&!f(P,"is-empty")&&!f(P.parentNode,"is-disabled")?(y.setDate(new Date(P.getAttribute("data-pika-year"),P.getAttribute("data-pika-month"),P.getAttribute("data-pika-day"))),m.bound&&a(function(){y.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):f(P,"pika-prev")?y.prevMonth():f(P,"pika-next")&&y.nextMonth()),f(P,"pika-select"))y._c=!0;else if(O.preventDefault)O.preventDefault();else return O.returnValue=!1,!1}},y._onChange=function(O){O=O||window.event;var P=O.target||O.srcElement;P&&(f(P,"pika-select-month")?y.gotoMonth(P.value):f(P,"pika-select-year")&&y.gotoYear(P.value))},y._onKeyChange=function(O){if(O=O||window.event,y.isVisible())switch(O.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:y.adjustDate("subtract",1);break;case 38:y.adjustDate("subtract",7);break;case 39:y.adjustDate("add",1);break;case 40:y.adjustDate("add",7);break;case 8:case 46:y.setDate(null);break}},y._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(n){var O=r(m.field.value,m.format,m.formatStrict);return O&&O.isValid()?O.toDate():null}else return new Date(Date.parse(m.field.value))},y._onInputChange=function(O){var P;O.firedBy!==y&&(P=y._parseFieldValue(),v(P)&&y.setDate(P),y._v||y.show())},y._onInputFocus=function(){y.show()},y._onInputClick=function(){y.show()},y._onInputBlur=function(){var O=i.activeElement;do if(f(O,"pika-single"))return;while(O=O.parentNode);y._c||(y._b=a(function(){y.hide()},50)),y._c=!1},y._onClick=function(O){O=O||window.event;var P=O.target||O.srcElement,A=P;if(P){!o&&f(P,"pika-select")&&(P.onchange||(P.setAttribute("onchange","return;"),l(P,"change",y._onChange)));do if(f(A,"pika-single")||A===m.trigger)return;while(A=A.parentNode);y._v&&P!==m.trigger&&A!==m.trigger&&y.hide()}},y.el=i.createElement("div"),y.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),l(y.el,"mousedown",y._onMouseDown,!0),l(y.el,"touchend",y._onMouseDown,!0),l(y.el,"change",y._onChange),m.keyboardInput&&l(i,"keydown",y._onKeyChange),m.field&&(m.container?m.container.appendChild(y.el):m.bound?i.body.appendChild(y.el):m.field.parentNode.insertBefore(y.el,m.field.nextSibling),l(m.field,"change",y._onInputChange),m.defaultDate||(m.defaultDate=y._parseFieldValue(),m.setDefaultDate=!0));var b=m.defaultDate;v(b)?m.setDefaultDate?y.setDate(b,!0):y.gotoDate(b):y.gotoDate(new Date),m.bound?(this.hide(),y.el.className+=" is-bound",l(m.trigger,"click",y._onInputClick),l(m.trigger,"focus",y._onInputFocus),l(m.trigger,"blur",y._onInputBlur)):this.show()};return Ce.prototype={config:function(k){this._o||(this._o=T({},z,!0));var y=T(this._o,k,!0);y.isRTL=!!y.isRTL,y.field=y.field&&y.field.nodeName?y.field:null,y.theme=typeof y.theme=="string"&&y.theme?y.theme:null,y.bound=!!(y.bound!==void 0?y.field&&y.bound:y.field),y.trigger=y.trigger&&y.trigger.nodeName?y.trigger:y.field,y.disableWeekends=!!y.disableWeekends,y.disableDayFn=typeof y.disableDayFn=="function"?y.disableDayFn:null;var m=parseInt(y.numberOfMonths,10)||1;if(y.numberOfMonths=m>4?4:m,v(y.minDate)||(y.minDate=!1),v(y.maxDate)||(y.maxDate=!1),y.minDate&&y.maxDate&&y.maxDate<y.minDate&&(y.maxDate=y.minDate=!1),y.minDate&&this.setMinDate(y.minDate),y.maxDate&&this.setMaxDate(y.maxDate),d(y.yearRange)){var b=new Date().getFullYear()-10;y.yearRange[0]=parseInt(y.yearRange[0],10)||b,y.yearRange[1]=parseInt(y.yearRange[1],10)||b}else y.yearRange=Math.abs(parseInt(y.yearRange,10))||z.yearRange,y.yearRange>100&&(y.yearRange=100);return y},toString:function(k){return k=k||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,k):n?r(this._d).format(k):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(k,y){n&&r.isMoment(k)&&this.setDate(k.toDate(),y)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(k,y){if(!k)return this._d=null,this._o.field&&(this._o.field.value="",R(this._o.field,"change",{firedBy:this})),this.draw();if(typeof k=="string"&&(k=new Date(Date.parse(k))),!!v(k)){var m=this._o.minDate,b=this._o.maxDate;v(m)&&k<m?k=m:v(b)&&k>b&&(k=b),this._d=new Date(k.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),R(this._o.field,"change",{firedBy:this})),!y&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(k){var y=!0;if(v(k)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),b=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),O=k.getTime();b.setMonth(b.getMonth()+1),b.setDate(b.getDate()-1),y=O<m.getTime()||b.getTime()<O}y&&(this.calendars=[{month:k.getMonth(),year:k.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(k,y){var m=this.getDate()||new Date,b=parseInt(y)*24*60*60*1e3,O;k==="add"?O=new Date(m.valueOf()+b):k==="subtract"&&(O=new Date(m.valueOf()-b)),this.setDate(O)},adjustCalendars:function(){this.calendars[0]=W(this.calendars[0]);for(var k=1;k<this._o.numberOfMonths;k++)this.calendars[k]=W({month:this.calendars[0].month+k,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(k){isNaN(k)||(this.calendars[0].month=parseInt(k,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(k){isNaN(k)||(this.calendars[0].year=parseInt(k,10),this.adjustCalendars())},setMinDate:function(k){k instanceof Date?(S(k),this._o.minDate=k,this._o.minYear=k.getFullYear(),this._o.minMonth=k.getMonth()):(this._o.minDate=z.minDate,this._o.minYear=z.minYear,this._o.minMonth=z.minMonth,this._o.startRange=z.startRange),this.draw()},setMaxDate:function(k){k instanceof Date?(S(k),this._o.maxDate=k,this._o.maxYear=k.getFullYear(),this._o.maxMonth=k.getMonth()):(this._o.maxDate=z.maxDate,this._o.maxYear=z.maxYear,this._o.maxMonth=z.maxMonth,this._o.endRange=z.endRange),this.draw()},setStartRange:function(k){this._o.startRange=k},setEndRange:function(k){this._o.endRange=k},draw:function(k){if(!(!this._v&&!k)){var y=this._o,m=y.minYear,b=y.maxYear,O=y.minMonth,P=y.maxMonth,A="",B;this._y<=m&&(this._y=m,!isNaN(O)&&this._m<O&&(this._m=O)),this._y>=b&&(this._y=b,!isNaN(P)&&this._m>P&&(this._m=P));for(var V=0;V<y.numberOfMonths;V++)B="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),A+='<div class="pika-lendar">'+Oe(this,V,this.calendars[V].year,this.calendars[V].month,this.calendars[0].year,B)+this.render(this.calendars[V].year,this.calendars[V].month,B)+"</div>";this.el.innerHTML=A,y.bound&&y.field.type!=="hidden"&&a(function(){y.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),y.bound&&y.field.setAttribute("aria-label",y.ariaLabel)}},adjustPosition:function(){var k,y,m,b,O,P,A,B,V,G,J,ee;if(!this._o.container){if(this.el.style.position="absolute",k=this._o.trigger,y=k,m=this.el.offsetWidth,b=this.el.offsetHeight,O=window.innerWidth||i.documentElement.clientWidth,P=window.innerHeight||i.documentElement.clientHeight,A=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,J=!0,ee=!0,typeof k.getBoundingClientRect=="function")G=k.getBoundingClientRect(),B=G.left+window.pageXOffset,V=G.bottom+window.pageYOffset;else for(B=y.offsetLeft,V=y.offsetTop+y.offsetHeight;y=y.offsetParent;)B+=y.offsetLeft,V+=y.offsetTop;(this._o.reposition&&B+m>O||this._o.position.indexOf("right")>-1&&B-m+k.offsetWidth>0)&&(B=B-m+k.offsetWidth,J=!1),(this._o.reposition&&V+b>P+A||this._o.position.indexOf("top")>-1&&V-b-k.offsetHeight>0)&&(V=V-b-k.offsetHeight,ee=!1),this.el.style.left=B+"px",this.el.style.top=V+"px",c(this.el,J?"left-aligned":"right-aligned"),c(this.el,ee?"bottom-aligned":"top-aligned"),h(this.el,J?"right-aligned":"left-aligned"),h(this.el,ee?"top-aligned":"bottom-aligned")}},render:function(k,y,m){var b=this._o,O=new Date,P=w(k,y),A=new Date(k,y,1).getDay(),B=[],V=[];S(O),b.firstDay>0&&(A-=b.firstDay,A<0&&(A+=7));for(var G=y===0?11:y-1,J=y===11?0:y+1,ee=y===0?k-1:k,le=y===11?k+1:k,Re=w(ee,G),ce=P+A,he=ce;he>7;)he-=7;ce+=7-he;for(var Y=!1,Ie=0,ze=0;Ie<ce;Ie++){var Te=new Date(k,y,1+(Ie-A)),$e=v(this._d)?_(Te,this._d):!1,ke=_(Te,O),C=b.events.indexOf(Te.toDateString())!==-1,E=Ie<A||Ie>=P+A,$=1+(Ie-A),H=y,M=k,j=b.startRange&&_(b.startRange,Te),x=b.endRange&&_(b.endRange,Te),D=b.startRange&&b.endRange&&b.startRange<Te&&Te<b.endRange,F=b.minDate&&Te<b.minDate||b.maxDate&&Te>b.maxDate||b.disableWeekends&&p(Te)||b.disableDayFn&&b.disableDayFn(Te);E&&(Ie<A?($=Re+$,H=G,M=ee):($=$-P,H=J,M=le));var L={day:$,month:H,year:M,hasEvent:C,isSelected:$e,isToday:ke,isDisabled:F,isEmpty:E,isStartRange:j,isEndRange:x,isInRange:D,showDaysInNextAndPreviousMonths:b.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:b.enableSelectionDaysInNextAndPreviousMonths};b.pickWholeWeek&&$e&&(Y=!0),V.push(K(L)),++ze===7&&(b.showWeekNumber&&V.unshift(Q(Ie-A,y,k,b.firstWeekOfYearMinDays)),B.push(ae(V,b.isRTL,b.pickWholeWeek,Y)),V=[],ze=0,Y=!1)}return be(b,B,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var k=this._v;k!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,k!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var k=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),k.keyboardInput&&s(i,"keydown",this._onKeyChange),k.field&&(s(k.field,"change",this._onInputChange),k.bound&&(s(k.trigger,"click",this._onInputClick),s(k.trigger,"focus",this._onInputFocus),s(k.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ce})})(Y_e);const IM=O_;function xs(e){return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(e)}function q_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z_e(n.key),n)}}function X_e(e,t,r){return t&&MM(e.prototype,t),r&&MM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z_e(e){var t=Q_e(e,"string");return xs(t)==="symbol"?t:String(t)}function Q_e(e,t){if(xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qn(){return typeof Reflect<"u"&&Reflect.get?Qn=Reflect.get.bind():Qn=function(t,r,n){var o=J_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Qn.apply(this,arguments)}function J_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sn(e),e!==null););return e}function eOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R_(e,t)}function R_(e,t){return R_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},R_(e,t)}function tOe(e){var t=oOe();return function(){var n=sn(e),o;if(t){var i=sn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rOe(this,o)}}function rOe(e,t){if(t&&(xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nOe(e)}function nOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sn(e)}var KW="date",xM="dateEditor",iOe=function(e){eOe(r,e);var t=tOe(r);function r(n){var o;return q_e(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return X_e(r,[{key:"init",value:function(){var o=this;if(typeof te!="function")throw new Error("You need to include moment.js to your project.");if(typeof IM!="function")throw new Error("You need to include Pikaday to your project.");Qn(sn(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){Qn(sn(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),re(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new At(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){Qn(sn(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");Qn(sn(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:xM})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(xM),Qn(sn(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}Qn(sn(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?NF(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new IM(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+kt(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-vt(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,te(u,a,!0).isValid()&&this.$datePicker.setMoment(te(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,te(u,a,!0).isValid()&&this.$datePicker.setMoment(te(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&Um(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=te(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return KW}}]),r}(ff);function Ds(e){return Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(e)}function aOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sOe(n.key),n)}}function lOe(e,t,r){return t&&DM(e.prototype,t),r&&DM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sOe(e){var t=uOe(e,"string");return Ds(t)==="symbol"?t:String(t)}function uOe(e,t){if(Ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function By(){return typeof Reflect<"u"&&Reflect.get?By=Reflect.get.bind():By=function(t,r,n){var o=fOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},By.apply(this,arguments)}function fOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ns(e),e!==null););return e}function cOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E_(e,t)}function E_(e,t){return E_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},E_(e,t)}function hOe(e){var t=yOe();return function(){var n=Ns(e),o;if(t){var i=Ns(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dOe(this,o)}}function dOe(e,t){if(t&&(Ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vOe(e)}function vOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ns(e){return Ns=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ns(e)}var pOe="dropdown",qW=function(e){cOe(r,e);var t=hOe(r);function r(){return aOe(this,r),t.apply(this,arguments)}return lOe(r,[{key:"prepare",value:function(o,i,a,l,s,u){By(Ns(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return pOe}}]),r}(YW);me.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===qW&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Hs(e){return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function mOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bOe(n.key),n)}}function gOe(e,t,r){return t&&NM(e.prototype,t),r&&NM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bOe(e){var t=wOe(e,"string");return Hs(t)==="symbol"?t:String(t)}function wOe(e,t){if(Hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P_(e,t)}function P_(e,t){return P_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},P_(e,t)}function COe(e){var t=ROe();return function(){var n=im(e),o;if(t){var i=im(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _Oe(this,o)}}function _Oe(e,t){if(t&&(Hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OOe(e)}function OOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ROe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function im(e){return im=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},im(e)}var EOe="numeric",POe=function(e){SOe(r,e);var t=COe(r);function r(){return mOe(this,r),t.apply(this,arguments)}return gOe(r,null,[{key:"EDITOR_TYPE",get:function(){return EOe}}]),r}(ff);function Ls(e){return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function TOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Oe(n.key),n)}}function kOe(e,t,r){return t&&HM(e.prototype,t),r&&HM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Oe(e){var t=AOe(e,"string");return Ls(t)==="symbol"?t:String(t)}function AOe(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fy(){return typeof Reflect<"u"&&Reflect.get?Fy=Reflect.get.bind():Fy=function(t,r,n){var o=IOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Fy.apply(this,arguments)}function IOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=js(e),e!==null););return e}function MOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T_(e,t)}function T_(e,t){return T_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},T_(e,t)}function xOe(e){var t=HOe();return function(){var n=js(e),o;if(t){var i=js(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DOe(this,o)}}function DOe(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NOe(e)}function NOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function js(e){return js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},js(e)}var LOe="password",jOe=function(e){MOe(r,e);var t=xOe(r);function r(){return TOe(this,r),t.apply(this,arguments)}return kOe(r,[{key:"createElements",value:function(){Fy(js(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Io(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return LOe}}]),r}(ff);function Bs(e){return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function BOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VOe(n.key),n)}}function FOe(e,t,r){return t&&LM(e.prototype,t),r&&LM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VOe(e){var t=WOe(e,"string");return Bs(t)==="symbol"?t:String(t)}function WOe(e,t){if(Bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vy(){return typeof Reflect<"u"&&Reflect.get?Vy=Reflect.get.bind():Vy=function(t,r,n){var o=UOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Vy.apply(this,arguments)}function UOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fs(e),e!==null););return e}function zOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k_(e,t)}function k_(e,t){return k_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},k_(e,t)}function GOe(e){var t=qOe();return function(){var n=Fs(e),o;if(t){var i=Fs(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YOe(this,o)}}function YOe(e,t){if(t&&(Bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KOe(e)}function KOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fs(e){return Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fs(e)}var XOe="time",ZOe=function(e){zOe(r,e);var t=GOe(r);function r(){return BOe(this,r),t.apply(this,arguments)}return FOe(r,[{key:"prepare",value:function(o,i,a,l,s,u){Vy(Fs(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return XOe}}]),r}(ff),QOe="html";function $P(e,t,r,n,o,i,a){nv.apply(this,[e,t,r,n,o,i,a]),Yd(t,i??"",!1)}$P.RENDERER_TYPE=QOe;var JOe="autocomplete";function cf(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?$P:_i,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),re(t,"htAutocomplete"),!e.acArrowListener){var f=new At(e);e.acArrowListener=function(c){Ne(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}cf.RENDERER_TYPE=JOe;var jM=new WeakMap,BM=new WeakMap,eRe="htBadValue",Vs="data-row",Ws="data-col",tRe="checkboxRenderer",XW="checkbox";me.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===XW){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function AP(e,t,r,n,o,i,a){var l=e.rootDocument;nv.apply(this,[e,t,r,n,o,i,a]),rRe(e);var s=nRe(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Io(t),i===a.checkedTemplate||jt(i).toLocaleLowerCase(a.locale)===jt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||jt(i).toLocaleLowerCase(a.locale)===jt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:qt(i)?re(s,"noValue"):(s.style.display="none",re(s,eRe),f=!0),s.setAttribute(Vs,r),s.setAttribute(Ws,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=oRe(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),jM.has(e)||(jM.set(e,!0),v());function v(){var w=e.getShortcutManager(),S=w.getContext("grid"),_={group:tRe};S.addShortcuts([{keys:[["space"]],callback:function(){return p(),!g()}},{keys:[["enter"]],callback:function(){return p(),!g()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return p(!0),!g()},relativeToGroup:ec,position:"before"}],_)}function p(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var _=0;_<S.length;_++){for(var T=S[_].getTopStartCorner(),R=T.row,W=T.col,z=S[_].getBottomEndCorner(),X=z.row,K=z.col,q=[],Q=R;Q<=X;Q+=1)for(var ae=W;ae<=K;ae+=1){var Z=e.getCellMeta(Q,ae);if(Z.type!=="checkbox")return;if(Z.readOnly!==!0){typeof Z.checkedTemplate>"u"&&(Z.checkedTemplate=!0),typeof Z.uncheckedTemplate>"u"&&(Z.uncheckedTemplate=!1);var fe=e.getDataAtCell(Q,ae);w===!1?[Z.checkedTemplate,Z.checkedTemplate.toString()].includes(fe)?q.push([Q,ae,Z.uncheckedTemplate]):[Z.uncheckedTemplate,Z.uncheckedTemplate.toString(),null,void 0].includes(fe)&&q.push([Q,ae,Z.checkedTemplate]):q.push([Q,ae,Z.uncheckedTemplate])}}q.length>0&&e.setDataAtCell(q)}}function g(){var w=e.getSelectedRange();if(w){for(var S=0;S<w.length;S++)for(var _=w[S].getTopStartCorner(),T=w[S].getBottomEndCorner(),R=_.row;R<=T.row;R++)for(var W=_.col;W<=T.col;W++){var z=e.getCellMeta(R,W);if(z.type!=="checkbox")return!1;var X=e.getCell(R,W);if(X==null)return!0;var K=X.querySelectorAll("input[type=checkbox]");if(K.length>0&&!z.readOnly)return!0}return!1}}}AP.RENDERER_TYPE=XW;function rRe(e){var t=BM.get(e);if(!t){var r=e.rootElement;t=new At(e),t.addEventListener(r,"click",function(n){return aRe(n,e)}),t.addEventListener(r,"mouseup",function(n){return iRe(n,e)}),t.addEventListener(r,"change",function(n){return lRe(n,e)}),BM.set(e,t)}return t}function nRe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function oRe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function iRe(e,t){var r=e.target;IP(r)&&(!r.hasAttribute(Vs)||!r.hasAttribute(Ws)||setTimeout(t.listen,10))}function aRe(e,t){var r=e.target;if(IP(r)&&!(!r.hasAttribute(Vs)||!r.hasAttribute(Ws))){var n=parseInt(r.getAttribute(Vs),10),o=parseInt(r.getAttribute(Ws),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function lRe(e,t){var r=e.target;if(IP(r)&&!(!r.hasAttribute(Vs)||!r.hasAttribute(Ws))){var n=parseInt(r.getAttribute(Vs),10),o=parseInt(r.getAttribute(Ws),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function IP(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function Uv(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $_={},sRe={get exports(){return $_},set exports(e){$_=e}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof Uv=="function"&&Uv;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof Uv=="function"&&Uv,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],g=1e7,w=1e9;function S(K){var q=0|K;return 0<K||K===q?q:q-1}function _(K){for(var q,Q,ae=1,Z=K.length,fe=K[0]+"";ae<Z;){for(q=K[ae++]+"",Q=d-q.length;Q--;q="0"+q);fe+=q}for(Z=fe.length;fe.charCodeAt(--Z)===48;);return fe.slice(0,Z+1||1)}function T(K,q){var Q,ae,Z=K.c,fe=q.c,Oe=K.s,be=q.s,Ce=K.e,k=q.e;if(!Oe||!be)return null;if(Q=Z&&!Z[0],ae=fe&&!fe[0],Q||ae)return Q?ae?0:-be:Oe;if(Oe!=be)return Oe;if(Q=Oe<0,ae=Ce==k,!Z||!fe)return ae?0:!Z^Q?1:-1;if(!ae)return k<Ce^Q?1:-1;for(be=(Ce=Z.length)<(k=fe.length)?Ce:k,Oe=0;Oe<be;Oe++)if(Z[Oe]!=fe[Oe])return Z[Oe]>fe[Oe]^Q?1:-1;return Ce==k?0:k<Ce^Q?1:-1}function R(K,q,Q,ae){if(K<q||Q<K||K!==(K<0?s(K):u(K)))throw Error(f+(ae||"Argument")+(typeof K=="number"?K<q||Q<K?" out of range: ":" not an integer: ":" not a primitive number: ")+String(K))}function W(K){var q=K.c.length-1;return S(K.e/d)==q&&K.c[q]%2!=0}function z(K,q){return(1<K.length?K.charAt(0)+"."+K.slice(1):K)+(q<0?"e":"e+")+q}function X(K,q,Q){var ae,Z;if(q<0){for(Z=Q+".";++q;Z+=Q);K=Z+K}else if(++q>(ae=K.length)){for(Z=Q,q-=ae;--q;Z+=Q);K+=Z}else q<ae&&(K=K.slice(0,q)+"."+K.slice(q));return K}(a=function K(q){var Q,ae,Z,fe,Oe,be,Ce,k,y,m,b=Y.prototype={constructor:Y,toString:null,valueOf:null},O=new Y(1),P=20,A=4,B=-7,V=21,G=-1e7,J=1e7,ee=!1,le=1,Re=0,ce={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},he="0123456789abcdefghijklmnopqrstuvwxyz";function Y(C,E){var $,H,M,j,x,D,F,L,U=this;if(!(U instanceof Y))return new Y(C,E);if(E==null){if(C instanceof Y)return U.s=C.s,U.e=C.e,void(U.c=(C=C.c)?C.slice():C);if((D=typeof C=="number")&&0*C==0){if(U.s=1/C<0?(C=-C,-1):1,C===~~C){for(j=0,x=C;10<=x;x/=10,j++);return U.e=j,void(U.c=[C])}L=String(C)}else{if(L=String(C),!l.test(L))return Z(U,L,D);U.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(j=L.indexOf("."))&&(L=L.replace(".","")),0<(x=L.search(/e/i))?(j<0&&(j=x),j+=+L.slice(x+1),L=L.substring(0,x)):j<0&&(j=L.length)}else{if(R(E,2,he.length,"Base"),L=String(C),E==10)return $e(U=new Y(C instanceof Y?C:L),P+U.e+1,A);if(D=typeof C=="number"){if(0*C!=0)return Z(U,L,D,E);if(U.s=1/C<0?(L=L.slice(1),-1):1,Y.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(c+C);D=!1}else U.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for($=he.slice(0,E),j=x=0,F=L.length;x<F;x++)if($.indexOf(H=L.charAt(x))<0){if(H=="."){if(j<x){j=F;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,x=-1,j=0;continue}return Z(U,String(C),D,E)}-1<(j=(L=ae(L,E,10,U.s)).indexOf("."))?L=L.replace(".",""):j=L.length}for(x=0;L.charCodeAt(x)===48;x++);for(F=L.length;L.charCodeAt(--F)===48;);if(L=L.slice(x,++F)){if(F-=x,D&&Y.DEBUG&&15<F&&(v<C||C!==u(C)))throw Error(c+U.s*C);if(J<(j=j-x-1))U.c=U.e=null;else if(j<G)U.c=[U.e=0];else{if(U.e=j,U.c=[],x=(j+1)%d,j<0&&(x+=d),x<F){for(x&&U.c.push(+L.slice(0,x)),F-=d;x<F;)U.c.push(+L.slice(x,x+=d));L=L.slice(x),x=d-L.length}else x-=F;for(;x--;L+="0");U.c.push(+L)}}else U.c=[U.e=0]}function Ie(C,E,$,H){var M,j,x,D,F;if($==null?$=A:R($,0,8),!C.c)return C.toString();if(M=C.c[0],x=C.e,E==null)F=_(C.c),F=H==1||H==2&&(x<=B||V<=x)?z(F,x):X(F,x,"0");else if(j=(C=$e(new Y(C),E,$)).e,D=(F=_(C.c)).length,H==1||H==2&&(E<=j||j<=B)){for(;D<E;F+="0",D++);F=z(F,j)}else if(E-=x,F=X(F,j,"0"),D<j+1){if(0<--E)for(F+=".";E--;F+="0");}else if(0<(E+=j-D))for(j+1==D&&(F+=".");E--;F+="0");return C.s<0&&M?"-"+F:F}function ze(C,E){for(var $,H=1,M=new Y(C[0]);H<C.length;H++){if(!($=new Y(C[H])).s){M=$;break}E.call(M,$)&&(M=$)}return M}function Te(C,E,$){for(var H=1,M=E.length;!E[--M];E.pop());for(M=E[0];10<=M;M/=10,H++);return($=H+$*d-1)>J?C.c=C.e=null:C.c=$<G?[C.e=0]:(C.e=$,E),C}function $e(C,E,$,H){var M,j,x,D,F,L,U,ie=C.c,ye=p;if(ie){e:{for(M=1,D=ie[0];10<=D;D/=10,M++);if((j=E-M)<0)j+=d,x=E,U=(F=ie[L=0])/ye[M-x-1]%10|0;else if((L=s((j+1)/d))>=ie.length){if(!H)break e;for(;ie.length<=L;ie.push(0));F=U=0,x=(j%=d)-d+(M=1)}else{for(F=D=ie[L],M=1;10<=D;D/=10,M++);U=(x=(j%=d)-d+M)<0?0:F/ye[M-x-1]%10|0}if(H=H||E<0||ie[L+1]!=null||(x<0?F:F%ye[M-x-1]),H=$<4?(U||H)&&($==0||$==(C.s<0?3:2)):5<U||U==5&&($==4||H||$==6&&(0<j?0<x?F/ye[M-x]:0:ie[L-1])%10&1||$==(C.s<0?8:7)),E<1||!ie[0])return ie.length=0,H?(E-=C.e+1,ie[0]=ye[(d-E%d)%d],C.e=-E||0):ie[0]=C.e=0,C;if(j==0?(ie.length=L,D=1,L--):(ie.length=L+1,D=ye[d-j],ie[L]=0<x?u(F/ye[M-x]%ye[x])*D:0),H)for(;;){if(L==0){for(j=1,x=ie[0];10<=x;x/=10,j++);for(x=ie[0]+=D,D=1;10<=x;x/=10,D++);j!=D&&(C.e++,ie[0]==h&&(ie[0]=1));break}if(ie[L]+=D,ie[L]!=h)break;ie[L--]=0,D=1}for(j=ie.length;ie[--j]===0;ie.pop());}C.e>J?C.c=C.e=null:C.e<G&&(C.c=[C.e=0])}return C}function ke(C){var E,$=C.e;return $===null?C.toString():(E=_(C.c),E=$<=B||V<=$?z(E,$):X(E,$,"0"),C.s<0?"-"+E:E)}return Y.clone=K,Y.ROUND_UP=0,Y.ROUND_DOWN=1,Y.ROUND_CEIL=2,Y.ROUND_FLOOR=3,Y.ROUND_HALF_UP=4,Y.ROUND_HALF_DOWN=5,Y.ROUND_HALF_EVEN=6,Y.ROUND_HALF_CEIL=7,Y.ROUND_HALF_FLOOR=8,Y.EUCLID=9,Y.config=Y.set=function(C){var E,$;if(C!=null){if(typeof C!="object")throw Error(f+"Object expected: "+C);if(C.hasOwnProperty(E="DECIMAL_PLACES")&&(R($=C[E],0,w,E),P=$),C.hasOwnProperty(E="ROUNDING_MODE")&&(R($=C[E],0,8,E),A=$),C.hasOwnProperty(E="EXPONENTIAL_AT")&&(($=C[E])&&$.pop?(R($[0],-w,0,E),R($[1],0,w,E),B=$[0],V=$[1]):(R($,-w,w,E),B=-(V=$<0?-$:$))),C.hasOwnProperty(E="RANGE"))if(($=C[E])&&$.pop)R($[0],-w,-1,E),R($[1],1,w,E),G=$[0],J=$[1];else{if(R($,-w,w,E),!$)throw Error(f+E+" cannot be zero: "+$);G=-(J=$<0?-$:$)}if(C.hasOwnProperty(E="CRYPTO")){if(($=C[E])!==!!$)throw Error(f+E+" not true or false: "+$);if($){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ee=!$,Error(f+"crypto unavailable");ee=$}else ee=$}if(C.hasOwnProperty(E="MODULO_MODE")&&(R($=C[E],0,9,E),le=$),C.hasOwnProperty(E="POW_PRECISION")&&(R($=C[E],0,w,E),Re=$),C.hasOwnProperty(E="FORMAT")){if(typeof($=C[E])!="object")throw Error(f+E+" not an object: "+$);ce=$}if(C.hasOwnProperty(E="ALPHABET")){if(typeof($=C[E])!="string"||/^.$|[+-.\s]|(.).*\1/.test($))throw Error(f+E+" invalid: "+$);he=$}}return{DECIMAL_PLACES:P,ROUNDING_MODE:A,EXPONENTIAL_AT:[B,V],RANGE:[G,J],CRYPTO:ee,MODULO_MODE:le,POW_PRECISION:Re,FORMAT:ce,ALPHABET:he}},Y.isBigNumber=function(C){return C instanceof Y||C&&C._isBigNumber===!0||!1},Y.maximum=Y.max=function(){return ze(arguments,b.lt)},Y.minimum=Y.min=function(){return ze(arguments,b.gt)},Y.random=(fe=9007199254740992,Oe=Math.random()*fe&2097151?function(){return u(Math.random()*fe)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(C){var E,$,H,M,j,x=0,D=[],F=new Y(O);if(C==null?C=P:R(C,0,w),M=s(C/d),ee)if(crypto.getRandomValues){for(E=crypto.getRandomValues(new Uint32Array(M*=2));x<M;)9e15<=(j=131072*E[x]+(E[x+1]>>>11))?($=crypto.getRandomValues(new Uint32Array(2)),E[x]=$[0],E[x+1]=$[1]):(D.push(j%1e14),x+=2);x=M/2}else{if(!crypto.randomBytes)throw ee=!1,Error(f+"crypto unavailable");for(E=crypto.randomBytes(M*=7);x<M;)9e15<=(j=281474976710656*(31&E[x])+1099511627776*E[x+1]+4294967296*E[x+2]+16777216*E[x+3]+(E[x+4]<<16)+(E[x+5]<<8)+E[x+6])?crypto.randomBytes(7).copy(E,x):(D.push(j%1e14),x+=7);x=M/7}if(!ee)for(;x<M;)(j=Oe())<9e15&&(D[x++]=j%1e14);for(M=D[--x],C%=d,M&&C&&(j=p[d-C],D[x]=u(M/j)*j);D[x]===0;D.pop(),x--);if(x<0)D=[H=0];else{for(H=-1;D[0]===0;D.splice(0,1),H-=d);for(x=1,j=D[0];10<=j;j/=10,x++);x<d&&(H-=d-x)}return F.e=H,F.c=D,F}),Y.sum=function(){for(var C=1,E=arguments,$=new Y(E[0]);C<E.length;)$=$.plus(E[C++]);return $},ae=function(){var C="0123456789";function E($,H,M,j){for(var x,D,F=[0],L=0,U=$.length;L<U;){for(D=F.length;D--;F[D]*=H);for(F[0]+=j.indexOf($.charAt(L++)),x=0;x<F.length;x++)F[x]>M-1&&(F[x+1]==null&&(F[x+1]=0),F[x+1]+=F[x]/M|0,F[x]%=M)}return F.reverse()}return function($,H,M,j,x){var D,F,L,U,ie,ye,_e,Me,Ke=$.indexOf("."),ft=P,xe=A;for(0<=Ke&&(U=Re,Re=0,$=$.replace(".",""),ye=(Me=new Y(H)).pow($.length-Ke),Re=U,Me.c=E(X(_(ye.c),ye.e,"0"),10,M,C),Me.e=Me.c.length),L=U=(_e=E($,H,M,x?(D=he,C):(D=C,he))).length;_e[--U]==0;_e.pop());if(!_e[0])return D.charAt(0);if(Ke<0?--L:(ye.c=_e,ye.e=L,ye.s=j,_e=(ye=Q(ye,Me,ft,xe,M)).c,ie=ye.r,L=ye.e),Ke=_e[F=L+ft+1],U=M/2,ie=ie||F<0||_e[F+1]!=null,ie=xe<4?(Ke!=null||ie)&&(xe==0||xe==(ye.s<0?3:2)):U<Ke||Ke==U&&(xe==4||ie||xe==6&&1&_e[F-1]||xe==(ye.s<0?8:7)),F<1||!_e[0])$=ie?X(D.charAt(1),-ft,D.charAt(0)):D.charAt(0);else{if(_e.length=F,ie)for(--M;++_e[--F]>M;)_e[F]=0,F||(++L,_e=[1].concat(_e));for(U=_e.length;!_e[--U];);for(Ke=0,$="";Ke<=U;$+=D.charAt(_e[Ke++]));$=X($,L,D.charAt(0))}return $}}(),Q=function(){function C(H,M,j){var x,D,F,L,U=0,ie=H.length,ye=M%g,_e=M/g|0;for(H=H.slice();ie--;)U=((D=ye*(F=H[ie]%g)+(x=_e*F+(L=H[ie]/g|0)*ye)%g*g+U)/j|0)+(x/g|0)+_e*L,H[ie]=D%j;return U&&(H=[U].concat(H)),H}function E(H,M,j,x){var D,F;if(j!=x)F=x<j?1:-1;else for(D=F=0;D<j;D++)if(H[D]!=M[D]){F=H[D]>M[D]?1:-1;break}return F}function $(H,M,j,x){for(var D=0;j--;)H[j]-=D,D=H[j]<M[j]?1:0,H[j]=D*x+H[j]-M[j];for(;!H[0]&&1<H.length;H.splice(0,1));}return function(H,M,j,x,D){var F,L,U,ie,ye,_e,Me,Ke,ft,xe,De,tt,ot,Je,qe,Qe,Nt,ht=H.s==M.s?1:-1,lt=H.c,rt=M.c;if(!(lt&&lt[0]&&rt&&rt[0]))return new Y(H.s&&M.s&&(lt?!rt||lt[0]!=rt[0]:rt)?lt&&lt[0]==0||!rt?0*ht:ht/0:NaN);for(ft=(Ke=new Y(ht)).c=[],ht=j+(L=H.e-M.e)+1,D||(D=h,L=S(H.e/d)-S(M.e/d),ht=ht/d|0),U=0;rt[U]==(lt[U]||0);U++);if(rt[U]>(lt[U]||0)&&L--,ht<0)ft.push(1),ie=!0;else{for(Je=lt.length,Qe=rt.length,ht+=2,1<(ye=u(D/(rt[U=0]+1)))&&(rt=C(rt,ye,D),lt=C(lt,ye,D),Qe=rt.length,Je=lt.length),ot=Qe,De=(xe=lt.slice(0,Qe)).length;De<Qe;xe[De++]=0);Nt=rt.slice(),Nt=[0].concat(Nt),qe=rt[0],rt[1]>=D/2&&qe++;do{if(ye=0,(F=E(rt,xe,Qe,De))<0){if(tt=xe[0],Qe!=De&&(tt=tt*D+(xe[1]||0)),1<(ye=u(tt/qe)))for(D<=ye&&(ye=D-1),Me=(_e=C(rt,ye,D)).length,De=xe.length;E(_e,xe,Me,De)==1;)ye--,$(_e,Qe<Me?Nt:rt,Me,D),Me=_e.length,F=1;else ye==0&&(F=ye=1),Me=(_e=rt.slice()).length;if(Me<De&&(_e=[0].concat(_e)),$(xe,_e,De,D),De=xe.length,F==-1)for(;E(rt,xe,Qe,De)<1;)ye++,$(xe,Qe<De?Nt:rt,De,D),De=xe.length}else F===0&&(ye++,xe=[0]);ft[U++]=ye,xe[0]?xe[De++]=lt[ot]||0:(xe=[lt[ot]],De=1)}while((ot++<Je||xe[0]!=null)&&ht--);ie=xe[0]!=null,ft[0]||ft.splice(0,1)}if(D==h){for(U=1,ht=ft[0];10<=ht;ht/=10,U++);$e(Ke,j+(Ke.e=U+L*d-1)+1,x,ie)}else Ke.e=L,Ke.r=+ie;return Ke}}(),be=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ce=/^([^.]+)\.$/,k=/^\.([^.]+)$/,y=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,Z=function(C,E,$,H){var M,j=$?E:E.replace(m,"");if(y.test(j))C.s=isNaN(j)?null:j<0?-1:1,C.c=C.e=null;else{if(!$&&(j=j.replace(be,function(x,D,F){return M=(F=F.toLowerCase())=="x"?16:F=="b"?2:8,H&&H!=M?x:D}),H&&(M=H,j=j.replace(Ce,"$1").replace(k,"0.$1")),E!=j))return new Y(j,M);if(Y.DEBUG)throw Error(f+"Not a"+(H?" base "+H:"")+" number: "+E);C.c=C.e=C.s=null}},b.absoluteValue=b.abs=function(){var C=new Y(this);return C.s<0&&(C.s=1),C},b.comparedTo=function(C,E){return T(this,new Y(C,E))},b.decimalPlaces=b.dp=function(C,E){var $,H,M;if(C!=null)return R(C,0,w),E==null?E=A:R(E,0,8),$e(new Y(this),C+this.e+1,E);if(!($=this.c))return null;if(H=((M=$.length-1)-S(this.e/d))*d,M=$[M])for(;M%10==0;M/=10,H--);return H<0&&(H=0),H},b.dividedBy=b.div=function(C,E){return Q(this,new Y(C,E),P,A)},b.dividedToIntegerBy=b.idiv=function(C,E){return Q(this,new Y(C,E),0,1)},b.exponentiatedBy=b.pow=function(C,E){var $,H,M,j,x,D,F,L,U=this;if((C=new Y(C)).c&&!C.isInteger())throw Error(f+"Exponent not an integer: "+ke(C));if(E!=null&&(E=new Y(E)),x=14<C.e,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!C.c||!C.c[0])return L=new Y(Math.pow(+ke(U),x?2-W(C):+ke(C))),E?L.mod(E):L;if(D=C.s<0,E){if(E.c?!E.c[0]:!E.s)return new Y(NaN);(H=!D&&U.isInteger()&&E.isInteger())&&(U=U.mod(E))}else{if(9<C.e&&(0<U.e||U.e<-1||(U.e==0?1<U.c[0]||x&&24e7<=U.c[1]:U.c[0]<8e13||x&&U.c[0]<=9999975e7)))return j=U.s<0&&W(C)?-0:0,-1<U.e&&(j=1/j),new Y(D?1/j:j);Re&&(j=s(Re/d+2))}for(F=x?($=new Y(.5),D&&(C.s=1),W(C)):(M=Math.abs(+ke(C)))%2,L=new Y(O);;){if(F){if(!(L=L.times(U)).c)break;j?L.c.length>j&&(L.c.length=j):H&&(L=L.mod(E))}if(M){if((M=u(M/2))===0)break;F=M%2}else if($e(C=C.times($),C.e+1,1),14<C.e)F=W(C);else{if((M=+ke(C))==0)break;F=M%2}U=U.times(U),j?U.c&&U.c.length>j&&(U.c.length=j):H&&(U=U.mod(E))}return H?L:(D&&(L=O.div(L)),E?L.mod(E):j?$e(L,Re,A,void 0):L)},b.integerValue=function(C){var E=new Y(this);return C==null?C=A:R(C,0,8),$e(E,E.e+1,C)},b.isEqualTo=b.eq=function(C,E){return T(this,new Y(C,E))===0},b.isFinite=function(){return!!this.c},b.isGreaterThan=b.gt=function(C,E){return 0<T(this,new Y(C,E))},b.isGreaterThanOrEqualTo=b.gte=function(C,E){return(E=T(this,new Y(C,E)))===1||E===0},b.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},b.isLessThan=b.lt=function(C,E){return T(this,new Y(C,E))<0},b.isLessThanOrEqualTo=b.lte=function(C,E){return(E=T(this,new Y(C,E)))===-1||E===0},b.isNaN=function(){return!this.s},b.isNegative=function(){return this.s<0},b.isPositive=function(){return 0<this.s},b.isZero=function(){return!!this.c&&this.c[0]==0},b.minus=function(C,E){var $,H,M,j,x=this,D=x.s;if(E=(C=new Y(C,E)).s,!D||!E)return new Y(NaN);if(D!=E)return C.s=-E,x.plus(C);var F=x.e/d,L=C.e/d,U=x.c,ie=C.c;if(!F||!L){if(!U||!ie)return U?(C.s=-E,C):new Y(ie?x:NaN);if(!U[0]||!ie[0])return ie[0]?(C.s=-E,C):new Y(U[0]?x:A==3?-0:0)}if(F=S(F),L=S(L),U=U.slice(),D=F-L){for((M=(j=D<0)?(D=-D,U):(L=F,ie)).reverse(),E=D;E--;M.push(0));M.reverse()}else for(H=(j=(D=U.length)<(E=ie.length))?D:E,D=E=0;E<H;E++)if(U[E]!=ie[E]){j=U[E]<ie[E];break}if(j&&(M=U,U=ie,ie=M,C.s=-C.s),0<(E=(H=ie.length)-($=U.length)))for(;E--;U[$++]=0);for(E=h-1;D<H;){if(U[--H]<ie[H]){for($=H;$&&!U[--$];U[$]=E);--U[$],U[H]+=h}U[H]-=ie[H]}for(;U[0]==0;U.splice(0,1),--L);return U[0]?Te(C,U,L):(C.s=A==3?-1:1,C.c=[C.e=0],C)},b.modulo=b.mod=function(C,E){var $,H,M=this;return C=new Y(C,E),!M.c||!C.s||C.c&&!C.c[0]?new Y(NaN):!C.c||M.c&&!M.c[0]?new Y(M):(le==9?(H=C.s,C.s=1,$=Q(M,C,0,3),C.s=H,$.s*=H):$=Q(M,C,0,le),(C=M.minus($.times(C))).c[0]||le!=1||(C.s=M.s),C)},b.multipliedBy=b.times=function(C,E){var $,H,M,j,x,D,F,L,U,ie,ye,_e,Me,Ke,ft,xe=this,De=xe.c,tt=(C=new Y(C,E)).c;if(!(De&&tt&&De[0]&&tt[0]))return!xe.s||!C.s||De&&!De[0]&&!tt||tt&&!tt[0]&&!De?C.c=C.e=C.s=null:(C.s*=xe.s,De&&tt?(C.c=[0],C.e=0):C.c=C.e=null),C;for(H=S(xe.e/d)+S(C.e/d),C.s*=xe.s,(F=De.length)<(ie=tt.length)&&(Me=De,De=tt,tt=Me,M=F,F=ie,ie=M),M=F+ie,Me=[];M--;Me.push(0));for(Ke=h,ft=g,M=ie;0<=--M;){for($=0,ye=tt[M]%ft,_e=tt[M]/ft|0,j=M+(x=F);M<j;)$=((L=ye*(L=De[--x]%ft)+(D=_e*L+(U=De[x]/ft|0)*ye)%ft*ft+Me[j]+$)/Ke|0)+(D/ft|0)+_e*U,Me[j--]=L%Ke;Me[j]=$}return $?++H:Me.splice(0,1),Te(C,Me,H)},b.negated=function(){var C=new Y(this);return C.s=-C.s||null,C},b.plus=function(C,E){var $,H=this,M=H.s;if(E=(C=new Y(C,E)).s,!M||!E)return new Y(NaN);if(M!=E)return C.s=-E,H.minus(C);var j=H.e/d,x=C.e/d,D=H.c,F=C.c;if(!j||!x){if(!D||!F)return new Y(M/0);if(!D[0]||!F[0])return F[0]?C:new Y(D[0]?H:0*M)}if(j=S(j),x=S(x),D=D.slice(),M=j-x){for(($=0<M?(x=j,F):(M=-M,D)).reverse();M--;$.push(0));$.reverse()}for((M=D.length)-(E=F.length)<0&&($=F,F=D,D=$,E=M),M=0;E;)M=(D[--E]=D[E]+F[E]+M)/h|0,D[E]=h===D[E]?0:D[E]%h;return M&&(D=[M].concat(D),++x),Te(C,D,x)},b.precision=b.sd=function(C,E){var $,H,M;if(C!=null&&C!==!!C)return R(C,1,w),E==null?E=A:R(E,0,8),$e(new Y(this),C,E);if(!($=this.c))return null;if(H=(M=$.length-1)*d+1,M=$[M]){for(;M%10==0;M/=10,H--);for(M=$[0];10<=M;M/=10,H++);}return C&&this.e+1>H&&(H=this.e+1),H},b.shiftedBy=function(C){return R(C,-v,v),this.times("1e"+C)},b.squareRoot=b.sqrt=function(){var C,E,$,H,M,j=this,x=j.c,D=j.s,F=j.e,L=P+4,U=new Y("0.5");if(D!==1||!x||!x[0])return new Y(!D||D<0&&(!x||x[0])?NaN:x?j:1/0);if(($=(D=Math.sqrt(+ke(j)))==0||D==1/0?(((E=_(x)).length+F)%2==0&&(E+="0"),D=Math.sqrt(+E),F=S((F+1)/2)-(F<0||F%2),new Y(E=D==1/0?"1e"+F:(E=D.toExponential()).slice(0,E.indexOf("e")+1)+F)):new Y(D+"")).c[0]){for((D=(F=$.e)+L)<3&&(D=0);;)if(M=$,$=U.times(M.plus(Q(j,M,L,1))),_(M.c).slice(0,D)===(E=_($.c)).slice(0,D)){if($.e<F&&--D,(E=E.slice(D-3,D+1))!="9999"&&(H||E!="4999")){+E&&(+E.slice(1)||E.charAt(0)!="5")||($e($,$.e+P+2,1),C=!$.times($).eq(j));break}if(!H&&($e(M,M.e+P+2,0),M.times(M).eq(j))){$=M;break}L+=4,D+=4,H=1}}return $e($,$.e+P+1,A,C)},b.toExponential=function(C,E){return C!=null&&(R(C,0,w),C++),Ie(this,C,E,1)},b.toFixed=function(C,E){return C!=null&&(R(C,0,w),C=C+this.e+1),Ie(this,C,E)},b.toFormat=function(C,E,$){var H;if($==null)C!=null&&E&&typeof E=="object"?($=E,E=null):C&&typeof C=="object"?($=C,C=E=null):$=ce;else if(typeof $!="object")throw Error(f+"Argument not an object: "+$);if(H=this.toFixed(C,E),this.c){var M,j=H.split("."),x=+$.groupSize,D=+$.secondaryGroupSize,F=$.groupSeparator||"",L=j[0],U=j[1],ie=this.s<0,ye=ie?L.slice(1):L,_e=ye.length;if(D&&(M=x,x=D,_e-=D=M),0<x&&0<_e){for(M=_e%x||x,L=ye.substr(0,M);M<_e;M+=x)L+=F+ye.substr(M,x);0<D&&(L+=F+ye.slice(M)),ie&&(L="-"+L)}H=U?L+($.decimalSeparator||"")+((D=+$.fractionGroupSize)?U.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+($.fractionGroupSeparator||"")):U):L}return($.prefix||"")+H+($.suffix||"")},b.toFraction=function(C){var E,$,H,M,j,x,D,F,L,U,ie,ye,_e=this,Me=_e.c;if(C!=null&&(!(D=new Y(C)).isInteger()&&(D.c||D.s!==1)||D.lt(O)))throw Error(f+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+ke(D));if(!Me)return new Y(_e);for(E=new Y(O),L=$=new Y(O),H=F=new Y(O),ye=_(Me),j=E.e=ye.length-_e.e-1,E.c[0]=p[(x=j%d)<0?d+x:x],C=!C||0<D.comparedTo(E)?0<j?E:L:D,x=J,J=1/0,D=new Y(ye),F.c[0]=0;U=Q(D,E,0,1),(M=$.plus(U.times(H))).comparedTo(C)!=1;)$=H,H=M,L=F.plus(U.times(M=L)),F=M,E=D.minus(U.times(M=E)),D=M;return M=Q(C.minus($),H,0,1),F=F.plus(M.times(L)),$=$.plus(M.times(H)),F.s=L.s=_e.s,ie=Q(L,H,j*=2,A).minus(_e).abs().comparedTo(Q(F,$,j,A).minus(_e).abs())<1?[L,H]:[F,$],J=x,ie},b.toNumber=function(){return+ke(this)},b.toPrecision=function(C,E){return C!=null&&R(C,1,w),Ie(this,C,E,2)},b.toString=function(C){var E,$=this,H=$.s,M=$.e;return M===null?H?(E="Infinity",H<0&&(E="-"+E)):E="NaN":(E=C==null?M<=B||V<=M?z(_($.c),M):X(_($.c),M,"0"):C===10?X(_(($=$e(new Y($),P+M+1,A)).c),$.e,"0"):(R(C,2,he.length,"Base"),ae(X(_($.c),M,"0"),10,C,H,!0)),H<0&&$.c[0]&&(E="-"+E)),E},b.valueOf=b.toJSON=function(){return ke(this)},b._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(b[Symbol.toStringTag]="BigNumber",b[Symbol.for("nodejs.util.inspect.custom")]=b.valueOf),q!=null&&Y.set(q),Y}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,_){return function(T){if(Array.isArray(T))return T}(S)||function(T,R){var W=[],z=!0,X=!1,K=void 0;try{for(var q,Q=T[Symbol.iterator]();!(z=(q=Q.next()).done)&&(W.push(q.value),!R||W.length!==R);z=!0);}catch(ae){X=!0,K=ae}finally{try{z||Q.return==null||Q.return()}finally{if(X)throw K}}return W}(S,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var _=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},T=2<arguments.length?arguments[2]:void 0;if(typeof _=="string"&&(_=s.parseFormat(_)),!l.validateFormat(_))return"ERROR: invalid format";var R=_.prefix||"",W=_.postfix||"",z=function(X,K,q){switch(K.output){case"currency":return K=w(K,a.currentCurrencyDefaultFormat()),function(he,Y,Ie){var ze=Ie.currentCurrency(),Te=Object.assign({},c,Y),$e=void 0,ke="",C=!!Te.totalLength||!!Te.forceAverage||Te.average,E=Y.currencyPosition||ze.position,$=Y.currencySymbol||ze.symbol;Te.spaceSeparated&&(ke=" "),E==="infix"&&($e=ke+$+ke);var H=g({instance:he,providedFormat:Y,state:Ie,decimalSeparator:$e});return E==="prefix"&&(H=he._value<0&&Te.negative==="sign"?"-".concat(ke).concat($).concat(H.slice(1)):$+ke+H),E&&E!=="postfix"||(H=H+(ke=C?"":ke)+$),H}(X,K,a);case"percent":return K=w(K,a.currentPercentageDefaultFormat()),function(he,Y,Ie,ze){var Te=Y.prefixSymbol,$e=g({instance:ze(100*he._value),providedFormat:Y,state:Ie}),ke=Object.assign({},c,Y);return Te?"%".concat(ke.spaceSeparated?" ":"").concat($e):"".concat($e).concat(ke.spaceSeparated?" ":"","%")}(X,K,a,q);case"byte":return K=w(K,a.currentByteDefaultFormat()),O=X,A=a,B=q,V=(P=K).base||"binary",G=f[V],J=d(O._value,G.suffixes,G.scale),ee=J.value,le=J.suffix,Re=g({instance:B(ee),providedFormat:P,state:A,defaults:A.currentByteDefaultFormat()}),ce=A.currentAbbreviations(),"".concat(Re).concat(ce.spaced?" ":"").concat(le);case"time":return K=w(K,a.currentTimeDefaultFormat()),k=X,y=Math.floor(k._value/60/60),m=Math.floor((k._value-60*y*60)/60),b=Math.round(k._value-60*y*60-60*m),"".concat(y,":").concat(m<10?"0":"").concat(m,":").concat(b<10?"0":"").concat(b);case"ordinal":return K=w(K,a.currentOrdinalDefaultFormat()),Q=X,ae=K,fe=(Z=a).currentOrdinal(),Oe=Object.assign({},c,ae),be=g({instance:Q,providedFormat:ae,state:Z}),Ce=fe(Q._value),"".concat(be).concat(Oe.spaceSeparated?" ":"").concat(Ce);case"number":default:return g({instance:X,providedFormat:K,numbro:q})}var Q,ae,Z,fe,Oe,be,Ce,k,y,m,b,O,P,A,B,V,G,J,ee,le,Re,ce}(S,_,T);return z=(z=R+z)+W}function d(S,_,T){var R=_[0],W=Math.abs(S);if(T<=W){for(var z=1;z<_.length;++z){var X=Math.pow(T,z),K=Math.pow(T,z+1);if(X<=W&&W<K){R=_[z],S/=X;break}}R===_[0]&&(S/=Math.pow(T,_.length-1),R=_[_.length-1])}return{value:S,suffix:R}}function v(S){for(var _="",T=0;T<S;T++)_+="0";return _}function p(S,_){return S.toString().indexOf("e")!==-1?function(T,R){var W=T.toString(),z=i(W.split("e"),2),X=z[0],K=z[1],q=i(X.split("."),2),Q=q[0],ae=q[1],Z=ae===void 0?"":ae;if(0<+K)W=Q+Z+v(K-Z.length);else{var fe=".";fe=+Q<0?"-0".concat(fe):"0".concat(fe);var Oe=(v(-K-1)+Math.abs(Q)+Z).substr(0,R);Oe.length<R&&(Oe+=v(R-Oe.length)),W=fe+Oe}return 0<+K&&0<R&&(W+=".".concat(v(R))),W}(S,_):(Math.round(+"".concat(S,"e+").concat(_))/Math.pow(10,_)).toFixed(_)}function g(S){var _=S.instance,T=S.providedFormat,R=S.state,W=R===void 0?a:R,z=S.decimalSeparator,X=S.defaults,K=X===void 0?W.currentDefaults():X,q=_._value;if(q===0&&W.hasZeroFormat())return W.getZeroFormat();if(!isFinite(q))return q.toString();var Q,ae,Z,fe,Oe,be,Ce,k,y=Object.assign({},c,K,T),m=y.totalLength,b=m?0:y.characteristic,O=y.optionalCharacteristic,P=y.forceAverage,A=!!m||!!P||y.average,B=m?-1:A&&T.mantissa===void 0?0:y.mantissa,V=!m&&(T.optionalMantissa===void 0?B===-1:y.optionalMantissa),G=y.trimMantissa,J=y.thousandSeparated,ee=y.spaceSeparated,le=y.negative,Re=y.forceSign,ce=y.exponential,he="";if(A){var Y=function(C){var E=C.value,$=C.forceAverage,H=C.abbreviations,M=C.spaceSeparated,j=M!==void 0&&M,x=C.totalLength,D=x===void 0?0:x,F="",L=Math.abs(E),U=-1;if(L>=Math.pow(10,12)&&!$||$==="trillion"?(F=H.trillion,E/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!$||$==="billion"?(F=H.billion,E/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!$||$==="million"?(F=H.million,E/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!$||$==="thousand")&&(F=H.thousand,E/=Math.pow(10,3)),F&&(F=(j?" ":"")+F),D){var ie=E.toString().split(".")[0];U=Math.max(D-ie.length,0)}return{value:E,abbreviation:F,mantissaPrecision:U}}({value:q,forceAverage:P,abbreviations:W.currentAbbreviations(),spaceSeparated:ee,totalLength:m});q=Y.value,he+=Y.abbreviation,m&&(B=Y.mantissaPrecision)}if(ce){var Ie=(ae=(Q={value:q,characteristicPrecision:b}).value,Z=Q.characteristicPrecision,fe=Z===void 0?0:Z,Oe=i(ae.toExponential().split("e"),2),be=Oe[0],Ce=Oe[1],k=+be,fe&&1<fe&&(k*=Math.pow(10,fe-1),Ce=0<=(Ce=+Ce-(fe-1))?"+".concat(Ce):Ce),{value:k,abbreviation:"e".concat(Ce)});q=Ie.value,he=Ie.abbreviation+he}var ze,Te,$e,ke=function(C,E,$,H,M){if(H===-1)return C;var j=p(E,H),x=i(j.toString().split("."),2),D=x[0],F=x[1],L=F===void 0?"":F;if(L.match(/^0+$/)&&($||M))return D;var U=L.match(/0+$/);return M&&U?"".concat(D,".").concat(L.toString().slice(0,U.index)):j.toString()}(q.toString(),q,V,B,G);return ke=function(C,E,$,H,M){var j=H.currentDelimiters(),x=j.thousands;M=M||j.decimal;var D=j.thousandsSize||3,F=C.toString(),L=F.split(".")[0],U=F.split(".")[1];return $&&(E<0&&(L=L.slice(1)),function(ie,ye){for(var _e=[],Me=0,Ke=ie;0<Ke;Ke--)Me===ye&&(_e.unshift(Ke),Me=0),Me++;return _e}(L.length,D).forEach(function(ie,ye){L=L.slice(0,ie+ye)+x+L.slice(ie+ye)}),E<0&&(L="-".concat(L))),F=U?L+M+U:L}(ke=function(C,E,$,H){var M=C,j=i(M.toString().split("."),2),x=j[0],D=j[1];if(x.match(/^-?0$/)&&$)return D?"".concat(x.replace("0",""),".").concat(D):x.replace("0","");if(x.length<H)for(var F=H-x.length,L=0;L<F;L++)M="0".concat(M);return M.toString()}(ke,0,O,b),q,J,W,z),(A||ce)&&(ke=ke+he),(Re||q<0)&&(ze=ke,$e=le,ke=(Te=q)===0?ze:+ze==0?ze.replace("-",""):0<Te?"+".concat(ze):$e==="sign"?ze:"(".concat(ze.replace("-",""),")")),ke}function w(S,_){if(!S)return _;var T=Object.keys(S);return T.length===1&&T[0]==="output"?_:S}n.exports=function(S){return{format:function(){for(var _=arguments.length,T=new Array(_),R=0;R<_;R++)T[R]=arguments[R];return h.apply(void 0,T.concat([S]))},getByteUnit:function(){for(var _=arguments.length,T=new Array(_),R=0;R<_;R++)T[R]=arguments[R];return function(W){var z=f.general;return d(W._value,z.suffixes,z.scale).suffix}.apply(void 0,T.concat([S]))},getBinaryByteUnit:function(){for(var _=arguments.length,T=new Array(_),R=0;R<_;R++)T[R]=arguments[R];return function(W){var z=f.binary;return d(W._value,z.suffixes,z.scale).suffix}.apply(void 0,T.concat([S]))},getDecimalByteUnit:function(){for(var _=arguments.length,T=new Array(_),R=0;R<_;R++)T[R]=arguments[R];return function(W){var z=f.decimal;return d(W._value,z.suffixes,z.scale).suffix}.apply(void 0,T.concat([S]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(p){u=p}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(p){p=l.parseFormat(p),a.validateFormat(p)&&(h=p)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(p){return c=typeof p=="string"?p:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(p){if(p){if(f[p])return f[p];throw new Error('Unknown tag "'.concat(p,'"'))}return v()},s.registerLanguage=function(p){var g=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(p))throw new Error("Invalid language data");f[p.languageTag]=p,g&&d(p.languageTag)},s.setLanguage=function(p){var g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[p]){var w=p.split("-")[0],S=Object.keys(f).find(function(_){return _.split("-")[0]===w});return f[S]?void d(S):void d(g)}d(p)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(g,w){for(var S=0;S<w.length;S++){var _=w[S];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(g,_.key,_)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(p),u=r("./unformatting"),f=r("./formatting")(p),c=r("./manipulating")(p),h=r("./parsing"),d=function(){function g(_){(function(T,R){if(!(T instanceof R))throw new TypeError("Cannot call a class as a function")})(this,g),this._value=_}var w,S;return w=g,(S=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,_)}},{key:"formatCurrency",value:function(_){return typeof _=="string"&&(_=h.parseFormat(_)),(_=f.formatOrDefault(_,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,_)}},{key:"formatTime",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return _.output="time",f.format(this,_)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(_){return c.difference(this,_)}},{key:"add",value:function(_){return c.add(this,_)}},{key:"subtract",value:function(_){return c.subtract(this,_)}},{key:"multiply",value:function(_){return c.multiply(this,_)}},{key:"divide",value:function(_){return c.divide(this,_)}},{key:"set",value:function(_){return c.set(this,v(_))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,S),g}();function v(g){var w=g;return p.isNumbro(g)?w=g._value:typeof g=="string"?w=p.unformat(g):isNaN(g)&&(w=NaN),w}function p(g){return new d(v(g))}p.version="2.1.2",p.isNumbro=function(g){return g instanceof d},p.language=a.currentLanguage,p.registerLanguage=a.registerLanguage,p.setLanguage=a.setLanguage,p.languages=a.languages,p.languageData=a.languageData,p.zeroFormat=a.setZeroFormat,p.defaultFormat=a.currentDefaults,p.setDefaults=a.setDefaults,p.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,p.validate=l.validate,p.loadLanguagesInNode=s.loadLanguagesInNode,p.unformat=u.unformat,n.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,p,g,w,S,_,T,R,W,z,X,K,q=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=q,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=q,function(Q,ae){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(ae.output="byte",ae.base="general"):Q.indexOf("b")!==-1?(ae.output="byte",ae.base="binary"):Q.indexOf("d")!==-1?(ae.output="byte",ae.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(ae.output="ordinal"):ae.output="time";ae.output="percent"}else ae.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,q),h=q,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=q,(p=i.split(".")[0].match(/0+/))&&(v.characteristic=p[0].length),function(Q,ae){if(Q.indexOf(".")!==-1){var Z=Q.split(".")[0];ae.optionalCharacteristic=Z.indexOf("0")===-1}}(i,q),g=q,i.indexOf("a")!==-1&&(g.average=!0),S=q,(w=i).indexOf("K")!==-1?S.forceAverage="thousand":w.indexOf("M")!==-1?S.forceAverage="million":w.indexOf("B")!==-1?S.forceAverage="billion":w.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Q,ae){var Z=Q.split(".")[1];if(Z){var fe=Z.match(/0+/);fe&&(ae.mantissa=fe[0].length)}}(i,q),T=q,(_=i).match(/\[\.]/)?T.optionalMantissa=!0:_.match(/\./)&&(T.optionalMantissa=!1),R=q,i.indexOf(",")!==-1&&(R.thousandSeparated=!0),W=q,i.indexOf(" ")!==-1&&(W.spaceSeparated=!0),X=q,(z=i).match(/^\+?\([^)]*\)$/)&&(X.negative="parenthesis"),z.match(/^\+?-/)&&(X.negative="sign"),K=q,i.match(/^\+/)&&(K.forceSign=!0),q)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function p(g,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=3<arguments.length?arguments[3]:void 0,T=4<arguments.length?arguments[4]:void 0,R=5<arguments.length?arguments[5]:void 0,W=6<arguments.length?arguments[6]:void 0;if(!isNaN(+g))return+g;var z="",X=g.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(X!==g)return-1*p(X,w,S,_,T,R,W);for(var K=0;K<i.length;K++){var q=i[K];if((z=g.replace(q.key,""))!==g)return p(z,w,S,_,T,R,W)*q.factor}if((z=g.replace("%",""))!==g)return p(z,w,S,_,T,R,W)/100;var Q=parseFloat(g);if(!isNaN(Q)){var ae=_(Q);if(ae&&ae!=="."&&(z=g.replace(new RegExp("".concat(a(ae),"$")),""))!==g)return p(z,w,S,_,T,R,W);var Z={};Object.keys(R).forEach(function(m){Z[R[m]]=m});for(var fe=Object.keys(Z).sort().reverse(),Oe=fe.length,be=0;be<Oe;be++){var Ce=fe[be],k=Z[Ce];if((z=g.replace(Ce,""))!==g){var y=void 0;switch(k){case"thousand":y=Math.pow(10,3);break;case"million":y=Math.pow(10,6);break;case"billion":y=Math.pow(10,9);break;case"trillion":y=Math.pow(10,12)}return p(z,w,S,_,T,R,W)*y}}}}(function(p,g){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=p.replace(w,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(g.thousands),"([0-9])"),"g"),"$1$2")).replace(g.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),p=d.currentCurrency().symbol,g=d.currentOrdinal(),w=d.getZeroFormat(),S=d.currentAbbreviations(),_=void 0;if(typeof s=="string")_=function(T,R){if(!T.indexOf(":")||R.thousands===":")return!1;var W=T.split(":");if(W.length!==3)return!1;var z=+W[0],X=+W[1],K=+W[2];return!isNaN(z)&&!isNaN(X)&&!isNaN(K)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,p,g,w,S,u);else{if(typeof s!="number")return;_=s}if(_!==void 0)return _}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(p){if(Array.isArray(p)){for(var g=0,w=new Array(p.length);g<p.length;g++)w[g]=p[g];return w}}(v)||function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,p,g){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(_){if(!p[_])return console.error("".concat(g," Invalid key: ").concat(_)),!1;var T=v[_],R=p[_];if(typeof R=="string"&&(R={type:R}),R.type==="format"){if(!h(T,u,"[Validate ".concat(_,"]"),!0))return!1}else if(a(T)!==R.type)return console.error("".concat(g," ").concat(_,' type mismatched: "').concat(R.type,'" expected, "').concat(a(T),'" provided')),!1;if(R.restrictions&&R.restrictions.length)for(var W=R.restrictions.length,z=0;z<W;z++){var X=R.restrictions[z],K=X.restriction,q=X.message;if(!K(T,v))return console.error("".concat(g," ").concat(_," invalid value: ").concat(q)),!1}return R.restriction&&!R.restriction(T,v)?(console.error("".concat(g," ").concat(_," invalid value: ").concat(R.message)),!1):R.validValues&&R.validValues.indexOf(T)===-1?(console.error("".concat(g," ").concat(_," invalid value: must be among ").concat(JSON.stringify(R.validValues),', "').concat(T,'" provided')),!1):!(R.children&&!h(T,R.children,"[Validate ".concat(_,"]")))});return w||S.push.apply(S,i(Object.keys(p).map(function(_){var T=p[_];if(typeof T=="string"&&(T={type:T}),T.mandatory){var R=T.mandatory;if(typeof R=="function"&&(R=R(v)),R&&v[_]===void 0)return console.error("".concat(g,' Missing mandatory key "').concat(_,'"')),!1}return!0}))),S.reduce(function(_,T){return _&&T},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,p){var g=c(v),w=d(p);return g&&w},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(sRe);const Mi=$_;var uRe="numeric";function MP(e,t,r,n,o,i,a){var l=i;if(Ur(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!Mi.languages()[u]){var d=u.replace("-",""),v=Mi.allLanguages?Mi.allLanguages[u]:Mi[d];v&&Mi.registerLanguage(v)}Mi.setLanguage(u),l=Mi(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}_i(e,t,r,n,o,l,a)}MP.RENDERER_TYPE=uRe;var fRe="password";function xP(e,t,r,n,o,i,a){_i.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";Se(l-1,function(){u+=s}),Yd(t,u)}xP.RENDERER_TYPE=fRe;var cRe="time";function DP(e,t,r,n,o,i,a){_i.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}DP.RENDERER_TYPE=cRe;function hRe(){Yn(cf),Yn(nv),Yn(AP),Yn($P),Yn(MP),Yn(xP),Yn(_i),Yn(DP)}var dRe="autocomplete";function NP(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,FM(r,t)):FM(r,t)(this.source):t(!0)}NP.VALIDATOR_TYPE=dRe;function FM(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var vRe=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},yRe=Gt,pRe=Fm,mRe=Dt,gRe=dn,bRe=Rr,VM=vRe,WM=Vt,wRe=ja,SRe=Vm;pRe("search",function(e,t,r){return[function(o){var i=bRe(this),a=gRe(o)?void 0:wRe(o,e);return a?yRe(a,o,i):new RegExp(o)[e](WM(i))},function(n){var o=mRe(this),i=WM(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;VM(l,0)||(o.lastIndex=0);var s=SRe(o,i);return VM(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function CRe(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}var _Re="date";function ZW(e,t){var r=BF(KW,this.instance),n=e,o=!0;n==null&&(n="");var i=te(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=te(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=ORe(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}ZW.VALIDATOR_TYPE=_Re;function ORe(e,t){var r=te(CRe(e)),n=te(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var RRe="numeric";function QW(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:Ur(e))}QW.VALIDATOR_TYPE=RRe;var ERe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],PRe="time";function JW(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=te(o,ERe,!0).isValid()?te(o):te(o,r),l=a.isValid(),s=te(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}JW.VALIDATOR_TYPE=PRe;var TRe="autocomplete",kRe={CELL_TYPE:TRe,editor:YW,renderer:cf,validator:NP},$Re="checkbox",ARe={CELL_TYPE:$Re,editor:G_e,renderer:AP},IRe="date",MRe={CELL_TYPE:IRe,editor:iOe,renderer:cf,validator:ZW},xRe="dropdown",DRe={CELL_TYPE:xRe,editor:qW,renderer:cf,validator:NP},NRe="handsontable",HRe={CELL_TYPE:NRe,editor:zW,renderer:cf},LRe="numeric",jRe={CELL_TYPE:LRe,editor:POe,renderer:MP,validator:QW,dataType:"number"},BRe="password",FRe={CELL_TYPE:BRe,editor:jOe,renderer:xP,copyable:!1},VRe="time",WRe={CELL_TYPE:VRe,editor:ZOe,renderer:DP,validator:JW};function URe(){Rn(kRe),Rn(ARe),Rn(MRe),Rn(DRe),Rn(HRe),Rn(jRe),Rn(FRe),Rn(MW),Rn(WRe)}var zRe=Nm,GRe=$F;zRe("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},GRe);function Ah(e){return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}function YRe(e,t){return ZRe(e)||XRe(e,t)||qRe(e,t)||KRe()}function KRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qRe(e,t){if(e){if(typeof e=="string")return UM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UM(e,t)}}function UM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ZRe(e){if(Array.isArray(e))return e}function QRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eEe(n.key),n)}}function JRe(e,t,r){return t&&zM(e.prototype,t),r&&zM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eEe(e){var t=tEe(e,"string");return Ah(t)==="symbol"?t:String(t)}function tEe(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rEe(e,t){nEe(e,t),t.add(e)}function nEe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oEe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var GM=new Map([["plugin",Yle],["cell-type",_W],["editor",jF],["renderer",eV],["validator",tV]]),iEe="base",xi=new WeakMap,Cw=[],bn=null,YM=new WeakSet,ut=function(){function e(t){var r=this;QRe(this,e),rEe(this,YM),No(this,"hot",t,{writable:!1}),xi.set(this,{hooks:{}}),bn=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return JRe(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=YRe(f,2),h=c[0],d=c[1];if(!GM.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));GM.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");Cw.push(a)}}bn||(bn=JF()),bn.indexOf("UndoRedo")>=0&&bn.splice(bn.indexOf("UndoRedo"),1),bn.indexOf(this.pluginName)>=0&&bn.splice(bn.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=bn.length===0;if(l){if(Cw.length>0){var s=["".concat(Cw.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){xi.get(this).hooks[r]=xi.get(this).hooks[r]||[];var o=xi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),xi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;I(xi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=xi.get(this).hooks;Ye(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){I(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=oEe(this,YM,aEe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Ye(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return iEe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function aEe(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function Ih(e){return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ih(e)}function lEe(e,t){return cEe(e)||fEe(e,t)||uEe(e,t)||sEe()}function sEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uEe(e,t){if(e){if(typeof e=="string")return KM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KM(e,t)}}function KM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cEe(e){if(Array.isArray(e))return e}function hEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vEe(n.key),n)}}function dEe(e,t,r){return t&&qM(e.prototype,t),r&&qM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vEe(e){var t=yEe(e,"string");return Ih(t)==="symbol"?t:String(t)}function yEe(e,t){if(Ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pEe=function(){function e(t){hEe(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return dEe(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),I(this.rows,function(n){r(n.row,kt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),I(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){I(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){I(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){I(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),I(i,function(l){var s=lEe(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){I(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),re(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return re(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const e2=pEe;function Mh(e){return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}function mEe(e,t,r){return t=t2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t2(n.key),n)}}function bEe(e,t,r){return t&&XM(e.prototype,t),r&&XM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function t2(e){var t=wEe(e,"string");return Mh(t)==="symbol"?t:String(t)}function wEe(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SEe=function(){function e(t){gEe(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return bEe(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return Se(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return Se(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ue(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(jt(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var p=a.get(v);if(p.needed){var g=s.indexOf(c)>-1;(!g||i.allowDuplicates||d)&&(p.strings.push(mEe({value:c},l,u)),s.push(c),p.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const r2=SEe;function Us(e){return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function ZM(e,t){return REe(e)||OEe(e,t)||_Ee(e,t)||CEe()}function CEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ee(e,t){if(e){if(typeof e=="string")return QM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QM(e,t)}}function QM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function REe(e){if(Array.isArray(e))return e}function EEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TEe(n.key),n)}}function PEe(e,t,r){return t&&JM(e.prototype,t),r&&JM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TEe(e){var t=kEe(e,"string");return Us(t)==="symbol"?t:String(t)}function kEe(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yi(){return typeof Reflect<"u"&&Reflect.get?Yi=Reflect.get.bind():Yi=function(t,r,n){var o=$Ee(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Yi.apply(this,arguments)}function $Ee(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ro(e),e!==null););return e}function AEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A_(e,t)}function A_(e,t){return A_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},A_(e,t)}function IEe(e){var t=xEe();return function(){var n=ro(e),o;if(t){var i=ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MEe(this,o)}}function MEe(e,t){if(t&&(Us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n2(e)}function n2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ro(e){return ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ro(e)}me.getSingleton().register("modifyAutoColumnSizeSeed");var $f="autoColumnSize",DEe=10,_w=new WeakMap,NEe="autoColumnSize",HEe=function(e){AEe(r,e);var t=IEe(r);function r(n){var o;return EEe(this,r),o=t.call(this,n),_w.set(n2(o),{cachedColumnHeaders:[]}),o.ghostTable=new e2(o.hot),o.samplesGenerator=new r2(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Ci,o.hot.columnIndexMapper.registerMap(NEe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return PEe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[$f]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[$f];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),Yi(ro(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),Yi(ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;Yi(ro(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;Se(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);I(h,function(d){var v=ZM(d,2),p=v[0],g=v[1];return o.ghostTable.addColumn(p,g)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){fp(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=lE(c):(fp(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[$f],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[$f],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ue(o)&&(i=o.syncLimit,wF(i)?i=GF(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,HE.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=_w.get(this),a=i.cachedColumnHeaders,l=ir(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){I(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Yr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=We(o,function(l){var s=ZM(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){_w.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Yr(o,function(l){var s;return pe((s=l.address)===null||s===void 0?void 0:s.col)}),a=We(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Yi(ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $f}},{key:"PLUGIN_PRIORITY",get:function(){return DEe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(ut),Ki={horizontal:"horizontal",vertical:"vertical"};function LEe(e,t,r,n){var o=r.length,i=r?r[0].length:0,a=[],l=t.row-e.row,s=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<s;f++){var c=parseInt(r[0][f],10),h=parseInt(r[o-1][f],10),d=(n==="down"?h-c:c-h)/(o-1)||0;u.push(d)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<l;v++){var p=parseInt(r[v][0],10),g=parseInt(r[v][i-1],10),w=(n==="right"?g-p:p-g)/(i-1)||0;a.push([w])}return a}function jEe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function BEe(e){var t={};return e===!0?(t.directions=Object.keys(Ki),t.autoInsertRow=!0):Ue(e)?(pe(e.autoInsertRow)?e.direction===Ki.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,pe(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(Ki)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function zs(e){return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function FEe(e){return UEe(e)||WEe(e)||o2(e)||VEe()}function VEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UEe(e){if(Array.isArray(e))return I_(e)}function zEe(e,t){return KEe(e)||YEe(e,t)||o2(e,t)||GEe()}function GEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o2(e,t){if(e){if(typeof e=="string")return I_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I_(e,t)}}function I_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function KEe(e){if(Array.isArray(e))return e}function qEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ex(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZEe(n.key),n)}}function XEe(e,t,r){return t&&ex(e.prototype,t),r&&ex(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZEe(e){var t=QEe(e,"string");return zs(t)==="symbol"?t:String(t)}function QEe(e,t){if(zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qi(){return typeof Reflect<"u"&&Reflect.get?qi=Reflect.get.bind():qi=function(t,r,n){var o=JEe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},qi.apply(this,arguments)}function JEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=no(e),e!==null););return e}function e0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M_(e,t)}function M_(e,t){return M_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},M_(e,t)}function t0e(e){var t=n0e();return function(){var n=no(e),o;if(t){var i=no(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return r0e(this,o)}}function r0e(e,t){if(t&&(zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return i2(e)}function i2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function no(e){return no=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},no(e)}me.getSingleton().register("modifyAutofillRange");me.getSingleton().register("beforeAutofill");me.getSingleton().register("afterAutofill");var tx="autofill",o0e=20,i0e=["fillHandle"],a0e="insert_row_below",l0e=200,s0e=function(e){e0e(r,e);var t=t0e(r);function r(n){var o;return qEe(this,r),o=t.call(this,n),o.eventManager=new At(i2(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return XEe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),qi(no(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),qi(no(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),qi(no(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],p=[];return I(h,function(g){for(var w=g.startRow;w<=g.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var S=g.startCol;S<=g.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),I(d,function(g){var w=[];I(v,function(S){w.push(o.hot.getCopyableData(g,S))}),p.push(w)}),p}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=zEe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],p=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),g=jEe(v,p,function(k,y){return o.hot._createCellCoords(k,y)}),w=g.directionOfDrag,S=g.startOfDragCoords,_=g.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var T=this.getSelectionData(),R=c.clone(),W=this.hot._createCellRange(S,S,_),z=this.hot.runHooks("beforeAutofill",T,R,W,w);if(z===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var X=LEe(S,_,T,w),K=z,q=z;if(["up","left"].indexOf(w)>-1&&!(q.length===1&&q[0].length===0))if(K=[],w==="up")for(var Q=_.row-S.row+1,ae=Q%q.length,Z=0;Z<Q;Z++)K.push(q[(Z+(q.length-ae))%q.length]);else for(var fe=_.col-S.col+1,Oe=fe%q[0].length,be=0;be<q.length;be++){K.push([]);for(var Ce=0;Ce<fe;Ce++)K[be].push(q[be][(Ce+(q[be].length-Oe))%q[be].length])}this.hot.populateFromArray(S.row,S.col,K,_.row,_.col,"".concat(this.pluginName,".fill"),null,w,X),this.setSelection(p),this.hot.runHooks("afterAutofill",K,R,W,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(Ki.vertical)&&this.directions.includes(Ki.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(Ki.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(Ki.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(a0e,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},l0e)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,FEe(We(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Ut(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+kt(this.hot.table),l=Ut(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+vt(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=BEe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){qi(no(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tx}},{key:"PLUGIN_PRIORITY",get:function(){return o0e}},{key:"SETTING_KEYS",get:function(){return[tx].concat(i0e)}}]),r}(ut);function Gs(e){return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function u0e(e,t){return d0e(e)||h0e(e,t)||c0e(e,t)||f0e()}function f0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c0e(e,t){if(e){if(typeof e=="string")return rx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rx(e,t)}}function rx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function d0e(e){if(Array.isArray(e))return e}function v0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p0e(n.key),n)}}function y0e(e,t,r){return t&&nx(e.prototype,t),r&&nx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p0e(e){var t=m0e(e,"string");return Gs(t)==="symbol"?t:String(t)}function m0e(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ll(){return typeof Reflect<"u"&&Reflect.get?Ll=Reflect.get.bind():Ll=function(t,r,n){var o=g0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ll.apply(this,arguments)}function g0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ai(e),e!==null););return e}function b0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x_(e,t)}function x_(e,t){return x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},x_(e,t)}function w0e(e){var t=_0e();return function(){var n=ai(e),o;if(t){var i=ai(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return S0e(this,o)}}function S0e(e,t){if(t&&(Gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C0e(e)}function C0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ai(e){return ai=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ai(e)}var zv="autoRowSize",O0e=40,R0e="autoRowSize",E0e=function(e){b0e(r,e);var t=w0e(r);function r(n){var o;return v0e(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new e2(o.hot),o.samplesGenerator=new r2(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Ci,o.hot.rowIndexMapper.registerMap(R0e,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return y0e(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[zv];return o===!0||Ue(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),Ll(ai(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,Ll(ai(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}Se(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);I(h,function(d){var v=u0e(d,2),p=v[0],g=v[1];return o.ghostTable.addRow(p,g)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){fp(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=lE(c):(fp(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[zv],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){gc(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[zv],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ue(o)&&(i=o.syncLimit,wF(i)?i=GF(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){Se(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Yr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),Ll(ai(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zv}},{key:"PLUGIN_PRIORITY",get:function(){return O0e}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(ut);function Ys(e){return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function P0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ox(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k0e(n.key),n)}}function T0e(e,t,r){return t&&ox(e.prototype,t),r&&ox(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k0e(e){var t=$0e(e,"string");return Ys(t)==="symbol"?t:String(t)}function $0e(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ic(){return typeof Reflect<"u"&&Reflect.get?ic=Reflect.get.bind():ic=function(t,r,n){var o=A0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ic.apply(this,arguments)}function A0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xa(e),e!==null););return e}function I0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D_(e,t)}function D_(e,t){return D_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},D_(e,t)}function M0e(e){var t=N0e();return function(){var n=xa(e),o;if(t){var i=xa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return x0e(this,o)}}function x0e(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D0e(e)}function D0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xa(e){return xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xa(e)}var a2=JV("physicallyIndexed"),H0e=a2.getListWithInsertedItems,L0e=a2.getListWithRemovedItems,j0e=function(e){I0e(r,e);var t=M0e(r);function r(){return P0e(this,r),t.call(this,function(n){return n})}return T0e(r,[{key:"insert",value:function(o,i){var a=e0(this.indexedValues,i);this.indexedValues=H0e(a,o,i,this.initValueOrFn),ic(xa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=L0e(this.indexedValues,o);this.indexedValues=JE(i,o),ic(xa(r.prototype),"remove",this).call(this,o)}}]),r}(Ga);const B0e=j0e;function Ks(e){return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function F0e(e){return z0e(e)||U0e(e)||W0e(e)||V0e()}function V0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W0e(e,t){if(e){if(typeof e=="string")return N_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N_(e,t)}}function U0e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function z0e(e){if(Array.isArray(e))return N_(e)}function N_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function G0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K0e(n.key),n)}}function Y0e(e,t,r){return t&&ix(e.prototype,t),r&&ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K0e(e){var t=q0e(e,"string");return Ks(t)==="symbol"?t:String(t)}function q0e(e,t){if(Ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ac(){return typeof Reflect<"u"&&Reflect.get?ac=Reflect.get.bind():ac=function(t,r,n){var o=X0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ac.apply(this,arguments)}function X0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Da(e),e!==null););return e}function Z0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H_(e,t)}function H_(e,t){return H_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},H_(e,t)}function Q0e(e){var t=tPe();return function(){var n=Da(e),o;if(t){var i=Da(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return J0e(this,o)}}function J0e(e,t){if(t&&(Ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ePe(e)}function ePe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Da(e){return Da=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Da(e)}var l2=JV("physicallyIndexed"),rPe=l2.getListWithInsertedItems,nPe=l2.getListWithRemovedItems,oPe=function(e){Z0e(r,e);var t=Q0e(r);function r(){return G0e(this,r),t.call(this,function(n){return n})}return Y0e(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=rPe(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),ac(Da(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=nPe(this.indexedValues,o),ac(Da(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,F0e(this.getValues()))+1+o}}]),r}(Ga);const iPe=oPe;function qs(e){return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function aPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ax(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sPe(n.key),n)}}function lPe(e,t,r){return t&&ax(e.prototype,t),r&&ax(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sPe(e){var t=uPe(e,"string");return qs(t)==="symbol"?t:String(t)}function uPe(e,t){if(qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jl(){return typeof Reflect<"u"&&Reflect.get?jl=Reflect.get.bind():jl=function(t,r,n){var o=fPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jl.apply(this,arguments)}function fPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=li(e),e!==null););return e}function cPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L_(e,t)}function L_(e,t){return L_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},L_(e,t)}function hPe(e){var t=yPe();return function(){var n=li(e),o;if(t){var i=li(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dPe(this,o)}}function dPe(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vPe(e)}function vPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function li(e){return li=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},li(e)}var Ow="bindRowsWithHeaders",pPe=210,mPe="loose",gPe=new Map([["loose",B0e],["strict",iPe]]),bPe=function(e){cPe(r,e);var t=hPe(r);function r(n){var o;return aPe(this,r),o=t.call(this,n),o.headerIndexes=null,o}return lPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ow]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Ow];typeof i!="string"&&(i=mPe);var a=gPe.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),jl(li(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),jl(li(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){jl(li(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ow}},{key:"PLUGIN_PRIORITY",get:function(){return pPe}}]),r}(ut);function Xs(e){return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function lx(e){return _Pe(e)||CPe(e)||SPe(e)||wPe()}function wPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SPe(e,t){if(e){if(typeof e=="string")return j_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j_(e,t)}}function CPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Pe(e){if(Array.isArray(e))return j_(e)}function j_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s2(n.key),n)}}function RPe(e,t,r){return t&&sx(e.prototype,t),r&&sx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xi(){return typeof Reflect<"u"&&Reflect.get?Xi=Reflect.get.bind():Xi=function(t,r,n){var o=EPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Xi.apply(this,arguments)}function EPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=oo(e),e!==null););return e}function PPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B_(e,t)}function B_(e,t){return B_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},B_(e,t)}function TPe(e){var t=$Pe();return function(){var n=oo(e),o;if(t){var i=oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kPe(this,o)}}function kPe(e,t){if(t&&(Xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tl(e)}function Tl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Pe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oo(e){return oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oo(e)}function APe(e,t,r){IPe(e,t),t.set(e,r)}function IPe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rw(e,t,r){return t=s2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s2(e){var t=MPe(e,"string");return Xs(t)==="symbol"?t:String(t)}function MPe(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ux(e,t){var r=u2(e,t,"get");return xPe(e,r)}function xPe(e,t){return t.get?t.get.call(e):t.value}function Ew(e,t,r){var n=u2(e,t,"set");return DPe(e,n,r),r}function u2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function DPe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Pw="collapsibleColumns",NPe=290,HPe=["nestedHeaders"],al="collapsibleIndicator",fx=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),ll=new WeakMap,LPe=function(e){PPe(r,e);var t=TPe(r);function r(){var n;OPe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Rw(Tl(n),"nestedHeadersPlugin",null),Rw(Tl(n),"eventManager",new At(Tl(n))),Rw(Tl(n),"headerStateManager",null),APe(Tl(n),ll,{writable:!0,value:null}),n}return RPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Pw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||dt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Ew(this,ll,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),Xi(oo(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}Xi(oo(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ew(this,ll,null),this.nestedHeadersPlugin=null,this.clearButtons(),Xi(oo(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};Se(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;Se(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(al));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(al)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(al)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!fx.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=Yr(o,function(g){var w=g.row;return w<0}),s=l.length>0;I(l,function(g){var w,S=g.row,_=g.col,T=(w=a.headerStateManager.getHeaderSettings(S,_))!==null&&w!==void 0?w:{},R=T.collapsible,W=T.isCollapsed;if(!R||W&&i==="collapse"||!W&&i==="expand")return s=!1,!1});var u=[],f=[];s&&I(l,function(g){var w=g.row,S=g.col,_=a.headerStateManager.triggerNodeModification(i,w,S),T=_.colspanCompensation,R=_.affectedColumns,W=_.rollbackModification;T>0&&(f.push.apply(f,lx(R)),u.push(W))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=bB([].concat(lx(c),f)):i==="expand"&&(h=Yr(c,function(g){return!f.includes(g)}));var d=fx.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){I(u,function(g){g()});return}this.hot.batchExecution(function(){I(f,function(g){ux(a,ll).setValueAtIndex(a.hot.toPhysicalColumn(g),d.hideColumn)})},!0);var p=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,p),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return ux(this,ll).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(al));if(h)d||(d=this.hot.rootDocument.createElement("div"),re(d,al),i.querySelector("div:first-child").appendChild(d)),He(d,["collapsed","expanded"]),c?(re(d,"collapsed"),Ra(d,"+")):(re(d,"expanded"),Ra(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){Ne(o.target,al)&&(Ne(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):Ne(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),Mn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Ew(this,ll,null),Xi(oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Pw}},{key:"PLUGIN_PRIORITY",get:function(){return NPe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Pw].concat(HPe)}}]),r}(ut);function xh(e){return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}function cx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function jPe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cx(Object(r),!0).forEach(function(n){BPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BPe(e,t,r){return t=f2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hx(e,t){return UPe(e)||WPe(e,t)||VPe(e,t)||FPe()}function FPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VPe(e,t){if(e){if(typeof e=="string")return dx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dx(e,t)}}function dx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WPe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function UPe(e){if(Array.isArray(e))return e}function zPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f2(n.key),n)}}function GPe(e,t,r){return t&&vx(e.prototype,t),r&&vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f2(e){var t=YPe(e,"string");return xh(t)==="symbol"?t:String(t)}function YPe(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KPe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],qPe=!1,XPe=!0,ZPe=!0,QPe=function(){function e(t,r){zPe(this,e),this.hot=t,this.sortingStates=new sg,this.sortEmptyCells=qPe,this.indicator=XPe,this.headerAction=ZPe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return GPe(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ue(r)&&Ye(r,function(o,i){KPe.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=hx(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ue(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=hx(o,2),a=i[0],l=i[1];return jPe({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(pe(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),am="asc",lm="desc",JPe="colHeader";function eTe(e){if(Ue(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[am,lm].includes(r)}function tTe(e){if(e.some(function(r){return eTe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function yx(e){if(e!==lm)return e===am?lm:am}function px(e){var t=e.querySelector(".".concat(JPe));return t}function mx(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function F_(e,t,r){return e===-1&&t>=0&&Pa(r)===!1}var rTe="ascending",nTe="descending",c2="indicatorDisabled",h2="columnSorting",d2="sortAction",v2=new Map([[am,rTe],[lm,nTe]]);function oTe(e,t,r,n){var o=[h2];if(n&&o.push(d2),r===!1)return o.push(c2),o;var i=e.getSortOrderOfColumn(t);return pe(i)&&o.push(v2.get(i)),o}function iTe(){return Array.from(v2.values()).concat(d2,c2,h2)}function y2(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?An:qt(o)?qt(i)?An:a&&e==="asc"?Pt:Tt:qt(i)?a&&e==="asc"?Tt:Pt:isNaN(o)&&!isNaN(i)?e==="asc"?Tt:Pt:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?Pt:Tt:o>i?e==="asc"?Tt:Pt:An}}var p2="default";function aTe(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return An;if(l){if(qt(n))return e==="asc"?Pt:Tt;if(qt(o))return e==="asc"?Tt:Pt}return isNaN(i)?Tt:isNaN(a)?Pt:i<a?e==="asc"?Pt:Tt:i>a?e==="asc"?Tt:Pt:An}}var lTe="numeric";function sTe(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=qt(a),u=qt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return Tt;if(s===!1&&u)return Pt}return h===!1&&d?e==="asc"?Pt:Tt:h&&d===!1?e==="asc"?Tt:Pt:h===!1&&d===!1?y2(e,t,r)(a,l):f===o&&c===n?e==="asc"?Pt:Tt:f===n&&c===o?e==="asc"?Tt:Pt:An}}var uTe="checkbox";function fTe(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return An;if(qt(n))return qt(o)?An:i&&e==="asc"?Pt:Tt;if(qt(o))return i&&e==="asc"?Tt:Pt;var a=t.dateFormat,l=te(n,a),s=te(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?Pt:Tt:s.isBefore(l)?e==="asc"?Tt:Pt:An:Pt:Tt}}var cTe="date",HP=Jr("sorting.compareFunctionFactory"),Tg=HP.register,gx=HP.getItem,hTe=HP.hasItem,m2=Jr("sorting.mainSortComparator"),g2=m2.register,dTe=m2.getItem;function b2(e){return hTe(e)?gx(e):gx(p2)}Tg(lTe,aTe);Tg(uTe,sTe);Tg(cTe,fTe);Tg(p2,y2);var An=0,Pt=-1,Tt=1;function vTe(e,t){for(var r=dTe(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function bx(e){return gTe(e)||mTe(e)||pTe(e)||yTe()}function yTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pTe(e,t){if(e){if(typeof e=="string")return wx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wx(e,t)}}function wx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gTe(e){if(Array.isArray(e))return e}function bTe(e,t){return function(r,n){var o=bx(r),i=o.slice(1),a=bx(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,p=v.compareFunctionFactory?v.compareFunctionFactory:b2(c.type),g=p(f,c,v)(h,d);return g}(0)}}function Zs(e){return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}var wTe=["column"],STe=["column"];function sl(e){return RTe(e)||OTe(e)||_Te(e)||CTe()}function CTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Te(e,t){if(e){if(typeof e=="string")return V_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V_(e,t)}}function OTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RTe(e){if(Array.isArray(e))return V_(e)}function V_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Cx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sx(Object(r),!0).forEach(function(n){ETe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ETe(e,t,r){return t=w2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _x(e,t){if(e==null)return{};var r=PTe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function PTe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function TTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ox(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w2(n.key),n)}}function kTe(e,t,r){return t&&Ox(e.prototype,t),r&&Ox(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w2(e){var t=$Te(e,"string");return Zs(t)==="symbol"?t:String(t)}function $Te(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zi(){return typeof Reflect<"u"&&Reflect.get?Zi=Reflect.get.bind():Zi=function(t,r,n){var o=ATe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Zi.apply(this,arguments)}function ATe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=io(e),e!==null););return e}function ITe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W_(e,t)}function W_(e,t){return W_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},W_(e,t)}function MTe(e){var t=NTe();return function(){var n=io(e),o;if(t){var i=io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xTe(this,o)}}function xTe(e,t){if(t&&(Zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DTe(e)}function DTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function io(e){return io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},io(e)}var U_="columnSorting",HTe=50,Rx="append",LTe="replace";g2(U_,bTe);me.getSingleton().register("beforeColumnSort");me.getSingleton().register("afterColumnSort");var S2=function(e){ITe(r,e);var t=MTe(r);function r(n){var o;return TTe(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=U_,o.indexesSequenceCache=null,o}return kTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new QPe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Ci(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),Zi(io(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=px(s);mx(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Zi(io(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new eW),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return pe(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return tTe(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=_x(u,wTe);return Cx({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=We(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=_x(u,STe);return Cx({column:o.hot.toVisualColumn(f)},c)};return pe(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=We(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(pe(i)){var a=yx(i);return pe(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:yx()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rx,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(mt(u))return[].concat(sl(s.slice(0,a)),sl(s.slice(a+1)));if(i===Rx)return[].concat(sl(s.slice(0,a)),sl(s.slice(a+1)),[u]);if(i===LTe)return[].concat(sl(s.slice(0,a)),[u],sl(s.slice(a+1)))}return pe(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ue(o)){var i=o[this.pluginKey];if(Ue(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):wt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(g){return We(o,function(w){return i.hot.getDataAtCell(g,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=We(a,function(p){return p[0]});vTe(a,this.pluginKey,We(o,function(p){return p.sortOrder}),We(o,function(p){return i.getFirstCellSettings(p.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=We(a,function(p){return p[0]}),d=new Map(We(f,function(p,g){return[p,h[g]]})),v=We(this.hot.rowIndexMapper.getIndexesSequence(),function(p){return d.has(p)?d.get(p):p});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ue(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ue(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ue(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=px(i);if(!(mx(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(He(o,iTe()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];re(o,oTe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){Zi(io(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),pe(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){F_(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){F_(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),Zi(io(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return U_}},{key:"PLUGIN_PRIORITY",get:function(){return HTe}}]),r}(ut),jTe=Ae,LP=Be,BTe=wi,FTe=Lj,VTe=EB,Ex=je,WTe=RangeError,C2=String,_2=Math.floor,z_=LP(VTe),Px=LP("".slice),Af=LP(1 .toFixed),Il=function(e,t,r){return t===0?r:t%2===1?Il(e,t-1,r*e):Il(e*e,t/2,r)},UTe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},ul=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=_2(o/1e7)},Tw=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=_2(n/t),n=n%t*1e7},Tx=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=C2(e[t]);r=r===""?n:r+z_("0",7-n.length)+n}return r},zTe=Ex(function(){return Af(8e-5,3)!=="0.000"||Af(.9,0)!=="1"||Af(1.255,2)!=="1.25"||Af(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!Ex(function(){Af({})});jTe({target:"Number",proto:!0,forced:zTe},{toFixed:function(t){var r=FTe(this),n=BTe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw WTe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return C2(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=UTe(r*Il(2,69,1))-69,s=l<0?r*Il(2,-l,1):r/Il(2,l,1),s*=4503599627370496,l=52-l,l>0){for(ul(o,0,s),u=n;u>=7;)ul(o,1e7,0),u-=7;for(ul(o,Il(10,u,1),0),u=l-1;u>=23;)Tw(o,1<<23),u-=23;Tw(o,1<<u),ul(o,1,1),Tw(o,2),a=Tx(o)}else ul(o,0,s),ul(o,1<<-l,0),a=Tx(o)+z_("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+z_("0",n-f)+a:Px(a,0,f-n)+"."+Px(a,f-n))):a=i+a,a}});function Dh(e){return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(e)}function GTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KTe(n.key),n)}}function YTe(e,t,r){return t&&kx(e.prototype,t),r&&kx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KTe(e){var t=qTe(e,"string");return Dh(t)==="symbol"?t:String(t)}function qTe(e,t){if(Dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XTe=function(){function e(t,r){GTe(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return YTe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),I(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();I(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function p(){return l.hot.removeHook("beforeViewRender",p),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;I(h,function(p){f==="row"&&p.destinationRow>=v&&(p.alterRowOffset=c*o),f==="col"&&p.destinationColumn>=v&&(p.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?I(h,function(p){l.extendEndpointRanges(p,v,i[0],i.length),l.recreatePhysicalRanges(p),l.clearOffsetInformation(p)}):I(h,function(p){l.shiftEndpointCoordinates(p,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){I(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];I(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),I(a,function(l){var s=[];I(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,I(r.ranges,function(o){I(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],I(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],I(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],I(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&I(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),I(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){dt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const ZTe=XTe;function kw(e){return e==null||isNaN(e)}function Qs(e){return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}var $x;function QTe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function JTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ax(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tke(n.key),n)}}function eke(e,t,r){return t&&Ax(e.prototype,t),r&&Ax(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tke(e){var t=rke(e,"string");return Qs(t)==="symbol"?t:String(t)}function rke(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wy(){return typeof Reflect<"u"&&Reflect.get?Wy=Reflect.get.bind():Wy=function(t,r,n){var o=nke(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Wy.apply(this,arguments)}function nke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Js(e),e!==null););return e}function oke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G_(e,t)}function G_(e,t){return G_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},G_(e,t)}function ike(e){var t=ske();return function(){var n=Js(e),o;if(t){var i=Js(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ake(this,o)}}function ake(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lke(e)}function lke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ske(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Js(e){return Js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Js(e)}var $w="columnSummary",uke=220,fke=function(e){oke(r,e);var t=ike(r);function r(n){var o;return JTe(this,r),o=t.call(this,n),o.endpoints=null,o}return eke(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$w]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[$w],this.endpoints=new ZTe(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),Wy(Js(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return Ye(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=kw(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return Ye(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=kw(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=kw(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return Ye(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ct($x||($x=QTe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return $w}},{key:"PLUGIN_PRIORITY",get:function(){return uke}}]),r}(ut);function Nh(e){return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}function cke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dke(n.key),n)}}function hke(e,t,r){return t&&Ix(e.prototype,t),r&&Ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dke(e){var t=vke(e,"string");return Nh(t)==="symbol"?t:String(t)}function vke(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yke=function(){function e(t,r){cke(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return hke(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:vt(this.getInputElement()),height:kt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),re(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),re(r,e.CLASS_EDITOR),re(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const pke=yke;var Ve="---------";function mke(){return{name:Ve}}function gke(e){return We(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function Gv(e){return Ne(e,"htSeparator")}function bke(e){return Ne(e,"htSubmenu")}function Yv(e){return Ne(e,"htDisabled")}function Kv(e){return Ne(e,"htSelectionDisabled")}function Ya(e){var t=e.getSelected();return!t||t[0]<0?null:t}function wke(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function Ske(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Di(e,t){var r={};return I(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function qo(e,t,r,n,o){I(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&Cke(a,l,t,r,n,o)})})}function Cke(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=wke(a.className,n):l=Ske(a.className,n)),i(e,t,"className",l)}function Pn(e,t){var r=!1;return Array.isArray(e)&&I(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function Xn(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function _ke(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function O2(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function Oke(e,t){var r=e.slice(0);return r.reverse(),r=O2(r,t),r.reverse(),r}function Rke(e){var t=[];return I(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function Eke(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ve,r=e.slice(0);return r=O2(r,t),r=Oke(r,t),r=Rke(r),r}function Hh(e){return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function Pke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kke(n.key),n)}}function Tke(e,t,r){return t&&Mx(e.prototype,t),r&&Mx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kke(e){var t=$ke(e,"string");return Hh(t)==="symbol"?t:String(t)}function $ke(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ake=250,Ike=250,R2=function(){function e(t){Pke(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return Tke(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},Ike)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ake;this.showDebounced=RF(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();bt(R2,Pr);const Mke=R2;function eu(e){return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(e)}function Aw(e,t,r){return t=E2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E2(n.key),n)}}function Dke(e,t,r){return t&&xx(e.prototype,t),r&&xx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function E2(e){var t=Nke(e,"string");return eu(t)==="symbol"?t:String(t)}function Nke(e,t){if(eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qi(){return typeof Reflect<"u"&&Reflect.get?Qi=Reflect.get.bind():Qi=function(t,r,n){var o=Hke(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Qi.apply(this,arguments)}function Hke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ao(e),e!==null););return e}function Lke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y_(e,t)}function Y_(e,t){return Y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Y_(e,t)}function jke(e){var t=Fke();return function(){var n=ao(e),o;if(t){var i=ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bke(this,o)}}function Bke(e,t){if(t&&(eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P2(e)}function P2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ao(e){return ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ao(e)}var Iw="comments",Vke=60,qv=new WeakMap,wn="comment",fl="value",Dx="style",Xv="readOnly",Wke=function(e){Lke(r,e);var t=jke(r);function r(n){var o;return xke(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,qv.set(P2(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return Dke(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Iw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new pke(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new At(this)),this.displaySwitch||(this.displaySwitch=new Mke(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),Qi(ao(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Qi(ao(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Qi(ao(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=Sa(o.target,"TD","TBODY");return!!(i&&Ne(i,"htCommentCell")&&Sa(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,Aw({},fl,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,wn),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,fl)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,fl)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[wn]?l[wn][fl]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),p=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var g=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,_=S.rootWindow,T=S.view._wt,R=T.wtTable,W=T.getCell({row:d,col:v},!0),z=this.getCommentMeta(c,h,Dx);z?this.editor.setSize(z.width,z.height):this.editor.resetSize();var X=w?0:R.getStretchedColumnWidth(v),K=p&&!g?kt(W):0,q=W.getBoundingClientRect(),Q=q.left,ae=q.top,Z=q.width,fe=q.height,Oe=this.editor.getSize(),be=Oe.width,Ce=Oe.height,k=this.hot.rootWindow,y=k.innerWidth,m=k.innerHeight,b=this.hot.rootDocument.documentElement,O=Q+_.scrollX+X,P=ae+_.scrollY+K;this.hot.isRtl()&&(O-=be+X),this.hot.isLtr()&&Q+Z+be>y?O=Q+_.scrollX-be-1:this.hot.isRtl()&&O<-(b.scrollWidth-b.clientWidth)&&(O=Q+_.scrollX+X+1),ae+Ce>m&&(P-=Ce-fe+1),this.editor.setPosition(O,P),this.editor.setReadOnlyState(this.getCommentMeta(c,h,Xv))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,fl)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[wn],s;l?(s=yr(l),Um(s,a)):s=a,this.hot.setCellMeta(o,i,wn,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[wn])return l[wn][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=Sa(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=qv.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Ne(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else Ca(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[wn]&&i[wn][fl]&&re(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=qv.get(this);i.tempEditorDimensions={width:vt(o.target),height:kt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=qv.get(this),a=vt(o.target),l=kt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Aw({},Dx,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,Xv);o.updateCommentMeta(a,l,Aw({},Xv,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(_0):i.hot.getTranslatedPhrase(C0)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(O0)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(R0),f=Pn(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[wn];if(d&&(d=d[Xv]),d)return!0});return f&&(u=Xn(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[Iw];if(Ue(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Qi(ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Iw}},{key:"PLUGIN_PRIORITY",get:function(){return Vke}}]),r}(ut);function Lh(e){return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function Uke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gke(n.key),n)}}function zke(e,t,r){return t&&Nx(e.prototype,t),r&&Nx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gke(e){var t=Yke(e,"string");return Lh(t)==="symbol"?t:String(t)}function Yke(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kke=function(){function e(t){Uke(this,e),this.hot=t,this.commands={},this.commonCallback=null}return zke(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=qke(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!xt(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),I(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function qke(e,t){var r;return I(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const T2=Kke;var Vr="alignment";function Xke(){return{key:Vr,name:function(){return this.getTranslatedPhrase(E0)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Vr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(P0),n=Pn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=Xn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Di(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),qo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Vr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(T0),n=Pn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=Xn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Di(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),qo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Vr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(k0),n=Pn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=Xn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Di(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),qo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Vr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase($0),n=Pn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=Xn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Di(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),qo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:Ve},{key:"".concat(Vr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(A0),n=Pn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=Xn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Di(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),qo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Vr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(I0),n=Pn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=Xn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Di(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),qo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Vr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(M0),n=Pn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=Xn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Di(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),qo(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var kg="clear_column";function Zke(){return{key:kg,name:function(){return this.getTranslatedPhrase(h0)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=Ya(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var ov="col_left";function Qke(){return{key:ov,name:function(){return this.getTranslatedPhrase(i0)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Ya(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var iv="col_right";function Jke(){return{key:iv,name:function(){return this.getTranslatedPhrase(a0)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Ya(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var av="make_read_only";function e$e(){return{key:av,name:function(){var t=this,r=this.getTranslatedPhrase(c0),n=Pn(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=Xn(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Pn(r,function(o,i){return t.getCellMeta(o,i).readOnly});I(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var $g="redo";function t$e(){return{key:$g,name:function(){return this.getTranslatedPhrase(f0)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function r$e(e,t){return a$e(e)||i$e(e,t)||o$e(e,t)||n$e()}function n$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o$e(e,t){if(e){if(typeof e=="string")return Hx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hx(e,t)}}function Hx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function a$e(e){if(Array.isArray(e))return e}var lv="remove_col";function l$e(){return{key:lv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=r$e(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(s0,r)},callback:function(){this.alter("remove_col",Nbe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Ya(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function s$e(e,t){return h$e(e)||c$e(e,t)||f$e(e,t)||u$e()}function u$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f$e(e,t){if(e){if(typeof e=="string")return Lx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lx(e,t)}}function Lx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function h$e(e){if(Array.isArray(e))return e}var Ag="remove_row";function d$e(){return{key:Ag,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=s$e(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(l0,r)},callback:function(){this.alter("remove_row",Hbe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=Ya(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var Ig="row_above";function v$e(){return{key:Ig,name:function(){return this.getTranslatedPhrase(n0)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=Ya(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var Mg="row_below";function y$e(){return{key:Mg,name:function(){return this.getTranslatedPhrase(o0)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=Ya(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var jh="no_items";function p$e(){return{key:jh,name:function(){return this.getTranslatedPhrase(r0)},disabled:!0,isCommand:!1}}var xg="undo";function m$e(){return{key:xg,name:function(){return this.getTranslatedPhrase(u0)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Bh(e){return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(e)}var ur;function Tr(e,t,r){return t=g$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g$e(e){var t=b$e(e,"string");return Bh(t)==="symbol"?t:String(t)}function b$e(e,t){if(Bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w$e=[Ig,Mg,ov,iv,kg,Ag,lv,xg,$g,av,Vr,Ve,jh],S$e=(ur={},Tr(ur,Ve,mke),Tr(ur,jh,p$e),Tr(ur,Ig,v$e),Tr(ur,Mg,y$e),Tr(ur,ov,Qke),Tr(ur,iv,Jke),Tr(ur,kg,Zke),Tr(ur,Ag,d$e),Tr(ur,lv,l$e),Tr(ur,xg,m$e),Tr(ur,$g,t$e),Tr(ur,av,e$e),Tr(ur,Vr,Xke),ur);function k2(){var e={};return Ye(S$e,function(t,r){e[r]=t()}),e}function Fh(e){return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function C$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O$e(n.key),n)}}function _$e(e,t,r){return t&&jx(e.prototype,t),r&&jx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O$e(e){var t=R$e(e,"string");return Fh(t)==="symbol"?t:String(t)}function R$e(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E$e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;C$e(this,e),this.hot=t,this.predefinedItems=k2(),this.defaultOrderPattern=r}return _$e(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,Ye(r,function(i,a){var l="";i.name===Ve?(o[Ve]=i,l=Ve):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return P$e(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function P$e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ue(o)?Ye(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ue(i)?zt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):I(o,function(i,a){var l=r[i];!l&&w$e.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ue(i)&&zt(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const $2=E$e;function Vh(e){return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}function T$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$$e(n.key),n)}}function k$e(e,t,r){return t&&Bx(e.prototype,t),r&&Bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $$e(e){var t=A$e(e,"string");return Vh(t)==="symbol"?t:String(t)}function A$e(e,t){if(Vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I$e=function(){function e(t,r){T$e(this,e);var n=bc(r),o=Xl(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return k$e(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const M$e=I$e;function Wh(e){return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}function Fx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Vx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fx(Object(r),!0).forEach(function(n){x$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x$e(e,t,r){return t=A2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A2(n.key),n)}}function N$e(e,t,r){return t&&Wx(e.prototype,t),r&&Wx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A2(e){var t=H$e(e,"string");return Wh(t)==="symbol"?t:String(t)}function H$e(e,t){if(Wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ux=215,I2="menu",L$e=I2,M2=function(){function e(t,r){D$e(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Ux,container:this.hot.rootDocument.documentElement},this.eventManager=new At(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return N$e(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=bp(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=RF(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||Ux,i=!1,a=Yr(this.menuItems,function(d){return d.key===jh&&(i=!0),_ke(d,r.hot)});if(a.length<1&&!i)a.push(k2()[jh]);else if(a.length===0)return;a=Eke(a,Ve);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return pe(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,p,g,w,S,_){return r.menuItemRenderer(v,p,g,w,S,_)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,p){r.isAllSubMenusClosed()?n(p.row):r.openSubMenu(p.row)},rowHeights:function(v){return a[v].name===Ve?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),j$()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!j$()||!Pa(v))&&l&&r.hasSelectedItem()&&($n()||_B()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new RP(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(L$e),c={group:I2},h=Vx(Vx({},c),{},{runOnlyIf:function(v){return Cp(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var p=r.openSubMenu(v[0]);p&&p.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(p[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!bke(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;I(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?gke(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===Ve||l===!0||a}},{key:"setPosition",value:function(r){var n=new M$e(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);Gv(r)||Yv(r)||Kv(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);Gv(n)||Yv(n)||Kv(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(Gv(i)||Yv(i)||Kv(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(Gv(i)||Yv(i)||Kv(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(w){return xt(w,"submenu")},h=function(w){return new RegExp(Ve,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},p=l;typeof p=="function"&&(p=p.call(this.hot)),Io(n),re(f,"htItemWrapper"),n.appendChild(f),h(u)?re(n,"htSeparator"):typeof u.renderer=="function"?(re(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,p))):Yd(f,p),d(u)?(re(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(re(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(re(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(He(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(wt(o)&&(o=o.call(this.hot),o===null||mt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),re(i,"htMenu ".concat(this.options.className)),o&&re(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=ir(n,function(s,u){return s+(u.name===Ve?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ca(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ca(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&Ne(r.target,"htCore")&&Ca(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();bt(M2,Pr);const jP=M2;function tu(e){return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function j$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F$e(n.key),n)}}function B$e(e,t,r){return t&&zx(e.prototype,t),r&&zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function F$e(e){var t=V$e(e,"string");return tu(t)==="symbol"?t:String(t)}function V$e(e,t){if(tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ji(){return typeof Reflect<"u"&&Reflect.get?Ji=Reflect.get.bind():Ji=function(t,r,n){var o=W$e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ji.apply(this,arguments)}function W$e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lo(e),e!==null););return e}function U$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K_(e,t)}function K_(e,t){return K_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},K_(e,t)}function z$e(e){var t=Y$e();return function(){var n=lo(e),o;if(t){var i=lo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return G$e(this,o)}}function G$e(e,t){if(t&&(tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x2(e)}function x2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y$e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lo(e){return lo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lo(e)}var Zv="contextMenu",K$e=70;me.getSingleton().register("afterContextMenuDefaultOptions");me.getSingleton().register("beforeContextMenuShow");me.getSingleton().register("afterContextMenuShow");me.getSingleton().register("afterContextMenuHide");me.getSingleton().register("afterContextMenuExecute");var D2=function(e){U$e(r,e);var t=z$e(r);function r(n){var o;return j$e(this,r),o=t.call(this,n),o.eventManager=new At(x2(o)),o.commandExecutor=new T2(o.hot),o.itemsFactory=null,o.menu=null,o}return B$e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Zv]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Zv];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new jP(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),Ji(lo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ji(lo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Ji(lo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-bc(o.view),a=f-Xl(o.view)}else i=-1*bc(this.menu.hotMenu.rootWindow),a=-1*Xl(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new $2(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[Zv],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),I(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!Ne(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(Ne(u,"current")&&Ne(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Ji(lo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Zv}},{key:"PLUGIN_PRIORITY",get:function(){return K$e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Ig,Mg,Ve,ov,iv,Ve,Ag,lv,Ve,xg,$g,Ve,av,Ve,Vr]}}]),r}(ut);D2.SEPARATOR={name:Ve};function q$e(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(d0)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function X$e(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(p0,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Z$e(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(y0,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Q$e(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(v0,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function J$e(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(m0)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Uh(e){return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function e1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r1e(n.key),n)}}function t1e(e,t,r){return t&&Gx(e.prototype,t),r&&Gx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r1e(e){var t=n1e(e,"string");return Uh(t)==="symbol"?t:String(t)}function n1e(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o1e=function(){function e(){e1e(this,e),this.data={}}return t1e(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function zh(e){return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}function Yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a1e(n.key),n)}}function i1e(e,t,r){return t&&Yx(e.prototype,t),r&&Yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a1e(e){var t=l1e(e,"string");return zh(t)==="symbol"?t:String(t)}function l1e(e,t){if(zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function s1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u1e=i1e(function e(){s1e(this,e),this.clipboardData=new o1e});function Gh(e){return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function f1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h1e(n.key),n)}}function c1e(e,t,r){return t&&Kx(e.prototype,t),r&&Kx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h1e(e){var t=d1e(e,"string");return Gh(t)==="symbol"?t:String(t)}function d1e(e,t){if(Gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BP=function(){function e(t){f1e(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new At(this),this.listenersCount=new WeakSet,this.container=t}return c1e(e,[{key:"useSecondaryElement",value:function(){var r=p1e(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),qx(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),qx(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",$n()||uie(this.mainElement)}}]),e}();bt(BP,Pr);var sm=new WeakMap;function v1e(e){var t=new BP(e),r=sm.get(e);return r=isNaN(r)?0:r,sm.set(e,r+1),t}function y1e(e){e.eventManager.clear()}var Mw=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function qx(e,t,r){e.addEventListener(t,"copy",Mw("copy",r)),e.addEventListener(t,"cut",Mw("cut",r)),e.addEventListener(t,"paste",Mw("paste",r))}var um=new WeakMap;function p1e(e){var t=um.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return um.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function Xx(e){if(e instanceof BP){var t=sm.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),y1e(e),t<=0){t=0;var r=um.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),um.delete(e.container)),e.mainElement=null}sm.set(e.container,t)}}function Yh(e){return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}function m1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b1e(n.key),n)}}function g1e(e,t,r){return t&&Zx(e.prototype,t),r&&Zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function b1e(e){var t=w1e(e,"string");return Yh(t)==="symbol"?t:String(t)}function w1e(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qx(e,t){N2(e,t),t.add(e)}function cl(e,t,r){N2(e,t),t.set(e,r)}function N2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qv(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function hr(e,t){var r=H2(e,t,"get");return S1e(e,r)}function S1e(e,t){return t.get?t.get.call(e):t.value}function hl(e,t,r){var n=H2(e,t,"set");return C1e(e,n,r),r}function H2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function C1e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var zo=new WeakMap,xw=new WeakMap,If=new WeakMap,q_=new WeakMap,X_=new WeakMap,Mf=new WeakMap,Jv=new WeakSet,Jx=new WeakSet,_1e=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;m1e(this,e),Qx(this,Jx),Qx(this,Jv),cl(this,zo,{writable:!0,value:void 0}),cl(this,xw,{writable:!0,value:void 0}),cl(this,If,{writable:!0,value:void 0}),cl(this,q_,{writable:!0,value:void 0}),cl(this,X_,{writable:!0,value:void 0}),cl(this,Mf,{writable:!0,value:void 0}),hl(this,xw,r),hl(this,If,n),hl(this,q_,o),hl(this,X_,i),hl(this,Mf,a)}return g1e(e,[{key:"setSelectedRange",value:function(r){hl(this,zo,r)}},{key:"getCellsRange",value:function(){if(hr(this,xw).call(this)===0||hr(this,If).call(this)===0)return null;var r=hr(this,zo).getTopStartCorner(),n=r.row,o=r.col,i=hr(this,zo).getBottomEndCorner(),a=i.row,l=i.col,s=Qv(this,Jx,O1e).call(this,n,a),u=Qv(this,Jv,Dw).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(hr(this,If).call(this)===0||hr(this,Mf).call(this)===0)return null;var r=hr(this,zo).getTopStartCorner(),n=r.col,o=hr(this,zo).getBottomEndCorner(),i=o.col,a=Qv(this,Jv,Dw).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(hr(this,If).call(this)===0||hr(this,Mf).call(this)===0)return null;var r=hr(this,zo).getTopStartCorner(),n=r.col,o=hr(this,zo).getBottomEndCorner(),i=o.col,a=Qv(this,Jv,Dw).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-hr(this,Mf).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function Dw(e,t){return Math.min(t,Math.max(e+hr(this,X_).call(this)-1,e))}function O1e(e,t){return Math.min(t,Math.max(e+hr(this,q_).call(this)-1,e))}function L2(e){var t=[],r=[];return I(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);Se(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);Se(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function R1e(e,t){return k1e(e)||T1e(e,t)||P1e(e,t)||E1e()}function E1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P1e(e,t){if(e){if(typeof e=="string")return eD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eD(e,t)}}function eD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function k1e(e){if(Array.isArray(e))return e}function Na(e){return Na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Na(e)}function $1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B2(n.key),n)}}function A1e(e,t,r){return t&&tD(e.prototype,t),r&&tD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ea(){return typeof Reflect<"u"&&Reflect.get?ea=Reflect.get.bind():ea=function(t,r,n){var o=I1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ea.apply(this,arguments)}function I1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=so(e),e!==null););return e}function M1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z_(e,t)}function Z_(e,t){return Z_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Z_(e,t)}function x1e(e){var t=N1e();return function(){var n=so(e),o;if(t){var i=so(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return D1e(this,o)}}function D1e(e,t){if(t&&(Na(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cr(e)}function cr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function so(e){return so=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},so(e)}function H1e(e,t){j2(e,t),t.add(e)}function Ni(e,t,r){j2(e,t),t.set(e,r)}function j2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dl(e,t,r){return t=B2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B2(e){var t=L1e(e,"string");return Na(t)==="symbol"?t:String(t)}function L1e(e,t){if(Na(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Na(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j1e(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function kr(e,t){var r=F2(e,t,"get");return B1e(e,r)}function B1e(e,t){return t.get?t.get.call(e):t.value}function Wn(e,t,r){var n=F2(e,t,"set");return F1e(e,n,r),r}function F2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function F1e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}me.getSingleton().register("afterCopyLimit");me.getSingleton().register("modifyCopyableRange");me.getSingleton().register("beforeCut");me.getSingleton().register("afterCut");me.getSingleton().register("beforePaste");me.getSingleton().register("afterPaste");me.getSingleton().register("beforeCopy");me.getSingleton().register("afterCopy");var ey="copyPaste",V1e=80,W1e=["fragmentSelection"],rD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),Nw=new WeakMap,Hw=new WeakMap,Lw=new WeakMap,vl=new WeakMap,ty=new WeakMap,ry=new WeakMap,yl=new WeakMap,nD=new WeakSet,U1e=function(e){M1e(r,e);var t=x1e(r);function r(){var n;$1e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),H1e(cr(n),nD),dl(cr(n),"columnsLimit",1/0),dl(cr(n),"rowsLimit",1/0),dl(cr(n),"pasteMode","overwrite"),dl(cr(n),"uiContainer",n.hot.rootDocument.body),Ni(cr(n),Nw,{writable:!0,value:!1}),Ni(cr(n),Hw,{writable:!0,value:!1}),Ni(cr(n),Lw,{writable:!0,value:!1}),Ni(cr(n),vl,{writable:!0,value:"cells-only"}),Ni(cr(n),ty,{writable:!0,value:!1}),Ni(cr(n),ry,{writable:!0,value:!1}),Ni(cr(n),yl,{writable:!0,value:new _1e({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),dl(cr(n),"copyableRanges",[]),dl(cr(n),"focusableElement",void 0),n}return A1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ey]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[ey];if(Na(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Wn(this,Nw,!!a.copyColumnHeaders),Wn(this,Hw,!!a.copyColumnGroupHeaders),Wn(this,Lw,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=v1e(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),ea(so(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ea(so(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&Xx(this.focusableElement),ea(so(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Wn(this,vl,o),Wn(this,ty,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Wn(this,ry,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return nc(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=L2(o),s=l.rows,u=l.columns;return I(s,function(f){var c=[];I(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new u1e;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){kr(this,yl).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);kr(this,vl)==="column-headers-only"?i.set("headers",kr(this,yl).getMostBottomColumnHeadersRange()):(kr(this,vl)==="with-column-headers"?i.set("headers",kr(this,yl).getMostBottomColumnHeadersRange()):kr(this,vl)==="with-column-group-headers"&&i.set("headers",kr(this,yl).getAllColumnHeadersRange()),i.set("cells",kr(this,yl).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,p=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:p}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,p=f,g=c,w=f,S=c;s.length<a||p<=d;){var _=this.hot.getCellMeta(p,c),T=_.skipRowOnPaste,R=_.visualRow;if(p=R+1,T!==!0){w=R,g=c;for(var W=[],z=s.length%a;W.length<l||g<=v;){var X=this.hot.getCellMeta(f,g),K=X.skipColumnOnPaste,q=X.visualCol;if(g=q+1,K!==!0){S=q;var Q=W.length%l;W.push(o[z][Q])}}s.push(W)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,w,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!kr(this,ty)||this.isEditorOpened())){this.setCopyableText(),Wn(this,ty,!1);var i=this.getRangedData(this.copyableRanges),a=j1e(this,nD,z1e).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=nc(i);if(o&&o.clipboardData){var u=D1(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[rD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}Wn(this,vl,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!kr(this,ry)||this.isEditorOpened())){this.setCopyableText(),Wn(this,ry,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=nc(i);if(o&&o.clipboardData){var s=D1(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[rD,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=$E(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=tle(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=owe(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=R1e(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},q$e(this)),kr(this,Nw)&&o.items.push(Q$e(this)),kr(this,Hw)&&o.items.push(Z$e(this)),kr(this,Lw)&&o.items.push(X$e(this)),o.items.push(J$e(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&iie())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(Xx(this.focusableElement),this.focusableElement=null),ea(so(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ey}},{key:"SETTING_KEYS",get:function(){return[ey].concat(W1e)}},{key:"PLUGIN_PRIORITY",get:function(){return V1e}}]),r}(ut);function z1e(e){for(var t=L2(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function V2(e,t){return"border_row".concat(e,"col").concat(t)}function Gf(){return{width:1,color:"#000"}}function uo(){return{hide:!0}}function G1e(){return{width:1,color:"#000",cornerVisible:!1}}function jw(e){if(pe(e.start)||pe(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(pe(e.end)||pe(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function xf(e){return pe(e.start)&&(e.left=e.start),pe(e.end)&&(e.right=e.end),e}function Bw(e,t){return{id:V2(e,t),border:G1e(),row:e,col:t,top:uo(),bottom:uo(),start:uo(),end:uo()}}function Y1e(e,t){return xt(t,"border")&&t.border&&(e.border=t.border),xt(t,"top")&&pe(t.top)&&(t.top?(Ue(t.top)||(t.top=Gf()),e.top=t.top):(t.top=uo(),e.top=t.top)),xt(t,"bottom")&&pe(t.bottom)&&(t.bottom?(Ue(t.bottom)||(t.bottom=Gf()),e.bottom=t.bottom):(t.bottom=uo(),e.bottom=t.bottom)),xt(t,"start")&&pe(t.start)&&(t.start?(Ue(t.start)||(t.start=Gf()),e.start=t.start):(t.start=uo(),e.start=t.start)),xt(t,"end")&&pe(t.end)&&(t.end?(Ue(t.end)||(t.end=Gf()),e.end=t.end):(t.end=uo(),e.end=t.end)),e}function Mo(e,t){var r=!1;return I(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!xt(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function Dg(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function K1e(e){return e.some(function(t){return pe(t.left)||pe(t.right)})}function q1e(e){return e.some(function(t){return pe(t.start)||pe(t.end)})}var X1e=new Map([["left","start"],["right","end"]]);function Z1e(e){var t;return(t=X1e.get(e))!==null&&t!==void 0?t:e}function Q1e(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(H0),n=Mo(this,"bottom");return n&&(r=Dg(r)),r},callback:function(r,n){var o=Mo(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function J1e(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(L0),o=Mo(this,t);return o&&(n=Dg(n)),n},callback:function(n,o){var i=Mo(this,t);e.prepareBorder(o,t,i)}}}function eAe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(j0)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Mo(this)}}}function tAe(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(N0),o=Mo(this,t);return o&&(n=Dg(n)),n},callback:function(n,o){var i=Mo(this,t);e.prepareBorder(o,t,i)}}}function rAe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(D0),n=Mo(this,"top");return n&&(r=Dg(r)),r},callback:function(r,n){var o=Mo(this,"top");e.prepareBorder(n,"top",o)}}}function ru(e){return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}function oD(e,t){return aAe(e)||iAe(e,t)||oAe(e,t)||nAe()}function nAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oAe(e,t){if(e){if(typeof e=="string")return iD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iD(e,t)}}function iD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function aAe(e){if(Array.isArray(e))return e}function lAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,U2(n.key),n)}}function sAe(e,t,r){return t&&aD(e.prototype,t),r&&aD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ta(){return typeof Reflect<"u"&&Reflect.get?ta=Reflect.get.bind():ta=function(t,r,n){var o=uAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ta.apply(this,arguments)}function uAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fo(e),e!==null););return e}function fAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q_(e,t)}function Q_(e,t){return Q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Q_(e,t)}function cAe(e){var t=dAe();return function(){var n=fo(e),o;if(t){var i=fo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hAe(this,o)}}function hAe(e,t){if(t&&(ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W2(e)}function W2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fo(e){return fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fo(e)}function vAe(e,t,r){return t=U2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U2(e){var t=yAe(e,"string");return ru(t)==="symbol"?t:String(t)}function yAe(e,t){if(ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ny="customBorders",pAe=90,mAe=function(e){fAe(r,e);var t=cAe(r);function r(){var n;lAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),vAe(W2(n),"savedBorders",[]),n}return sAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ny]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),ta(fo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),ta(fo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),ta(fo(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=jw(i));var u=Rs(o),f=mh(u);I(o,function(c){for(var h=f(c),d=oD(h,4),v=d[0],p=d[1],g=d[2],w=d[3],S=function(R){for(var W=function(K){I(l,function(q){a.prepareBorderFromCustomAdded(R,K,s,Z1e(q))})},z=p;z<=w;z+=1)W(z)},_=v;_<=g;_+=1)S(_)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=Rs(o),l=mh(a),s=[];return I(o,function(u){for(var f=l(u),c=oD(f,4),h=c[0],d=c[1],v=c[2],p=c[3],g=function(_){for(var T=function(z){I(i.savedBorders,function(X){X.row===_&&X.col===z&&s.push(xf(X))})},R=d;R<=p;R+=1)T(R)},w=h;w<=v;w+=1)g(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(I(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=Bw(o,i);a&&(f=Y1e(f,a),I(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",xf(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);Se(o.from.row,l,function(u){Se(o.from.col,s,function(f){var c=Bw(u,f),h=0;u===o.from.row&&xt(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&xt(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&xt(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&xt(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",xf(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=V2(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=Bw(o,i):s=jw(s),l){s[a]=uo();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",xf(s))}}else{s[a]=Gf();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",xf(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;I(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":Se(u.col,f.col,function(c){Se(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":Se(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":Se(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":Se(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":Se(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;I(o,function(a){var l=jw(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return ir(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=We(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;I(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;I(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=We(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):I(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return I(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return Ye(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):I(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&Ye(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[ny];if(Array.isArray(o)){var i=yr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=K1e(o),a=q1e(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[ny]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(x0)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[rAe(this),tAe(this),Q1e(this),J1e(this),eAe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){ta(fo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ny}},{key:"PLUGIN_PRIORITY",get:function(){return pAe}}]),r}(ut);function nu(e){return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function gAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wAe(n.key),n)}}function bAe(e,t,r){return t&&lD(e.prototype,t),r&&lD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wAe(e){var t=SAe(e,"string");return nu(t)==="symbol"?t:String(t)}function SAe(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ra(){return typeof Reflect<"u"&&Reflect.get?ra=Reflect.get.bind():ra=function(t,r,n){var o=CAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ra.apply(this,arguments)}function CAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=co(e),e!==null););return e}function _Ae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J_(e,t)}function J_(e,t){return J_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},J_(e,t)}function OAe(e){var t=EAe();return function(){var n=co(e),o;if(t){var i=co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return RAe(this,o)}}function RAe(e,t){if(t&&(nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z2(e)}function z2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function co(e){return co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},co(e)}var sD="dragToScroll",PAe=100,TAe=function(e){_Ae(r,e);var t=OAe(r);function r(n){var o;return gAe(this,r),o=t.call(this,n),o.eventManager=new At(z2(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return bAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sD]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),ra(co(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ra(co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),ra(co(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=bp(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!Pa(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){ra(co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sD}},{key:"PLUGIN_PRIORITY",get:function(){return PAe}}]),r}(ut);function ou(e){return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}function kAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AAe(n.key),n)}}function $Ae(e,t,r){return t&&uD(e.prototype,t),r&&uD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AAe(e){var t=IAe(e,"string");return ou(t)==="symbol"?t:String(t)}function IAe(e,t){if(ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function na(){return typeof Reflect<"u"&&Reflect.get?na=Reflect.get.bind():na=function(t,r,n){var o=MAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},na.apply(this,arguments)}function MAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ho(e),e!==null););return e}function xAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eO(e,t)}function eO(e,t){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eO(e,t)}function DAe(e){var t=HAe();return function(){var n=ho(e),o;if(t){var i=ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return NAe(this,o)}}function NAe(e,t){if(t&&(ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G2(e)}function G2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ho(e)}me.getSingleton().register("afterDropdownMenuDefaultOptions");me.getSingleton().register("beforeDropdownMenuShow");me.getSingleton().register("afterDropdownMenuShow");me.getSingleton().register("afterDropdownMenuHide");me.getSingleton().register("afterDropdownMenuExecute");var Fw="dropdownMenu",LAe=230,Vw="changeType",Y2=function(e){xAe(r,e);var t=DAe(r);function r(n){var o;return kAe(this,r),o=t.call(this,n),o.eventManager=new At(G2(o)),o.commandExecutor=new T2(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return $Ae(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Fw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new $2(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[Fw],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),na(ho(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new jP(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),I(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),na(ho(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),na(ho(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),Ne(o.target,Vw)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(Vw));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=Vw,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),na(ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Fw}},{key:"PLUGIN_PRIORITY",get:function(){return LAe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[ov,iv,Ve,lv,Ve,kg,Ve,av,Ve,Vr]}}]),r}(ut);Y2.SEPARATOR={name:Ve};function Kh(e){return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function jAe(e,t){return WAe(e)||VAe(e,t)||FAe(e,t)||BAe()}function BAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FAe(e,t){if(e){if(typeof e=="string")return fD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fD(e,t)}}function fD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function WAe(e){if(Array.isArray(e))return e}function UAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GAe(n.key),n)}}function zAe(e,t,r){return t&&cD(e.prototype,t),r&&cD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GAe(e){var t=YAe(e,"string");return Kh(t)==="symbol"?t:String(t)}function YAe(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KAe=function(){function e(t){UAe(this,e),this.hot=t,this.options={}}return zAe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return Se(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(Se(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();Se(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();Se(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=jAe(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const qAe=KAe;function qh(e){return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}function XAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QAe(n.key),n)}}function ZAe(e,t,r){return t&&hD(e.prototype,t),r&&hD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QAe(e){var t=JAe(e,"string");return qh(t)==="symbol"?t:String(t)}function JAe(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eIe=function(){function e(t,r){XAe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return ZAe(e,[{key:"_mergeOptions",value:function(r){var n=Or(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=zt(Or(e.DEFAULT_OPTIONS),n),n=zt(n,r),n.filename=SF(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const tIe=eIe;function iu(e){return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function rIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oIe(n.key),n)}}function nIe(e,t,r){return t&&dD(e.prototype,t),r&&dD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oIe(e){var t=iIe(e,"string");return iu(t)==="symbol"?t:String(t)}function iIe(e,t){if(iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tO(e,t)}function tO(e,t){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tO(e,t)}function lIe(e){var t=fIe();return function(){var n=fm(e),o;if(t){var i=fm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sIe(this,o)}}function sIe(e,t){if(t&&(iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uIe(e)}function uIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fm(e){return fm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fm(e)}var cIe=String.fromCharCode(13),hIe=String.fromCharCode(34),dIe=String.fromCharCode(10),vIe=function(e){aIe(r,e);var t=lIe(r);function r(){return rIe(this,r),t.apply(this,arguments)}return nIe(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=We(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),I(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=jt(o);return a!==""&&(i||a.indexOf(cIe)>=0||a.indexOf(hIe)>=0||a.indexOf(dIe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(tIe);const yIe=vIe;function Xh(e){return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xh(e)}function pIe(e,t,r){return t=mIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mIe(e){var t=gIe(e,"string");return Xh(t)==="symbol"?t:String(t)}function gIe(e,t){if(Xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bIe="csv",rO=pIe({},bIe,yIe);function wIe(e,t,r){return typeof rO[e]=="function"?new rO[e](t,r):null}function au(e){return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function SIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ie(n.key),n)}}function CIe(e,t,r){return t&&vD(e.prototype,t),r&&vD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ie(e){var t=OIe(e,"string");return au(t)==="symbol"?t:String(t)}function OIe(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nO(e,t)}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nO(e,t)}function EIe(e){var t=kIe();return function(){var n=cm(e),o;if(t){var i=cm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return PIe(this,o)}}function PIe(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TIe(e)}function TIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cm(e){return cm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cm(e)}var $Ie="exportFile",AIe=240,IIe=function(e){RIe(r,e);var t=EIe(r);function r(){return SIe(this,r),t.apply(this,arguments)}return CIe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!rO[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return wIe(o,new qAe(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return $Ie}},{key:"PLUGIN_PRIORITY",get:function(){return AIe}}]),r}(ut);function Zh(e){return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zh(e)}function MIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DIe(n.key),n)}}function xIe(e,t,r){return t&&yD(e.prototype,t),r&&yD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DIe(e){var t=NIe(e,"string");return Zh(t)==="symbol"?t:String(t)}function NIe(e,t){if(Zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K2=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;MIe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new sg)}return xIe(e,[{key:"reset",value:function(){I(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),I(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();bt(K2,Pr);const Ng=K2;var Qh={};function mi(e,t){if(!Qh[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=Qh[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function oa(e){if(!Qh[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Qh[e].descriptor}function Wt(e,t,r){r.key=e,Qh[e]={condition:t,descriptor:r}}var Zt="none";function HIe(){return!0}Wt(Zt,HIe,{name:ug,inputsCount:0,showOperators:!1});var lc="empty";function LIe(e){return qt(e.value)}Wt(lc,LIe,{name:G0,inputsCount:0,showOperators:!0});var Uy="not_empty";function jIe(e,t){return!mi(lc,t)(e)}Wt(Uy,jIe,{name:Y0,inputsCount:0,showOperators:!0});function BIe(e,t){return UIe(e)||WIe(e,t)||VIe(e,t)||FIe()}function FIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VIe(e,t){if(e){if(typeof e=="string")return pD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pD(e,t)}}function pD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function UIe(e){if(Array.isArray(e))return e}var sc="eq";function zIe(e,t){var r=BIe(t,1),n=r[0];return jt(e.value).toLocaleLowerCase(e.meta.locale)===jt(n)}Wt(sc,zIe,{name:K0,inputsCount:1,showOperators:!0});var zy="neq";function GIe(e,t){return!mi(sc,t)(e)}Wt(zy,GIe,{name:q0,inputsCount:1,showOperators:!0});function YIe(e,t){return ZIe(e)||XIe(e,t)||qIe(e,t)||KIe()}function KIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qIe(e,t){if(e){if(typeof e=="string")return mD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mD(e,t)}}function mD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ZIe(e){if(Array.isArray(e))return e}var q2="gt";function QIe(e,t){var r=YIe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}Wt(q2,QIe,{name:eP,inputsCount:1,showOperators:!0});function JIe(e,t){return nMe(e)||rMe(e,t)||tMe(e,t)||eMe()}function eMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tMe(e,t){if(e){if(typeof e=="string")return gD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gD(e,t)}}function gD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function nMe(e){if(Array.isArray(e))return e}var X2="gte";function oMe(e,t){var r=JIe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}Wt(X2,oMe,{name:tP,inputsCount:1,showOperators:!0});function iMe(e,t){return uMe(e)||sMe(e,t)||lMe(e,t)||aMe()}function aMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lMe(e,t){if(e){if(typeof e=="string")return bD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bD(e,t)}}function bD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function uMe(e){if(Array.isArray(e))return e}var Z2="lt";function fMe(e,t){var r=iMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}Wt(Z2,fMe,{name:rP,inputsCount:1,showOperators:!0});function cMe(e,t){return yMe(e)||vMe(e,t)||dMe(e,t)||hMe()}function hMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dMe(e,t){if(e){if(typeof e=="string")return wD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wD(e,t)}}function wD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function yMe(e){if(Array.isArray(e))return e}var Q2="lte";function pMe(e,t){var r=cMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}Wt(Q2,pMe,{name:nP,inputsCount:1,showOperators:!0});function mMe(e,t){return SMe(e)||wMe(e,t)||bMe(e,t)||gMe()}function gMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bMe(e,t){if(e){if(typeof e=="string")return SD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SD(e,t)}}function SD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function SMe(e){if(Array.isArray(e))return e}var FP="date_after";function CMe(e,t){var r=mMe(t,1),n=r[0],o=te(e.value,e.meta.dateFormat),i=te(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}Wt(FP,CMe,{name:aP,inputsCount:1,showOperators:!0});function _Me(e,t){return PMe(e)||EMe(e,t)||RMe(e,t)||OMe()}function OMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RMe(e,t){if(e){if(typeof e=="string")return CD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CD(e,t)}}function CD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function EMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function PMe(e){if(Array.isArray(e))return e}var VP="date_before";function TMe(e,t){var r=_Me(t,1),n=r[0],o=te(e.value,e.meta.dateFormat),i=te(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}Wt(VP,TMe,{name:lP,inputsCount:1,showOperators:!0});function kMe(e,t){return MMe(e)||IMe(e,t)||AMe(e,t)||$Me()}function $Me(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AMe(e,t){if(e){if(typeof e=="string")return _D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _D(e,t)}}function _D(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function MMe(e){if(Array.isArray(e))return e}var hm="between";function xMe(e,t){var r=kMe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=mi(VP,[a]),f=mi(FP,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}Wt(hm,xMe,{name:oP,inputsCount:2,showOperators:!0});var J2="not_between";function DMe(e,t){return!mi(hm,t)(e)}Wt(J2,DMe,{name:iP,inputsCount:2,showOperators:!0});function NMe(e,t){return BMe(e)||jMe(e,t)||LMe(e,t)||HMe()}function HMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LMe(e,t){if(e){if(typeof e=="string")return OD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OD(e,t)}}function OD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function BMe(e){if(Array.isArray(e))return e}var eU="begins_with";function FMe(e,t){var r=NMe(t,1),n=r[0];return jt(e.value).toLocaleLowerCase(e.meta.locale).startsWith(jt(n))}Wt(eU,FMe,{name:X0,inputsCount:1,showOperators:!0});var VMe=Ae,tU=Md,WMe=xn.f,UMe=Va,RD=Vt,zMe=nE,GMe=Rr,YMe=oE,ED=tU("".endsWith),KMe=tU("".slice),qMe=Math.min,rU=YMe("endsWith"),XMe=!rU&&!!function(){var e=WMe(String.prototype,"endsWith");return e&&!e.writable}();VMe({target:"String",proto:!0,forced:!XMe&&!rU},{endsWith:function(t){var r=RD(GMe(this));zMe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:qMe(UMe(n),o),a=RD(t);return ED?ED(r,a,i):KMe(r,i-a.length,i)===a}});function ZMe(e,t){return txe(e)||exe(e,t)||JMe(e,t)||QMe()}function QMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JMe(e,t){if(e){if(typeof e=="string")return PD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PD(e,t)}}function PD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function exe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function txe(e){if(Array.isArray(e))return e}var nU="ends_with";function rxe(e,t){var r=ZMe(t,1),n=r[0];return jt(e.value).toLocaleLowerCase(e.meta.locale).endsWith(jt(n))}Wt(nU,rxe,{name:Z0,inputsCount:1,showOperators:!0});function nxe(e,t){return lxe(e)||axe(e,t)||ixe(e,t)||oxe()}function oxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ixe(e,t){if(e){if(typeof e=="string")return TD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TD(e,t)}}function TD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function axe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lxe(e){if(Array.isArray(e))return e}var WP="contains";function sxe(e,t){var r=nxe(t,1),n=r[0];return jt(e.value).toLocaleLowerCase(e.meta.locale).indexOf(jt(n))>=0}Wt(WP,sxe,{name:Q0,inputsCount:1,showOperators:!0});var oU="not_contains";function uxe(e,t){return!mi(WP,t)(e)}Wt(oU,uxe,{name:J0,inputsCount:1,showOperators:!0});var iU="date_tomorrow";function fxe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().subtract(-1,"days").startOf("day"),"d"):!1}Wt(iU,fxe,{name:uP,inputsCount:0});var aU="date_today";function cxe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().startOf("day"),"d"):!1}Wt(aU,cxe,{name:sP,inputsCount:0});var lU="date_yesterday";function hxe(e){var t=te(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(te().subtract(1,"days").startOf("day"),"d"):!1}Wt(lU,hxe,{name:fP,inputsCount:0});oJ();function dxe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var oO=new Set([1]).has(1),vxe=oO&&typeof Array.from=="function";function sv(e){var t=e;return oO&&(t=new Set(t)),function(r){var n;return oO?n=t.has(r):n=!!~t.indexOf(r),n}}function sU(e){return e??""}function iO(e){var t=e;return vxe?t=Array.from(new Set(t)):t=bB(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function kD(e,t,r,n){var o=[],i=e===t,a;return i||(a=sv(t)),I(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:dxe(l,r)};n&&n(u),o.push(u)}),o}function uU(e,t){return gxe(e)||mxe(e,t)||pxe(e,t)||yxe()}function yxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pxe(e,t){if(e){if(typeof e=="string")return $D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $D(e,t)}}function $D(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gxe(e){if(Array.isArray(e))return e}var ia="by_value";function bxe(e,t){var r=uU(t,1),n=r[0];return n(e.value)}Wt(ia,bxe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=uU(t,1),n=r[0];return[sv(n)]},showOperators:!1});var Jh={};function wxe(e){if(!Jh[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=Jh[e].func;return function(r,n){return t(r,n)}}function Sxe(e){return Jh[e].name}function UP(e,t,r){Jh[e]={name:t,func:r}}var si="conjunction",Cxe=dP;function _xe(e,t){return e.every(function(r){return r.func(t)})}UP(si,Cxe,_xe);var dm="disjunction",Oxe=fg;function Rxe(e,t){return e.some(function(r){return r.func(t)})}UP(dm,Oxe,Rxe);var zP="disjunctionWithExtraCondition",Exe=fg;function Pxe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}UP(zP,Exe,Pxe);function ed(e){return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}var Df;function Ww(e,t,r){return t=Txe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Txe(e){var t=kxe(e,"string");return ed(t)==="symbol"?t:String(t)}function kxe(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $xe="numeric",fU="text",Axe="date",AD=(Df={},Ww(Df,$xe,[Zt,Ve,lc,Uy,Ve,sc,zy,Ve,q2,X2,Z2,Q2,hm,J2]),Ww(Df,fU,[Zt,Ve,lc,Uy,Ve,sc,zy,Ve,eU,nU,Ve,WP,oU]),Ww(Df,Axe,[Zt,Ve,lc,Uy,Ve,sc,zy,Ve,VP,FP,hm,Ve,iU,aU,lU]),Df);function Ixe(e){var t=[],r=e;return AD[r]||(r=fU),I(AD[r],function(n){var o;n===Ve?o={name:Ve}:o=Or(oa(n)),t.push(o)}),t}function td(e){return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}function Mxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ID(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dxe(n.key),n)}}function xxe(e,t,r){return t&&ID(e.prototype,t),r&&ID(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dxe(e){var t=Nxe(e,"string");return td(t)==="symbol"?t:String(t)}function Nxe(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uw="built",zw="building",MD=["click","input","keydown","keypress","keyup","focus","blur","change"],cU=function(){function e(t,r){Mxe(this,e),this.hot=t,this.eventManager=new At(this),this.options=zt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return xxe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===zw?this._element:this.buildState===Uw?(this.update(),this._element):(this.buildState=zw,this.build(),this.buildState=Uw,this._element)}},{key:"isBuilt",value:function(){return this.buildState===Uw}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(gr)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=zw),this.options.className&&re(this._element,this.options.className),this.options.children.length)I(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);Ye(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),I(MD,function(i){return n(o,i)})}else I(MD,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Or({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();bt(cU,Pr);const ui=cU;function lu(e){return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function Hxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jxe(n.key),n)}}function Lxe(e,t,r){return t&&xD(e.prototype,t),r&&xD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jxe(e){var t=Bxe(e,"string");return lu(t)==="symbol"?t:String(t)}function Bxe(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gy(){return typeof Reflect<"u"&&Reflect.get?Gy=Reflect.get.bind():Gy=function(t,r,n){var o=Fxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Gy.apply(this,arguments)}function Fxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=su(e),e!==null););return e}function Vxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aO(e,t)}function Wxe(e){var t=zxe();return function(){var n=su(e),o;if(t){var i=su(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Uxe(this,o)}}function Uxe(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hU(e)}function hU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function su(e){return su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},su(e)}var oy=new WeakMap,Gxe=function(e){Vxe(r,e);var t=Wxe(r);function r(n,o){var i;return Hxe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),oy.set(hU(i),{}),i.registerHooks(),i}return Lxe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){Gy(su(r.prototype),"build",this).call(this);var o=oy.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,re(this._element,"htUIInput"),re(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=oy.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&oy.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return Or({placeholder:"",type:"text",tagName:"input"})}}]),r}(ui);const Bl=Gxe;function uu(e){return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function Yxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qxe(n.key),n)}}function Kxe(e,t,r){return t&&DD(e.prototype,t),r&&DD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qxe(e){var t=Xxe(e,"string");return uu(t)==="symbol"?t:String(t)}function Xxe(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fl(){return typeof Reflect<"u"&&Reflect.get?Fl=Reflect.get.bind():Fl=function(t,r,n){var o=Zxe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Fl.apply(this,arguments)}function Zxe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fi(e),e!==null););return e}function Qxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lO(e,t)}function Jxe(e){var t=tDe();return function(){var n=fi(e),o;if(t){var i=fi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eDe(this,o)}}function eDe(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dU(e)}function dU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fi(e){return fi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fi(e)}var iy=new WeakMap,rDe=function(e){Qxe(r,e);var t=Jxe(r);function r(n,o){var i;return Yxe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),iy.set(dU(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return Kxe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return I(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;Fl(fi(r.prototype),"build",this).call(this),this.menu=new jP(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new ui(this.hot,{className:"htUISelectCaption"}),a=new ui(this.hot,{className:"htUISelectDropdown"}),l=iy.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,I([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(ug),iy.get(this).captionElement.textContent=o,Fl(fi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==Ve&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=iy.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),Fl(fi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Or({className:"htUISelect",wrapIt:!1})}}]),r}(ui);const ND=rDe;function fu(e){return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function nDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iDe(n.key),n)}}function oDe(e,t,r){return t&&HD(e.prototype,t),r&&HD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iDe(e){var t=aDe(e,"string");return fu(t)==="symbol"?t:String(t)}function aDe(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yy(){return typeof Reflect<"u"&&Reflect.get?Yy=Reflect.get.bind():Yy=function(t,r,n){var o=lDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Yy.apply(this,arguments)}function lDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cu(e),e!==null););return e}function sDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sO(e,t)}function sO(e,t){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sO(e,t)}function uDe(e){var t=hDe();return function(){var n=cu(e),o;if(t){var i=cu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fDe(this,o)}}function fDe(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cDe(e)}function cDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cu(e){return cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cu(e)}var dDe=function(e){sDe(r,e);var t=uDe(r);function r(n,o){var i;return nDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new ND(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new Bl(i.hot,{placeholder:bP})),i.elements.push(new Bl(i.hot,{placeholder:wP})),i.registerHooks(),i}return oDe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),I(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=Or(o.command);a.name.startsWith(It)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),I(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||oa(Zt),i=[];return I(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=oa(o?o.name:Zt);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||I(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof ND})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof Bl})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&re(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[oa(Zt)];if(o!==null){var a=o.visualIndex;i=Ixe(this.hot.getDataType(0,a,this.hot.countRows(),a))}I(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),Yy(cu(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){I(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){Cc(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),Mn(o)):Cc(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Mn(o))}}]),r}(Ng);const Gw=dDe;function hu(e){return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function vDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pDe(n.key),n)}}function yDe(e,t,r){return t&&LD(e.prototype,t),r&&LD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pDe(e){var t=mDe(e,"string");return hu(t)==="symbol"?t:String(t)}function mDe(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ky(){return typeof Reflect<"u"&&Reflect.get?Ky=Reflect.get.bind():Ky=function(t,r,n){var o=gDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ky.apply(this,arguments)}function gDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=du(e),e!==null););return e}function bDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uO(e,t)}function wDe(e){var t=CDe();return function(){var n=du(e),o;if(t){var i=du(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SDe(this,o)}}function SDe(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vU(e)}function vU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function du(e){return du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},du(e)}var ay=new WeakMap,_De=function(e){bDe(r,e);var t=wDe(r);function r(n,o){var i;return vDe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),ay.set(vU(i),{}),i}return yDe(r,[{key:"build",value:function(){Ky(du(r.prototype),"build",this).call(this);var o=ay.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=ay.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&ay.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Or({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(ui);const jD=_De;function vu(e){return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}var BD;function ODe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function RDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PDe(n.key),n)}}function EDe(e,t,r){return t&&FD(e.prototype,t),r&&FD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PDe(e){var t=TDe(e,"string");return vu(t)==="symbol"?t:String(t)}function TDe(e,t){if(vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fO(e,t)}function $De(e){var t=MDe();return function(){var n=vm(e),o;if(t){var i=vm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ADe(this,o)}}function ADe(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IDe(e)}function IDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vm(e){return vm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vm(e)}var VD=0,xDe=function(e){kDe(r,e);var t=$De(r);function r(n,o){var i;return RDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return EDe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[si,dm];I(i,function(a){var l=new jD(o.hot,{name:"operator",label:{htmlFor:a,textContent:Sxe(a)},value:a,checked:a===i[VD],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(ct(BD||(BD=ODe(["Radio button with index "," doesn't exist."])),o));I(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof jD&&i.isChecked()});return o?o.getValue():si}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&I(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:si,i=arguments.length>1?arguments[1]:void 0,a=o;a===zP&&(a=dm),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(VD)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(Ng);const DDe=xDe;var NDe=Be,HDe=Rr,WD=Vt,LDe=/"/g,jDe=NDe("".replace),BDe=function(e,t,r,n){var o=WD(HDe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+jDe(WD(n),LDe,"&quot;")+'"'),i+">"+o+"</"+t+">"},FDe=je,VDe=function(e){return FDe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},WDe=Ae,UDe=BDe,zDe=VDe;WDe({target:"String",proto:!0,forced:zDe("link")},{link:function(t){return UDe(this,"a","href",t)}});function yu(e){return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function GDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KDe(n.key),n)}}function YDe(e,t,r){return t&&UD(e.prototype,t),r&&UD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KDe(e){var t=qDe(e,"string");return yu(t)==="symbol"?t:String(t)}function qDe(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qy(){return typeof Reflect<"u"&&Reflect.get?qy=Reflect.get.bind():qy=function(t,r,n){var o=XDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},qy.apply(this,arguments)}function XDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pu(e),e!==null););return e}function ZDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cO(e,t)}function cO(e,t){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cO(e,t)}function QDe(e){var t=eNe();return function(){var n=pu(e),o;if(t){var i=pu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JDe(this,o)}}function JDe(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yU(e)}function yU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pu(e){return pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pu(e)}var Yw=new WeakMap,tNe=function(e){ZDe(r,e);var t=QDe(r);function r(n,o){var i;return GDe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Yw.set(yU(i),{}),i}return YDe(r,[{key:"build",value:function(){qy(pu(r.prototype),"build",this).call(this);var o=Yw.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(Yw.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Or({href:"#",tagName:"a"})}}]),r}(ui);const zD=tNe;function mu(e){return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}function GD(e){return iNe(e)||oNe(e)||nNe(e)||rNe()}function rNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nNe(e,t){if(e){if(typeof e=="string")return hO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hO(e,t)}}function oNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iNe(e){if(Array.isArray(e))return hO(e)}function hO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sNe(n.key),n)}}function lNe(e,t,r){return t&&YD(e.prototype,t),r&&YD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sNe(e){var t=uNe(e,"string");return mu(t)==="symbol"?t:String(t)}function uNe(e,t){if(mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vl(){return typeof Reflect<"u"&&Reflect.get?Vl=Reflect.get.bind():Vl=function(t,r,n){var o=fNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Vl.apply(this,arguments)}function fNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ci(e),e!==null););return e}function cNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dO(e,t)}function dO(e,t){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dO(e,t)}function hNe(e){var t=vNe();return function(){var n=ci(e),o;if(t){var i=ci(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dNe(this,o)}}function dNe(e,t){if(t&&(mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pU(e)}function pU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ci(e){return ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ci(e)}var yNe=new WeakMap,pNe="multipleSelect.itemBox",mNe=function(e){cNe(r,e);var t=hNe(r);function r(n,o){var i;return aNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),yNe.set(pU(i),{}),i.searchInput=new Bl(i.hot,{placeholder:gP,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new zD(i.hot,{textContent:vP,className:"htUISelectAll"}),i.clearAllUI=new zD(i.hot,{textContent:yP,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return lNe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return GD(this.items)}},{key:"getValue",value:function(){return bNe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;Vl(ci(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new ui(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),re(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,p,g,w,S,_){v.title=_.instance.getDataAtRowProp(p,_.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Jt(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:pNe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(gNe(this.items,this.options.value)),Vl(ci(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Vl(ci(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=GD(this.items):l=Yr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=EF(Cc,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Mn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),I(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push(eI(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),I(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push(eI(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return Or({className:"htUIMultipleSelect",value:[]})}}]),r}(ui);const KD=mNe;function gNe(e,t){var r=sv(t);return We(e,function(n){return n.checked=r(n.value),n})}function bNe(e){var t=[];return I(e,function(r){r.checked&&t.push(r.value)}),t}function gu(e){return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function wNe(e,t){return ONe(e)||_Ne(e,t)||CNe(e,t)||SNe()}function SNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CNe(e,t){if(e){if(typeof e=="string")return qD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qD(e,t)}}function qD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Ne(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ONe(e){if(Array.isArray(e))return e}function RNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PNe(n.key),n)}}function ENe(e,t,r){return t&&XD(e.prototype,t),r&&XD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PNe(e){var t=TNe(e,"string");return gu(t)==="symbol"?t:String(t)}function TNe(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xy(){return typeof Reflect<"u"&&Reflect.get?Xy=Reflect.get.bind():Xy=function(t,r,n){var o=kNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Xy.apply(this,arguments)}function kNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function $Ne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vO(e,t)}function vO(e,t){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vO(e,t)}function ANe(e){var t=xNe();return function(){var n=bu(e),o;if(t){var i=bu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return INe(this,o)}}function INe(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MNe(e)}function MNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var DNe=function(e){$Ne(r,e);var t=ANe(r);function r(n,o){var i;return RNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new KD(i.hot)),i.registerHooks(),i}return ENe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===ia){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?Zt:ia},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=Yr(u,function(W){return W.name===ia}),v=wNe(d,1),p=v[0],g={},w=i.hot.getTranslatedPhrase(Jp);if(p){var S=iO(We(c(s,h),function(W){return W.value}));f&&(p.args[0]=f);var _=[],T=kD(S,p.args[0],w,function(W){W.checked&&_.push(W.value)}),R=o.editedConditionStack.column;g.locale=i.hot.getCellMeta(0,R).locale,g.args=[_],g.command=oa(ia),g.itemsSnapshot=T}else g.args=[],g.command=oa(Zt);i.state.setValueAtIndex(s,g)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof KD})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){re(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return re(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(Jp),i=iO(this._getColumnVisibleValues()),a=kD(i,i,o);this.getMultipleSelectElement().setItems(a),Xy(bu(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){Cc(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Mn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:We(this.hot.getDataAtCol(o.visualIndex),function(i){return sU(i)})}}]),r}(Ng);const NNe=DNe;function wu(e){return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function HNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jNe(n.key),n)}}function LNe(e,t,r){return t&&ZD(e.prototype,t),r&&ZD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jNe(e){var t=BNe(e,"string");return wu(t)==="symbol"?t:String(t)}function BNe(e,t){if(wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yO(e,t)}function yO(e,t){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yO(e,t)}function VNe(e){var t=zNe();return function(){var n=ym(e),o;if(t){var i=ym(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return WNe(this,o)}}function WNe(e,t){if(t&&(wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UNe(e)}function UNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ym(e){return ym=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ym(e)}var GNe=function(e){FNe(r,e);var t=VNe(r);function r(n,o){var i;return HNe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new Bl(i.hot,{type:"button",value:pP,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new Bl(i.hot,{type:"button",value:mP,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return LNe(r,[{key:"registerHooks",value:function(){var o=this;I(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return re(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||I(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(Ng);const YNe=GNe;function rd(e){return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}var QD,JD;function eN(e,t){return ZNe(e)||XNe(e,t)||qNe(e,t)||KNe()}function KNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qNe(e,t){if(e){if(typeof e=="string")return tN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tN(e,t)}}function tN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ZNe(e){if(Array.isArray(e))return e}function rN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function QNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eHe(n.key),n)}}function JNe(e,t,r){return t&&nN(e.prototype,t),r&&nN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eHe(e){var t=tHe(e,"string");return rd(t)==="symbol"?t:String(t)}function tHe(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oN="ConditionCollection.filteringStates",mU=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;QNe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new sg,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(oN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return JNe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:si;return r.length?wxe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:si,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=We(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(ct(QD||(QD=rN(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(mt(Jh[o]))throw new Error(ct(JD||(JD=rN(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:mi(s,l)}]},i):f.push({name:s,args:l,func:mi(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=eN(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return ir(this.filteringStates.getEntries(),function(r,n){var o=eN(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:We(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),I(r,function(o){I(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(oN),this.filteringStates=null,this.clearLocalHooks()}}]),e}();bt(mU,Pr);const gU=mU;function nd(e){return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}function rHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oHe(n.key),n)}}function nHe(e,t,r){return t&&iN(e.prototype,t),r&&iN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oHe(e){var t=iHe(e,"string");return nd(t)==="symbol"?t:String(t)}function iHe(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aHe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};rHe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return nHe(e,[{key:"filter",value:function(){var r=this,n=[];return I(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return I(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return I(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const bU=aHe;function od(e){return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function lHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uHe(n.key),n)}}function sHe(e,t,r){return t&&aN(e.prototype,t),r&&aN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uHe(e){var t=fHe(e,"string");return od(t)==="symbol"?t:String(t)}function fHe(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wU=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};lHe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return sHe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,I(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=cie(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new gU(o.hot,!1),p=[].concat(c,d);v.importAllConditions(p);var g=o.columnDataFactory(h),w;v.isEmpty()?w=g:w=new bU(v,function(_){return o.columnDataFactory(_)}).filter(),w=We(w,function(_){return _.meta.visualRow});var S=sv(w);return v.destroy(),Yr(g,function(_){return S(_.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;I(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),Ye(this,function(n,o){r[o]=null})}}]),e}();bt(wU,Pr);const cHe=wU;function Su(e){return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(e)}var lN;function hHe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function dHe(e,t){return mHe(e)||pHe(e,t)||yHe(e,t)||vHe()}function vHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yHe(e,t){if(e){if(typeof e=="string")return sN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sN(e,t)}}function sN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function mHe(e){if(Array.isArray(e))return e}function gHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wHe(n.key),n)}}function bHe(e,t,r){return t&&uN(e.prototype,t),r&&uN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wHe(e){var t=SHe(e,"string");return Su(t)==="symbol"?t:String(t)}function SHe(e,t){if(Su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wl(){return typeof Reflect<"u"&&Reflect.get?Wl=Reflect.get.bind():Wl=function(t,r,n){var o=CHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Wl.apply(this,arguments)}function CHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hi(e),e!==null););return e}function _He(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pO(e,t)}function pO(e,t){return pO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pO(e,t)}function OHe(e){var t=EHe();return function(){var n=hi(e),o;if(t){var i=hi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return RHe(this,o)}}function RHe(e,t){if(t&&(Su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SU(e)}function SU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hi(e){return hi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hi(e)}var fN="filters",PHe=250,THe=function(e){_He(r,e);var t=OHe(r);function r(n){var o;return gHe(this,r),o=t.call(this,n),o.eventManager=new At(SU(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.lastSelectedColumn=null,o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return bHe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[fN]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new ev),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(cP),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(hP),":")};if(!this.components.get("filter_by_condition")){var f=new Gw(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new DDe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new Gw(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new NNe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new YNe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new gU(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new cHe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),Wl(hi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}Wl(hi(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:si,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=We(i.filter(),function(h){return h.meta.visualRow});var c=sv(l);Se(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),I(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return I(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,p=c.visualRow,g=c.type,w=c.instance,S=c.dateFormat,_=c.locale,T=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:p,type:g,instance:w,dateFormat:S,locale:_},value:sU(T)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&I(o,function(a){var l=dHe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=iO(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:Ve}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===dm&&i.command.key!==Zt&&a.command.key!==Zt&&l.command.key!==Zt?s=zP:l.command.key!==Zt&&(i.command.key===Zt||a.command.key===Zt)&&(s=si),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==Zt&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==Zt&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==Zt&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===Gw&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?re(i,"htFiltersActive"):He(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new bU(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===ia}),f=l.filter(function(h){return h.name!==ia});if(u.length>=2||f.length>=3)dt(ct(lN||(lN=hHe([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return I(l,function(u){I(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),Wl(hi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fN}},{key:"PLUGIN_PRIORITY",get:function(){return PHe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(ut);function id(e){return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function cN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cN(Object(r),!0).forEach(function(n){kHe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kHe(e,t,r){return t=$He(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $He(e){var t=AHe(e,"string");return id(t)==="symbol"?t:String(t)}function AHe(e,t){if(id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CU="internal-use-in-handsontable",IHe={licenseKey:CU,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function _U(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[vr])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function OU(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function MHe(e){var t,r=e[vr],n=OU(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=_U(e);return uc(uc(uc({},IHe),n),o)}function xHe(e){var t,r=e[vr],n=OU(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=_U(e);return uc(uc({},n),o)}function mO(e){return mO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mO(e)}function Hg(){var e="engine_relationship",t=Jr(vr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function GP(){var e="shared_engine_usage",t=Jr(vr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function DHe(e){var t=e.getSettings(),r=t[vr],n=r==null?void 0:r.engine;if(r===!0||mt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return NHe((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(mO(n)==="object"&&mt(n.hyperformula)){var i=Hg(),a=GP().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:CU}),n}return null}function NHe(e,t,r){var n=t[vr],o=MHe(t),i=Hg(),a=GP();HHe(e,n.functions),LHe(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),jHe(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function hN(e){var t,r=Hg(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function dN(e,t){if(e){var r=Hg(),n=r.get(e),o=GP(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function HHe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){dt(a.message)}})}function LHe(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){dt(n.message)}}}function jHe(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){dt(l.message)}}),e.resumeEvaluation())}function BHe(e,t){return(mt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function RU(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function FHe(e){return RU(e)?e.substr(1):e}function VHe(e){return zHe(e)||UHe(e)||EU(e)||WHe()}function WHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UHe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zHe(e){if(Array.isArray(e))return gO(e)}function vN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vN(Object(r),!0).forEach(function(n){Zy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gi(e){return gi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gi(e)}function pl(e,t){return KHe(e)||YHe(e,t)||EU(e,t)||GHe()}function GHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EU(e,t){if(e){if(typeof e=="string")return gO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gO(e,t)}}function gO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function KHe(e){if(Array.isArray(e))return e}function qHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PU(n.key),n)}}function XHe(e,t,r){return t&&pN(e.prototype,t),r&&pN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aa(){return typeof Reflect<"u"&&Reflect.get?aa=Reflect.get.bind():aa=function(t,r,n){var o=ZHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},aa.apply(this,arguments)}function ZHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function QHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bO(e,t)}function bO(e,t){return bO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bO(e,t)}function JHe(e){var t=tLe();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eLe(this,o)}}function eLe(e,t){if(t&&(gi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vi(e)}function Vi(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}function Zy(e,t,r){return t=PU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PU(e){var t=rLe(e,"string");return gi(t)==="symbol"?t:String(t)}function rLe(e,t){if(gi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kw(e,t,r){nLe(e,t),t.set(e,r)}function nLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ml(e,t,r){var n=TU(e,t,"set");return oLe(e,n,r),r}function oLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function gl(e,t){var r=TU(e,t,"get");return iLe(e,r)}function TU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function iLe(e,t){return t.get?t.get.call(e):t.value}var vr="formulas",aLe=260,mN="row_move";me.getSingleton().register("afterNamedExpressionAdded");me.getSingleton().register("afterNamedExpressionRemoved");me.getSingleton().register("afterSheetAdded");me.getSingleton().register("afterSheetRemoved");me.getSingleton().register("afterSheetRenamed");me.getSingleton().register("afterFormulasValuesUpdate");var bl=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Hi=new WeakMap,qw=new WeakMap,Nf=new WeakMap,lLe=function(e){QHe(r,e);var t=JHe(r);function r(){var n;qHe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Kw(Vi(n),Hi,{writable:!0,value:!1}),Kw(Vi(n),qw,{writable:!0,value:!1}),Kw(Vi(n),Nf,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Zy(Vi(n),"staticRegister",Jr("formulas")),Zy(Vi(n),"engine",null),Zy(Vi(n),"sheetName",null),n}return XHe(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vr]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=DHe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){dt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("beforeUndo",function(l){(l==null?void 0:l.actionType)!==mN&&i.engine.undo()}),this.addHook("beforeRedo",function(l){(l==null?void 0:l.actionType)!==mN&&i.engine.redo()}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),gl(this,Nf).forEach(function(l){var s=pl(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),aa(vo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;gl(this,Nf).forEach(function(i){var a=pl(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),dN(this.engine,this.hot),this.engine=null,aa(vo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){this.engine.updateConfig(xHe(this.hot.getSettings()));var i=this.hot.getSettings()[vr];if(pe(i)&&pe(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!o.data&&this.sheetName===null){var a=this.hot.getSettings()[vr].sheetName;a&&this.engine.doesSheetExist(a)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(a??void 0,this.hot.getSourceDataArray())}aa(vo(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;gl(this,Nf).forEach(function(i){var a,l=pl(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),ml(this,Nf,null),dN(this.engine,this.hot),this.engine=null,aa(vo(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(o,i,a,l,s){return!s&&o>=a?l+(o-a):i}},{key:"toPhysicalRowPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(o,this.hot.toPhysicalRow(o),this.hot.countRows(),this.hot.countSourceRows(),i)}},{key:"toPhysicalColumnPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(o,this.hot.toPhysicalColumn(o),this.hot.countCols(),this.hot.countSourceCols(),i)}},{key:"addSheet",value:function(o,i){if(pe(i)&&!uye(i))return dt("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return dt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return dt(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){ME("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(Po(vr),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:l,col:s}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l===null||s===null?!1:this.engine.doesCellHaveFormula({sheet:a,row:l,col:s})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),hN(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,p=h.sheet;return pe(p)?"".concat(p,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col,p=pe(d)?i.hot.toVisualRow(d):null,g=pe(v)?i.hot.toVisualColumn(v):null;if(!(p===null||g===null)){var w=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,S=l(u);if(w!==void 0&&!s.has(S)){var _=hN(i.engine).get(w);if(!_)return;_.validateCell(_.getDataAtCell(p,g),_.getCellMeta(p,g),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.toPhysicalRowPosition(o),col:this.toPhysicalColumnPosition(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){dt("Not possible to set cell data at ".concat(JSON.stringify(l)));return}return this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.hot.toPhysicalRow(i),col:this.hot.toPhysicalColumn(l),sheet:this.sheetId},u=this.engine.getCellValue(s);return gi(u)==="object"&&u!==null?u.value:u}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=this,s=function(h){return yN(yN({},h),{},{sheet:l.sheetId})},u={start:s(i.getTopStartCorner()),end:s(i.getBottomEndCorner())},f={start:s(a.getTopStartCorner()),end:s(a.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(f)===!1?!1:this.engine.getFillRangeData(u,f)}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(Po(vr))||ml(this,qw,mt(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(Po(vr)))if(this.sheetName=BHe(this.engine,this.hot.getSettings()[vr].sheetName),gl(this,qw))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){ml(this,Hi,!0);var s=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(s),ml(this,Hi,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||gl(this,Hi)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){RU(a.value)&&(a.value=FHe(a.value));return}}var c={row:o,col:this.toPhysicalColumnPosition(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=gi(h)==="object"&&h!==null?h.value:h;a.value=d}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||gl(this,Hi)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i),f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:o,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!bl(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=pl(f,4),h=c[0],d=c[1],v=c[3],p=a.hot.propToCol(d),g=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(p),S={row:g,col:w,sheet:a.sheetId};g!==null&&w!==null?a.syncChangeWithEngine(h,p,v):l.push([h,p,v]),s.push({address:S})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=pl(c,3),d=h[0],v=h[1],p=h[2];a.syncChangeWithEngine(d,v,p)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!bl(i)){var l=[],s=[];o.forEach(function(u){var f=pl(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(Ur(v)){var p={row:c,col:a.toPhysicalColumnPosition(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(p)){dt("Not possible to set source cell data at ".concat(JSON.stringify(p)));return}s.push({address:p}),l.push.apply(l,VHe(a.engine.setCellContents(p,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(o),i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(o),i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=a.every(function(u){return l.engine.isItPossibleToRemoveRows(l.sheetId,[u,1])});return s===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=a.every(function(u){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[u,1])});return s===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!bl(a)){var l=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!bl(a)){var l=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!bl(l)){var u=a.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!bl(l)){var u=a.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;ml(this,Hi,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());ml(this,Hi,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return vr}},{key:"PLUGIN_PRIORITY",get:function(){return aLe}}]),r}(ut);function sLe(e,t){return hLe(e)||cLe(e,t)||fLe(e,t)||uLe()}function uLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fLe(e,t){if(e){if(typeof e=="string")return gN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gN(e,t)}}function gN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hLe(e){if(Array.isArray(e))return e}function dLe(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=sLe(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(V0,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function ly(e){return mLe(e)||pLe(e)||yLe(e)||vLe()}function vLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yLe(e,t){if(e){if(typeof e=="string")return wO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wO(e,t)}}function pLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mLe(e){if(Array.isArray(e))return wO(e)}function wO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gLe(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(W0,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var p=c.slice(a,l+1);h.push.apply(h,ly(p.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,ly(c.slice(0,a)));else if(u===null)h.push.apply(h,ly(c.slice(0,this.countCols())));else{var g=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(g,-1));f===w&&g>l&&h.push.apply(h,ly(c.slice(l+1)))}return I(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function Cu(e){return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function bLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SLe(n.key),n)}}function wLe(e,t,r){return t&&bN(e.prototype,t),r&&bN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SLe(e){var t=CLe(e,"string");return Cu(t)==="symbol"?t:String(t)}function CLe(e,t){if(Cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function la(){return typeof Reflect<"u"&&Reflect.get?la=Reflect.get.bind():la=function(t,r,n){var o=_Le(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},la.apply(this,arguments)}function _Le(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function OLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SO(e,t)}function SO(e,t){return SO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},SO(e,t)}function RLe(e){var t=PLe();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ELe(this,o)}}function ELe(e,t){if(t&&(Cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CO(e)}function CO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}function wN(e,t,r){TLe(e,t),t.set(e,r)}function TLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $r(e,t){var r=kU(e,t,"get");return kLe(e,r)}function kLe(e,t){return t.get?t.get.call(e):t.value}function Hf(e,t,r){var n=kU(e,t,"set");return $Le(e,n,r),r}function kU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $Le(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}me.getSingleton().register("beforeHideColumns");me.getSingleton().register("afterHideColumns");me.getSingleton().register("beforeUnhideColumns");me.getSingleton().register("afterUnhideColumns");var Xw="hiddenColumns",ALe=310,Sn=new WeakMap,Cn=new WeakMap,ILe=function(e){OLe(r,e);var t=RLe(r);function r(){var n;bLe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),wN(CO(n),Sn,{writable:!0,value:{}}),wN(CO(n),Cn,{writable:!0,value:null}),n}return wLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Xw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Xw];Ue(i)&&(Hf(this,Sn,i),mt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Hf(this,Cn,new lg),$r(this,Cn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,$r(this,Cn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),la(yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),la(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Hf(this,Sn,{}),la(yo(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=$r(this,Cn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});I(c,function(d){u[d]=!1}),s=ir(u,function(d,v,p){return v&&d.push(i.hot.toVisualColumn(p)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&$r(this,Cn).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){I(o,function(f){$r(i,Cn).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return We($r(this,Cn).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return $r(this,Cn).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){I(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if($r(this,Sn).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if($r(this,Sn).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if($r(this,Sn).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return I(o,function(s){var u=!0,f=0;Se(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!$r(this,Sn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Ve},dLe(this),gLe(this))}},{key:"onMapInit",value:function(){Array.isArray($r(this,Sn).columns)&&this.hideColumns($r(this,Sn).columns)}},{key:"destroy",value:function(){Hf(this,Sn,null),Hf(this,Cn,null),la(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Xw}},{key:"PLUGIN_PRIORITY",get:function(){return ALe}}]),r}(ut);function MLe(e,t){return HLe(e)||NLe(e,t)||DLe(e,t)||xLe()}function xLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DLe(e,t){if(e){if(typeof e=="string")return SN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SN(e,t)}}function SN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function HLe(e){if(Array.isArray(e))return e}function LLe(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=MLe(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(U0,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function sy(e){return VLe(e)||FLe(e)||BLe(e)||jLe()}function jLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BLe(e,t){if(e){if(typeof e=="string")return _O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _O(e,t)}}function FLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VLe(e){if(Array.isArray(e))return _O(e)}function _O(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WLe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(z0,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var p=c.slice(a,l+1);h.push.apply(h,sy(p.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,sy(c.slice(0,a)));else if(u===null)h.push.apply(h,sy(c.slice(0,this.countRows())));else{var g=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(g,-1));f===w&&g>l&&h.push.apply(h,sy(c.slice(l+1)))}return I(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function _u(e){return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function ULe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GLe(n.key),n)}}function zLe(e,t,r){return t&&CN(e.prototype,t),r&&CN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GLe(e){var t=YLe(e,"string");return _u(t)==="symbol"?t:String(t)}function YLe(e,t){if(_u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sa(){return typeof Reflect<"u"&&Reflect.get?sa=Reflect.get.bind():sa=function(t,r,n){var o=KLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},sa.apply(this,arguments)}function KLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function qLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OO(e,t)}function OO(e,t){return OO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},OO(e,t)}function XLe(e){var t=QLe();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZLe(this,o)}}function ZLe(e,t){if(t&&(_u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RO(e)}function RO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}function _N(e,t,r){JLe(e,t),t.set(e,r)}function JLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fr(e,t){var r=$U(e,t,"get");return eje(e,r)}function eje(e,t){return t.get?t.get.call(e):t.value}function Lf(e,t,r){var n=$U(e,t,"set");return tje(e,n,r),r}function $U(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function tje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}me.getSingleton().register("beforeHideRows");me.getSingleton().register("afterHideRows");me.getSingleton().register("beforeUnhideRows");me.getSingleton().register("afterUnhideRows");var Zw="hiddenRows",rje=320,Un=new WeakMap,_n=new WeakMap,nje=function(e){qLe(r,e);var t=XLe(r);function r(){var n;ULe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_N(RO(n),Un,{writable:!0,value:{}}),_N(RO(n),_n,{writable:!0,value:null}),n}return zLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Zw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Zw];Ue(i)&&(Lf(this,Un,i),mt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),Lf(this,_n,new lg),Fr(this,_n).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Fr(this,_n)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),sa(po(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sa(po(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Lf(this,Un,{}),sa(po(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=Fr(this,_n).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});I(c,function(d){u[d]=!1}),s=ir(u,function(d,v,p){return v&&d.push(i.hot.toVisualRow(p)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&Fr(this,_n).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){I(o,function(f){Fr(i,_n).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return We(Fr(this,_n).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return Fr(this,_n).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){I(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Fr(this,Un).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Fr(this,Un).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return I(o,function(s){var u=!0,f=0;Se(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!Fr(this,Un).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),re(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:Ve},LLe(this),WLe(this))}},{key:"onMapInit",value:function(){Array.isArray(Fr(this,Un).rows)&&this.hideRows(Fr(this,Un).rows)}},{key:"destroy",value:function(){Lf(this,Un,null),Lf(this,_n,null),sa(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Zw}},{key:"PLUGIN_PRIORITY",get:function(){return rje}}]),r}(ut);function oje(e,t){return sje(e)||lje(e,t)||aje(e,t)||ije()}function ije(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aje(e,t){if(e){if(typeof e=="string")return ON(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ON(e,t)}}function ON(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function sje(e){if(Array.isArray(e))return e}function uje(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(g0)},callback:function(r,n){var o=oje(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function fje(e,t){return vje(e)||dje(e,t)||hje(e,t)||cje()}function cje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hje(e,t){if(e){if(typeof e=="string")return RN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RN(e,t)}}function RN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function vje(e){if(Array.isArray(e))return e}function yje(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(b0)},callback:function(r,n){var o=fje(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Ou(e){return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function pje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gje(n.key),n)}}function mje(e,t,r){return t&&EN(e.prototype,t),r&&EN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gje(e){var t=bje(e,"string");return Ou(t)==="symbol"?t:String(t)}function bje(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ul(){return typeof Reflect<"u"&&Reflect.get?Ul=Reflect.get.bind():Ul=function(t,r,n){var o=wje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ul.apply(this,arguments)}function wje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=di(e),e!==null););return e}function Sje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EO(e,t)}function EO(e,t){return EO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},EO(e,t)}function Cje(e){var t=Oje();return function(){var n=di(e),o;if(t){var i=di(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _je(this,o)}}function _je(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AU(e)}function AU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function di(e){return di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},di(e)}me.getSingleton().register("beforeColumnFreeze");me.getSingleton().register("afterColumnFreeze");me.getSingleton().register("beforeColumnUnfreeze");me.getSingleton().register("afterColumnUnfreeze");var PN="manualColumnFreeze",Rje=110,jf=new WeakMap,Eje=function(e){Sje(r,e);var t=Cje(r);function r(n){var o;return pje(this,r),o=t.call(this,n),jf.set(AU(o),{afterFirstUse:!1}),o}return mje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PN]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),Ul(di(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=jf.get(this);o.afterFirstUse=!1,Ul(di(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ul(di(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=jf.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=jf.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},uje(this),yje(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=jf.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return PN}},{key:"PLUGIN_PRIORITY",get:function(){return Rje}}]),r}(ut);function ad(e){return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function Pje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kje(n.key),n)}}function Tje(e,t,r){return t&&TN(e.prototype,t),r&&TN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kje(e){var t=$je(e,"string");return ad(t)==="symbol"?t:String(t)}function $je(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qw=0,kN=1,$N=2,wl="px",Aje=function(){function e(t){Pje(this,e),this.hot=t,this._element=null,this.state=Qw,this.inlineProperty=t.isRtl()?"right":"left"}return Tje(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=$N}},{key:"build",value:function(){this.state===Qw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=kN)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Qw}},{key:"isAppended",value:function(){return this.state===$N}},{key:"isBuilt",value:function(){return this.state>=kN}},{key:"setPosition",value:function(r,n){Ur(r)&&(this._element.style.top=r+wl),Ur(n)&&(this._element.style[this.inlineProperty]=n+wl)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){Ur(r)&&(this._element.style.width=r+wl),Ur(n)&&(this._element.style.height=n+wl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){Ur(r)&&(this._element.style.marginTop=r+wl),Ur(n)&&(this._element.style["margin".concat(Po(this.inlineProperty))]=n+wl)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(Po(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const IU=Aje;function Ru(e){return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function Ije(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xje(n.key),n)}}function Mje(e,t,r){return t&&AN(e.prototype,t),r&&AN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xje(e){var t=Dje(e,"string");return Ru(t)==="symbol"?t:String(t)}function Dje(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qy(){return typeof Reflect<"u"&&Reflect.get?Qy=Reflect.get.bind():Qy=function(t,r,n){var o=Nje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Qy.apply(this,arguments)}function Nje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eu(e),e!==null););return e}function Hje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PO(e,t)}function PO(e,t){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PO(e,t)}function Lje(e){var t=Fje();return function(){var n=Eu(e),o;if(t){var i=Eu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jje(this,o)}}function jje(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bje(e)}function Bje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eu(e){return Eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eu(e)}var Vje="ht__manualColumnMove--backlight",Wje=function(e){Hje(r,e);var t=Lje(r);function r(){return Ije(this,r),t.apply(this,arguments)}return Mje(r,[{key:"build",value:function(){Qy(Eu(r.prototype),"build",this).call(this),re(this._element,Vje)}}]),r}(IU);const Uje=Wje;function Pu(e){return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function zje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yje(n.key),n)}}function Gje(e,t,r){return t&&IN(e.prototype,t),r&&IN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yje(e){var t=Kje(e,"string");return Pu(t)==="symbol"?t:String(t)}function Kje(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jy(){return typeof Reflect<"u"&&Reflect.get?Jy=Reflect.get.bind():Jy=function(t,r,n){var o=qje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Jy.apply(this,arguments)}function qje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Tu(e),e!==null););return e}function Xje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TO(e,t)}function TO(e,t){return TO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},TO(e,t)}function Zje(e){var t=eBe();return function(){var n=Tu(e),o;if(t){var i=Tu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qje(this,o)}}function Qje(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jje(e)}function Jje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tu(e){return Tu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tu(e)}var tBe="ht__manualColumnMove--guideline",rBe=function(e){Xje(r,e);var t=Zje(r);function r(){return zje(this,r),t.apply(this,arguments)}return Gje(r,[{key:"build",value:function(){Jy(Tu(r.prototype),"build",this).call(this),re(this._element,tBe)}}]),r}(IU);const nBe=rBe;function ku(e){return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}function oBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aBe(n.key),n)}}function iBe(e,t,r){return t&&MN(e.prototype,t),r&&MN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aBe(e){var t=lBe(e,"string");return ku(t)==="symbol"?t:String(t)}function lBe(e,t){if(ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ua(){return typeof Reflect<"u"&&Reflect.get?ua=Reflect.get.bind():ua=function(t,r,n){var o=sBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ua.apply(this,arguments)}function sBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function uBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kO(e,t)}function kO(e,t){return kO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kO(e,t)}function fBe(e){var t=hBe();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cBe(this,o)}}function cBe(e,t){if(t&&(ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $O(e)}function $O(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}me.getSingleton().register("beforeColumnMove");me.getSingleton().register("afterColumnMove");var Jw="manualColumnMove",dBe=120,Go=new WeakMap,xN="ht__manualColumnMove",uy="show-ui",eS="on-moving--columns",tS="after-selection--columns",vBe=function(e){uBe(r,e);var t=fBe(r);function r(n){var o;return oBe(this,r),o=t.call(this,n),Go.set($O(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new At($O(o)),o.backlight=new Uje(n),o.guideline=new nBe(n),o}return iBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Jw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,xN),ua(mo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ua(mo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){He(this.hot.rootElement,xN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ua(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=Go.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=Go.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=ir(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[Jw];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return Se(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=Go.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,p=0;if(this.hot.isRtl()){var g=this.hot.rootWindow,w=vt(this.hot.rootElement),S=g.innerWidth-o.rootElementOffset-w;p=g.innerWidth-o.target.eventPageX-S-(l.scrollX===void 0?s:0)}else p=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=p){var _=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=_+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var T=p,R=u;p+d+h>=f?T=f-d-h:p+h<c+v&&(T=c+v+Math.abs(h)),u>=f-1?R=f-1:R===0?R=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(R-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,T),this.guideline.setPosition(null,R)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=Go.get(this),h=Ne(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,He(this.hot.rootElement,[eS,uy]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var p=f.from,g=f.to,w=Math.min(p.col,g.col),S=Math.max(p.col,g.col);if(i.row<0&&i.col>=w&&i.col<=S){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(w,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Ut(this.hot.rootElement).left;var _=c.hasRowHeaders?-1:0,T=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,R=i.col<c.fixedColumnsStart,W=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),z=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),X=this.getColumnsWidth(w,i.col-1)+z,K=this.getColumnsWidth(_,w-1)+(R?W:0)+X;this.backlight.setPosition(T,K),this.backlight.setSize(this.getColumnsWidth(w,S),s.hider.offsetHeight-T),this.backlight.setOffset(null,-X),re(this.hot.rootElement,eS)}else He(this.hot.rootElement,tS),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Go.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=Go.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?He(this.hot.rootElement,uy):re(this.hot.rootElement,uy),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Go.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,He(this.hot.rootElement,[eS,uy,tS]),this.hot.selection.isSelectedByColumnHeader()&&re(this.hot.rootElement,tS),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ua(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Jw}},{key:"PLUGIN_PRIORITY",get:function(){return dBe}}]),r}(ut);function $u(e){return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function yBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mBe(n.key),n)}}function pBe(e,t,r){return t&&DN(e.prototype,t),r&&DN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mBe(e){var t=gBe(e,"string");return $u(t)==="symbol"?t:String(t)}function gBe(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fa(){return typeof Reflect<"u"&&Reflect.get?fa=Reflect.get.bind():fa=function(t,r,n){var o=bBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fa.apply(this,arguments)}function bBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function wBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AO(e,t)}function AO(e,t){return AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},AO(e,t)}function SBe(e){var t=_Be();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CBe(this,o)}}function CBe(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IO(e)}function IO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Be(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}var fy="manualColumnResize",OBe=130,NN="manualColumnWidths",rS=new WeakMap,RBe=function(e){wBe(r,e);var t=SBe(r);function r(n){var o;yBe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new At(IO(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,rS.set(IO(o),{config:void 0}),re(o.handle,"manualColumnResizer"),re(o.guide,"manualColumnResizerGuide"),o}return pBe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[fy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new Ci,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),fa(go(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fa(go(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=rS.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),fa(go(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",NN,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",NN,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=rS.get(this),a=this.hot.getSettings()[fy],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=kt(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();I(v,function(p){var g=p.getTopStartCorner().col,w=p.getBottomEndCorner().col;Se(g,w,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(kt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){He(this.handle,"active"),He(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!Sa(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!OF(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?(I(this.selectedCols,function(s){a(s)}),i()):I(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;Ne(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,I(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?(I(this.selectedCols,function(s){a(s)}),i()):I(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[fy]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){fa(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fy}},{key:"PLUGIN_PRIORITY",get:function(){return OBe}}]),r}(ut);function ld(e){return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function EBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TBe(n.key),n)}}function PBe(e,t,r){return t&&HN(e.prototype,t),r&&HN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TBe(e){var t=kBe(e,"string");return ld(t)==="symbol"?t:String(t)}function kBe(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nS=0,LN=1,jN=2,Sl="px",$Be=function(){function e(t){EBe(this,e),this.hot=t,this._element=null,this.state=nS}return PBe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=jN}},{key:"build",value:function(){this.state===nS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=LN)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=nS}},{key:"isAppended",value:function(){return this.state===jN}},{key:"isBuilt",value:function(){return this.state>=LN}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Sl),n!==void 0&&(this._element.style.left=n+Sl)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Sl),n&&(this._element.style.height=n+Sl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Sl),n&&(this._element.style.marginLeft=n+Sl)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const MU=$Be;function Au(e){return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function ABe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MBe(n.key),n)}}function IBe(e,t,r){return t&&BN(e.prototype,t),r&&BN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MBe(e){var t=xBe(e,"string");return Au(t)==="symbol"?t:String(t)}function xBe(e,t){if(Au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ep(){return typeof Reflect<"u"&&Reflect.get?ep=Reflect.get.bind():ep=function(t,r,n){var o=DBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ep.apply(this,arguments)}function DBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Iu(e),e!==null););return e}function NBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MO(e,t)}function MO(e,t){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MO(e,t)}function HBe(e){var t=BBe();return function(){var n=Iu(e),o;if(t){var i=Iu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LBe(this,o)}}function LBe(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jBe(e)}function jBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iu(e){return Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Iu(e)}var FBe="ht__manualRowMove--backlight",VBe=function(e){NBe(r,e);var t=HBe(r);function r(){return ABe(this,r),t.apply(this,arguments)}return IBe(r,[{key:"build",value:function(){ep(Iu(r.prototype),"build",this).call(this),re(this._element,FBe)}}]),r}(MU);const WBe=VBe;function Mu(e){return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function UBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GBe(n.key),n)}}function zBe(e,t,r){return t&&FN(e.prototype,t),r&&FN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GBe(e){var t=YBe(e,"string");return Mu(t)==="symbol"?t:String(t)}function YBe(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tp(){return typeof Reflect<"u"&&Reflect.get?tp=Reflect.get.bind():tp=function(t,r,n){var o=KBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},tp.apply(this,arguments)}function KBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xu(e),e!==null););return e}function qBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xO(e,t)}function xO(e,t){return xO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xO(e,t)}function XBe(e){var t=JBe();return function(){var n=xu(e),o;if(t){var i=xu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZBe(this,o)}}function ZBe(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QBe(e)}function QBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xu(e)}var eFe="ht__manualRowMove--guideline",tFe=function(e){qBe(r,e);var t=XBe(r);function r(){return UBe(this,r),t.apply(this,arguments)}return zBe(r,[{key:"build",value:function(){tp(xu(r.prototype),"build",this).call(this),re(this._element,eFe)}}]),r}(MU);const rFe=tFe;function Du(e){return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}function nFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iFe(n.key),n)}}function oFe(e,t,r){return t&&VN(e.prototype,t),r&&VN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iFe(e){var t=aFe(e,"string");return Du(t)==="symbol"?t:String(t)}function aFe(e,t){if(Du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ca(){return typeof Reflect<"u"&&Reflect.get?ca=Reflect.get.bind():ca=function(t,r,n){var o=lFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ca.apply(this,arguments)}function lFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function sFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DO(e,t)}function DO(e,t){return DO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},DO(e,t)}function uFe(e){var t=cFe();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fFe(this,o)}}function fFe(e,t){if(t&&(Du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NO(e)}function NO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}me.getSingleton().register("beforeRowMove");me.getSingleton().register("afterRowMove");var oS="manualRowMove",hFe=140,Yo=new WeakMap,WN="ht__manualRowMove",cy="show-ui",iS="on-moving--rows",aS="after-selection--rows",dFe=function(e){sFe(r,e);var t=uFe(r);function r(n){var o;return nFe(this,r),o=t.call(this,n),Yo.set(NO(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new At(NO(o)),o.backlight=new WBe(n),o.guideline=new rFe(n),o}return oFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[oS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),re(this.hot.rootElement,WN),ca(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ca(bo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){He(this.hot.rootElement,WN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ca(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=Yo.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=Yo.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=ir(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[oS];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return Se(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=Yo.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=Ut(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),d=o.target.eventPageY-c.top+u.holder.scrollTop,v=u.hider.offsetHeight,p=u.TBODY.offsetTop,g=this.backlight.getOffset().top,w=this.backlight.getSize().height;this.isFixedRowTop(i.row)&&(h+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:f.offsetHeight/2+h<=d?(o.target.row=i.row+1,h+=i.row===0?f.offsetHeight-1:f.offsetHeight):o.target.row=i.row;var S=d,_=h;d+w+g>=v?S=v-w-g:d+g<p&&(S=p+Math.abs(g)),h>=v-1&&(_=v-1),this.backlight.setPosition(S),this.guideline.setPosition(_)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=Yo.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,He(this.hot.rootElement,[iS,cy]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&p&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var g=h.from,w=h.to,S=Math.min(g.row,w.row),_=Math.max(g.row,w.row);if(i.col<0&&i.row>=S&&i.row<=_){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var T=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,T),this.backlight.setSize(u.hider.offsetWidth-T,this.getRowsHeight(S,_)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),re(this.hot.rootElement,iS),this.refreshPositions()}else He(this.hot.rootElement,aS),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Yo.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=Yo.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?He(this.hot.rootElement,cy):re(this.hot.rootElement,cy),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Yo.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,He(this.hot.rootElement,[iS,cy,aS]),this.hot.selection.isSelectedByRowHeader()&&re(this.hot.rootElement,aS),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ca(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return oS}},{key:"PLUGIN_PRIORITY",get:function(){return hFe}}]),r}(ut);function Nu(e){return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}function vFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pFe(n.key),n)}}function yFe(e,t,r){return t&&UN(e.prototype,t),r&&UN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pFe(e){var t=mFe(e,"string");return Nu(t)==="symbol"?t:String(t)}function mFe(e,t){if(Nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(t,r,n){var o=gFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ha.apply(this,arguments)}function gFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function bFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HO(e,t)}function HO(e,t){return HO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HO(e,t)}function wFe(e){var t=CFe();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SFe(this,o)}}function SFe(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LO(e)}function LO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}var hy="manualRowResize",_Fe=30,zN="manualRowHeights",lS=new WeakMap,OFe=function(e){bFe(r,e);var t=wFe(r);function r(n){var o;vFe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new At(LO(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,lS.set(LO(o),{config:void 0}),re(o.handle,"manualRowResizer"),re(o.guide,"manualRowResizerGuide"),o}return yFe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[hy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new Ci,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),ha(wo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ha(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=lS.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ha(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",zN,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",zN,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,rV.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=vt(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var p=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&p){var g=this.hot.getSelectedRange();I(g,function(w){var S=w.getTopStartCorner().row,_=w.getBottomStartCorner().row;Se(S,_,function(T){i.selectedRows.includes(T)||i.selectedRows.push(T)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(vt(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);re(this.handle,"active"),re(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){He(this.handle,"active"),He(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=Sa(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!OF(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?(I(this.selectedRows,function(s){a(s)}),i()):I(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;Ne(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),I(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?(I(this.selectedRows,function(s){a(s)}),i()):I(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[hy]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=lS.get(this),a=this.hot.getSettings()[hy],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){ha(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return hy}},{key:"PLUGIN_PRIORITY",get:function(){return _Fe}}]),r}(ut);function sd(e){return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}var GN,YN,KN,qN;function dy(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function RFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PFe(n.key),n)}}function EFe(e,t,r){return t&&XN(e.prototype,t),r&&XN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PFe(e){var t=TFe(e,"string");return sd(t)==="symbol"?t:String(t)}function TFe(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kFe=function(){function e(t,r,n,o,i,a){RFe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return EFe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return ct(GN||(GN=dy(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return ct(YN||(YN=dy(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return ct(KN||(KN=dy(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return ct(qN||(qN=dy(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const En=kFe;function jO(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function ud(e){return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}var ZN;function $Fe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function QN(e){return xFe(e)||MFe(e)||IFe(e)||AFe()}function AFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IFe(e,t){if(e){if(typeof e=="string")return BO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BO(e,t)}}function MFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xFe(e){if(Array.isArray(e))return BO(e)}function BO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HFe(n.key),n)}}function NFe(e,t,r){return t&&JN(e.prototype,t),r&&JN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HFe(e){var t=LFe(e,"string");return ud(t)==="symbol"?t:String(t)}function LFe(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jFe=function(){function e(t){DFe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return NFe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return I(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return I(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return I(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new En(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(dt(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];I(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,I(o,function(a,l){Se(0,a.rowspan-1,function(s){Se(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),I(o,function(a){jO.apply(void 0,QN(a))}),I(i,function(a){jO.apply(void 0,QN(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return I(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}I(this.mergedCells,function(l){l.shift(a,n)}),mC(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return ct(ZN||(ZN=$Fe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const BFe=jFe;function fd(e){return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function Li(e,t){return UFe(e)||WFe(e,t)||VFe(e,t)||FFe()}function FFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VFe(e,t){if(e){if(typeof e=="string")return eH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eH(e,t)}}function eH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function UFe(e){if(Array.isArray(e))return e}function zFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YFe(n.key),n)}}function GFe(e,t,r){return t&&tH(e.prototype,t),r&&tH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YFe(e){var t=KFe(e,"string");return fd(t)==="symbol"?t:String(t)}function KFe(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qFe=function(){function e(t){zFe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return GFe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=Li(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,p=Math.floor(l/v)*v,g=l-p,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var S=w.row+w.rowspan-u-g,_=a[2]+S;_>=this.plugin.hot.countRows()?a[2]-=g:a[2]+=g?S:0}else if(o==="right"){var T=w.col+w.colspan-f-g,R=a[3]+T;R>=this.plugin.hot.countCols()?a[3]-=g:a[3]+=g?T:0}else if(o==="up"){var W=c-g-w.row+1,z=a[0]+W;z<0?a[0]+=g:a[0]-=g?W:0}else if(o==="left"){var X=h-g-w.col+1,K=a[1]+X;K<0?a[1]+=g:a[1]-=g?X:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),zt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=Li(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Li(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=Li(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=Li(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=Li(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),p=c?u-l+1:f-s+1,g=Math.floor(v/p)*p,w=v-g,S=null,_=null,T=null;switch(o){case"up":S="includesVertically",T=h-w+1;break;case"left":S="includesHorizontally",T=h-w+1;break;case"down":S="includesVertically",T=d+w-1;break;case"right":S="includesHorizontally",T=d+w-1;break}return I(i,function(R){R[S](T)&&R.isFarther(_,o)&&(_=R)}),_}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return I(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=Li(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const XFe=qFe;function cd(e){return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function ZFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JFe(n.key),n)}}function QFe(e,t,r){return t&&rH(e.prototype,t),r&&rH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JFe(e){var t=eVe(e,"string");return cd(t)==="symbol"?t:String(t)}function eVe(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tVe=function(){function e(t){ZFe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return QFe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const rVe=tVe;function nVe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(S0)}return this.getTranslatedPhrase(w0)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=En.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function Hu(e){return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}function oVe(e,t){return lVe(e)||aVe(e,t)||xU(e,t)||iVe()}function iVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lVe(e){if(Array.isArray(e))return e}function sVe(e){return cVe(e)||fVe(e)||xU(e)||uVe()}function uVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xU(e,t){if(e){if(typeof e=="string")return FO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(e,t)}}function fVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cVe(e){if(Array.isArray(e))return FO(e)}function FO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vVe(n.key),n)}}function dVe(e,t,r){return t&&nH(e.prototype,t),r&&nH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vVe(e){var t=yVe(e,"string");return Hu(t)==="symbol"?t:String(t)}function yVe(e,t){if(Hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zl(){return typeof Reflect<"u"&&Reflect.get?zl=Reflect.get.bind():zl=function(t,r,n){var o=pVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},zl.apply(this,arguments)}function pVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vi(e),e!==null););return e}function mVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VO(e,t)}function VO(e,t){return VO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},VO(e,t)}function gVe(e){var t=wVe();return function(){var n=vi(e),o;if(t){var i=vi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bVe(this,o)}}function bVe(e,t){if(t&&(Hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DU(e)}function DU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vi(e){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vi(e)}me.getSingleton().register("beforeMergeCells");me.getSingleton().register("afterMergeCells");me.getSingleton().register("beforeUnmergeCells");me.getSingleton().register("afterUnmergeCells");var Yf="mergeCells",SVe=150,oH=new WeakMap,iH=Yf,CVe=function(e){mVe(r,e);var t=gVe(r);function r(n){var o;return hVe(this,r),o=t.call(this,n),oH.set(DU(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return dVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Yf]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new BFe(this),this.autofillCalculations=new XFe(this),this.selectionCalculations=new rVe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),zl(vi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),zl(vi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[Yf];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),zl(vi(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(SB()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=sVe(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=Sc(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=Sc(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(En.containsNegativeValues(o)?(dt(En.NEGATIVE_VALUES_WARNING(o)),i=!1):En.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(dt(En.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):En.isSingleCell(o)?(dt(En.IS_SINGLE_CELL(o)),i=!1):En.containsZeroSpan(o)&&(dt(En.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if(I(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),Se(l.row,l.row+l.rowspan-1,function(c){Se(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),Se(0,f.rowspan-1,function(v){Se(0,f.colspan-1,function(p){var g=null;c[v]||(c[v]=[]),v===0&&p===0?g=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+p,"hidden",!0),c[v][p]=g})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),I(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),Se(0,s.rowspan-1,function(u){Se(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Yf]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:iH})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(iH)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=oH.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var p=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:p.row-u.row,col:p.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=Or(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=Or(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=Or(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),I(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},nVe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ue(l)?Or(l):void 0;if(Ue(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,p=s.rowspan,g=this.translateMergedCellToRenderable(h,p,d,v),w=oVe(g,2),S=w[0],_=w[1],T=f.getRenderableFromVisualIndex(i),R=c.getRenderableFromVisualIndex(a),W=S-T+1,z=_-R+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,W),s.colspan=Math.min(s.colspan,z)}jO(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);I(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,p=l.col===0;(s&&h||u&&d||c&&v||f&&p)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Yf}},{key:"PLUGIN_PRIORITY",get:function(){return SVe}}]),r}(ut);function aH(e){return EVe(e)||RVe(e)||OVe(e)||_Ve()}function _Ve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OVe(e,t){if(e){if(typeof e=="string")return lH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lH(e,t)}}function lH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EVe(e){if(Array.isArray(e))return e}function PVe(e,t){return function(r,n){var o=aH(r),i=o.slice(1),a=aH(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,p=v.compareFunctionFactory?v.compareFunctionFactory:b2(c.type),g=p(f,c,v)(h,d);if(g===An){var w=u+1;if(typeof t[w]<"u")return s(w)}return g}(0)}}var sH;function TVe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function uH(){dt(ct(sH||(sH=TVe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var NU="sort";function kVe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(NU,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function $Ve(e){var t=e.className.split(" "),r=new RegExp("^".concat(NU,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function Lu(e){return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function AVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MVe(n.key),n)}}function IVe(e,t,r){return t&&fH(e.prototype,t),r&&fH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MVe(e){var t=xVe(e,"string");return Lu(t)==="symbol"?t:String(t)}function xVe(e,t){if(Lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ir(){return typeof Reflect<"u"&&Reflect.get?Ir=Reflect.get.bind():Ir=function(t,r,n){var o=DVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ir.apply(this,arguments)}function DVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dr(e),e!==null););return e}function NVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WO(e,t)}function WO(e,t){return WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WO(e,t)}function HVe(e){var t=BVe();return function(){var n=dr(e),o;if(t){var i=dr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LVe(this,o)}}function LVe(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jVe(e)}function jVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dr(e){return dr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dr(e)}var UO="multiColumnSorting",FVe=170,VVe="append",cH="columnSorting";g2(UO,PVe);var WVe=function(e){NVe(r,e);var t=HVe(r);function r(n){var o;return AVe(this,r),o=t.call(this,n),o.pluginKey=UO,o}return IVe(r,[{key:"isEnabled",value:function(){return Ir(dr(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[cH]&&uH(),Ir(dr(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ir(dr(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){Ir(dr(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){Ir(dr(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Ir(dr(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return Ir(dr(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){Ir(dr(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=Ir(dr(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),He(o,$Ve(o)),this.enabled!==!1&&re(o,kVe.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[cH]&&uH(),Ir(dr(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){F_(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,VVe))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return UO}},{key:"PLUGIN_PRIORITY",get:function(){return FVe}}]),r}(S2);function ju(e){return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function UVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GVe(n.key),n)}}function zVe(e,t,r){return t&&hH(e.prototype,t),r&&hH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GVe(e){var t=YVe(e,"string");return ju(t)==="symbol"?t:String(t)}function YVe(e,t){if(ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rp(){return typeof Reflect<"u"&&Reflect.get?rp=Reflect.get.bind():rp=function(t,r,n){var o=KVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},rp.apply(this,arguments)}function KVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bu(e),e!==null););return e}function qVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zO(e,t)}function XVe(e){var t=JVe();return function(){var n=Bu(e),o;if(t){var i=Bu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZVe(this,o)}}function ZVe(e,t){if(t&&(ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QVe(e)}function QVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bu(e){return Bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bu(e)}var eWe="multipleSelectionHandles",tWe=160,rWe=function(e){qVe(r,e);var t=XVe(r);function r(n){var o;return UVe(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return zVe(r,[{key:"isEnabled",value:function(){return $n()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new At(this)),this.registerListeners(),rp(Bu(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(Ne(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(Ne(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(Ne(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(Ne(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,p;if(i.dragged.length!==0){var g=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!g||g===i.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(f=i.hot.getCoords(g),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),p=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),p.start!==null&&i.hot.selection.setRangeStart(p.start),i.hot.selection.setRangeEnd(p.end),i.lastSetCell=g),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return eWe}},{key:"PLUGIN_PRIORITY",get:function(){return tWe}}]),r}(ut);function GO(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,p=e.isRoot,g=p===void 0?!1:p,w=e.isPlaceholder,S=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:g,isPlaceholder:S}}function HU(){return{label:"",isPlaceholder:!0}}function dH(e){return aWe(e)||iWe(e)||oWe(e)||nWe()}function nWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oWe(e,t){if(e){if(typeof e=="string")return YO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YO(e,t)}}function iWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aWe(e){if(Array.isArray(e))return YO(e)}function YO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lWe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;I(e,function(o){var i=[],a=0;r.push(i),I(o,function(l){var s=GO();if(Ue(l)){var u=l.label,f=l.colspan;s.label=jt(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=jt(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(HU());return!c})});var n=Math.max.apply(Math,dH(We(r,function(o){return o.length})));return I(r,function(o){if(o.length<n){var i=We(new Array(n-o.length),function(){return GO()});o.splice.apply(o,[o.length,0].concat(dH(i)))}}),r}function hd(e){return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}var sWe=["row","col"];function vH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uWe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vH(Object(r),!0).forEach(function(n){fWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fWe(e,t,r){return t=LU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cWe(e,t){if(e==null)return{};var r=hWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function dWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LU(n.key),n)}}function vWe(e,t,r){return t&&yH(e.prototype,t),r&&yH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LU(e){var t=yWe(e,"string");return hd(t)==="symbol"?t:String(t)}function yWe(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sS(e,t,r){pWe(e,t),t.set(e,r)}function pWe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rn(e,t){var r=jU(e,t,"get");return mWe(e,r)}function mWe(e,t){return t.get?t.get.call(e):t.value}function Bf(e,t,r){var n=jU(e,t,"set");return gWe(e,n,r),r}function jU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function gWe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var pH=["label","collapsible"],zn=new WeakMap,ji=new WeakMap,uS=new WeakMap,bWe=function(){function e(){dWe(this,e),sS(this,zn,{writable:!0,value:[]}),sS(this,ji,{writable:!0,value:0}),sS(this,uS,{writable:!0,value:1/0})}return vWe(e,[{key:"setColumnsLimit",value:function(r){Bf(this,uS,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Bf(this,zn,lWe(r,rn(this,uS))),Bf(this,ji,rn(this,zn).length)}},{key:"getData",value:function(){return rn(this,zn)}},{key:"mergeWith",value:function(r){var n=this;I(r,function(o){var i=o.row,a=o.col,l=cWe(o,sWe),s=n.getHeaderSettings(i,a);s!==null&&zt(s,l,pH)})}},{key:"map",value:function(r){I(rn(this,zn),function(n){I(n,function(o){var i=r(uWe({},o));Ue(i)&&zt(o,i,pH)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=rn(this,ji)||r<0)return null;var i=rn(this,zn)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=rn(this,ji)||r<0)return i;for(var a=rn(this,zn)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return rn(this,ji)}},{key:"getColumnsCount",value:function(){return rn(this,ji)>0?rn(this,zn)[0].length:0}},{key:"clear",value:function(){Bf(this,zn,[]),Bf(this,ji,0)}}]),e}();function dd(e){return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function mH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function gH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mH(Object(r),!0).forEach(function(n){np(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BU(n.key),n)}}function SWe(e,t,r){return t&&bH(e.prototype,t),r&&bH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function np(e,t,r){return t=BU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BU(e){var t=CWe(e,"string");return dd(t)==="symbol"?t:String(t)}function CWe(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _We(e){return PWe(e)||EWe(e)||RWe(e)||OWe()}function OWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RWe(e,t){if(e){if(typeof e=="string")return KO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KO(e,t)}}function EWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PWe(e){if(Array.isArray(e))return KO(e)}function KO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var TWe="DF-pre-order";function FU(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=FU.call(this.childs[n],e,t)}return r}var kWe="DF-post-order";function VU(e,t){for(var r=0;r<this.childs.length;r++){var n=VU.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var WU="BF";function $We(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,_We(o.childs)),e.call(t,o)!==!1&&n()}}n()}var AWe=WU,wH=new Map([[TWe,FU],[kWe,VU],[WU,$We]]),SH=function(){function e(t){wWe(this,e),np(this,"data",{}),np(this,"parent",null),np(this,"childs",[]),this.data=t}return SWe(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(gH({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=gH({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:AWe;if(!wH.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));wH.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function vd(e){return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function CH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _H(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CH(Object(r),!0).forEach(function(n){IWe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IWe(e,t,r){return t=UU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MWe(e,t){return HWe(e)||NWe(e,t)||DWe(e,t)||xWe()}function xWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DWe(e,t){if(e){if(typeof e=="string")return OH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OH(e,t)}}function OH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function HWe(e){if(Array.isArray(e))return e}function LWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UU(n.key),n)}}function jWe(e,t,r){return t&&RH(e.prototype,t),r&&RH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UU(e){var t=BWe(e,"string");return vd(t)==="symbol"?t:String(t)}function BWe(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fS(e,t,r){FWe(e,t),t.set(e,r)}function FWe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fr(e,t){var r=zU(e,t,"get");return VWe(e,r)}function VWe(e,t){return t.get?t.get.call(e):t.value}function WWe(e,t,r){var n=zU(e,t,"set");return UWe(e,n,r),r}function zU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function UWe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Cl=new WeakMap,Bi=new WeakMap,_l=new WeakMap,zWe=function(){function e(t){LWe(this,e),fS(this,Cl,{writable:!0,value:new Map}),fS(this,Bi,{writable:!0,value:new Map}),fS(this,_l,{writable:!0,value:null}),WWe(this,_l,t)}return jWe(e,[{key:"getRoots",value:function(){return Array.from(fr(this,Cl).values())}},{key:"getRootByColumn",value:function(r){var n;return fr(this,Bi).has(r)&&(n=fr(this,Cl).get(fr(this,Bi).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-fr(this,Bi).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;fr(this,Bi).clear(),I(fr(this,Cl),function(o){for(var i=MWe(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)fr(r,Bi).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=fr(this,_l).getColumnsCount(),n=0;n<r;){var o=fr(this,_l).getHeaderSettings(0,n),i=new SH;fr(this,Cl).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=fr(this,_l).getHeadersSettings(o,n,a);o+=1,I(l,function(s){var u=_H(_H({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new SH(u),r.addChild(f)),o<fr(i,_l).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){fr(this,Cl).clear(),fr(this,Bi).clear()}}]),e}();function GU(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function pm(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function mm(e){return pm(e,"origColspan")===e.data.origColspan}function YP(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=mm(e);if(n)return YP(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)I(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,GU(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):mm(c)&&(h.isCollapsed=pm(c,"isCollapsed"))}),{rollbackModification:function(){return KP(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function KP(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=mm(e);if(o)return KP(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)I(i,function(h){GU(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=pm(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):mm(h)&&(d.isCollapsed=pm(h,"isCollapsed"))}),{rollbackModification:function(){return YP(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var EH;function GWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function YWe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ct(EH||(EH=GWe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var PH;function KWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qWe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ct(PH||(PH=KWe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var TH=new Map([["collapse",KP],["expand",YP],["hide-column",YWe],["show-column",qWe]]);function XWe(e,t,r){if(!TH.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return TH.get(e)(t,r)}var ZWe=["crossHiddenColumns"];function QWe(e,t){if(e==null)return{};var r=JWe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JWe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function vy(e){var t=[];return I(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=t2e(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(HU());else{var d=e2e(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function e2e(e){var t=GO(e);t.crossHiddenColumns;var r=QWe(t,ZWe);return r}function t2e(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function yd(e){return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}var r2e=["row"];function kH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $H(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kH(Object(r),!0).forEach(function(n){n2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n2e(e,t,r){return t=YU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o2e(e,t){if(e==null)return{};var r=i2e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function i2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function a2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YU(n.key),n)}}function l2e(e,t,r){return t&&AH(e.prototype,t),r&&AH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YU(e){var t=s2e(e,"string");return yd(t)==="symbol"?t:String(t)}function s2e(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cS(e,t,r){u2e(e,t),t.set(e,r)}function u2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ff(e,t,r){var n=KU(e,t,"set");return f2e(e,n,r),r}function f2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Mt(e,t){var r=KU(e,t,"get");return c2e(e,r)}function KU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function c2e(e,t){return t.get?t.get.call(e):t.value}var On=new WeakMap,Ar=new WeakMap,Fi=new WeakMap,h2e=function(){function e(){a2e(this,e),cS(this,On,{writable:!0,value:new bWe}),cS(this,Ar,{writable:!0,value:new zWe(Mt(this,On))}),cS(this,Fi,{writable:!0,value:[[]]})}return l2e(e,[{key:"setState",value:function(r){Mt(this,On).setData(r);var n=!1;try{Mt(this,Ar).buildTree()}catch{Mt(this,Ar).clear(),Mt(this,On).clear(),n=!0}return Ff(this,Fi,vy(Mt(this,Ar).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Mt(this,On).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=We(r,function(i){var a=i.row,l=o2e(i,r2e);return $H({row:a<0?n.rowCoordsToLevel(a):a},l)});Mt(this,On).mergeWith(o),Mt(this,Ar).buildTree(),Ff(this,Fi,vy(Mt(this,Ar).getRoots()))}},{key:"mapState",value:function(r){Mt(this,On).map(r),Mt(this,Ar).buildTree(),Ff(this,Fi,vy(Mt(this,Ar).getRoots()))}},{key:"mapNodes",value:function(r){return ir(Mt(this,Ar).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=Mt(this,Ar).getNode(n,o),a;return i&&(a=XWe(r,i,o),Ff(this,Fi,vy(Mt(this,Ar).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=Mt(this,Fi)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=Mt(this,Ar).getNode(r,n);return o?$H({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return Mt(this,On).getLayersCount()}},{key:"getColumnsCount",value:function(){return Mt(this,On).getColumnsCount()}},{key:"clear",value:function(){Ff(this,Fi,[]),Mt(this,On).clear(),Mt(this,Ar).clear()}}]),e}();function pd(e){return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function d2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qU(n.key),n)}}function v2e(e,t,r){return t&&IH(e.prototype,t),r&&IH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vf(e,t,r){return t=qU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qU(e){var t=y2e(e,"string");return pd(t)==="symbol"?t:String(t)}function y2e(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var p2e=function(){function e(t,r){d2e(this,e),Vf(this,"hot",void 0),Vf(this,"nestedHeaderSettingsGetter",void 0),Vf(this,"layersCount",0),Vf(this,"container",void 0),Vf(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return v2e(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),p=this.nestedHeaderSettingsGetter(f,d);if(p&&(!p.isPlaceholder||p.isHidden)){var g=p.label;s&&(g+='<button class="changeType"></button>'),Yd(v,g),v.colSpan=p.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const m2e=p2e;function Fu(e){return Fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fu(e)}var MH,xH;function DH(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function g2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XU(n.key),n)}}function b2e(e,t,r){return t&&NH(e.prototype,t),r&&NH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(t,r,n){var o=w2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},da.apply(this,arguments)}function w2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function S2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qO(e,t)}function qO(e,t){return qO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qO(e,t)}function C2e(e){var t=O2e();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _2e(this,o)}}function _2e(e,t){if(t&&(Fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kf(e)}function Kf(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}function HH(e,t,r){return t=XU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XU(e){var t=R2e(e,"string");return Fu(t)==="symbol"?t:String(t)}function R2e(e,t){if(Fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LH(e,t,r){E2e(e,t),t.set(e,r)}function E2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yy(e,t,r){var n=ZU(e,t,"set");return P2e(e,n,r),r}function P2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Et(e,t){var r=ZU(e,t,"get");return T2e(e,r)}function ZU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function T2e(e,t){return t.get?t.get.call(e):t.value}var jH="nestedHeaders",k2e=280,Ht=new WeakMap,Ko=new WeakMap,$2e=function(e){S2e(r,e);var t=C2e(r);function r(){var n;g2e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),LH(Kf(n),Ht,{writable:!0,value:new h2e}),LH(Kf(n),Ko,{writable:!0,value:null}),HH(Kf(n),"ghostTable",new m2e(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),HH(Kf(n),"detectedOverlappedHeaders",!1),n}return b2e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jH]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&dt(ct(MH||(MH=DH([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),da(So(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;Et(this,Ht).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=Et(this,Ht).setState(a)),this.detectedOverlappedHeaders&&dt(ct(xH||(xH=DH([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";Et(o,Ht).triggerColumnModification(u,s)}),!Et(this,Ko)&&this.enabled&&yy(this,Ko,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";Et(o,Ht).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),da(So(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Et(this,Ht).clear(),Et(this,Ko).unsubscribe(),yy(this,Ko,null),this.ghostTable.clear(),da(So(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Et(this,Ht)}},{key:"getLayersCount",value:function(){return Et(this,Ht).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return Et(this,Ht).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),He(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),He(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),He(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),He(s,"hiddenHeader");var v=(u=Et(i,Ht).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},p=v.colspan,g=v.isHidden,w=v.isPlaceholder;if(w||g)re(s,"hiddenHeader");else if(p>1){var S,_,T=h._wt.wtOverlays,R=(S=T.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),W=(_=T.inlineStartOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(s),z=R||W?Math.min(p,a-l):p;z>1&&s.setAttribute("colspan",z)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=Et(this,Ht).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=Et(this,Ht).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=Et(this,Ht).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===tv){if(!d)return l.columnIndex}else f===hg&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,p=c-d+1;if(f>=0||p===1)break;for(var g=c;g<=d;g++)for(var w=f;w<=h;w++){var S,_=v+w,T=g-c;if(T!==0){var R=(S=Et(this,Ht).getHeaderTreeNodeData(w,g))===null||S===void 0?void 0:S.isRoot;R===!1&&(o[_][T]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(xE(o)||Pa(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),p=h.from;l.column=!0,l.cell=!0;var g=[];i.col<p.col?g.push(v.col,f):i.col>p.col?g.push(d.col,f+c-1):g.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,g)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<Et(this,Ht).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=Et(this,Ht).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=Et(this,Ht).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),Ur(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?Et(this,Ht).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=Et(this,Ht).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){yy(this,Ht,null),Et(this,Ko)!==null&&(Et(this,Ko).unsubscribe(),yy(this,Ko,null)),da(So(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return Et(this,Ht).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return jH}},{key:"PLUGIN_PRIORITY",get:function(){return k2e}}]),r}(ut);function BH(e){return x2e(e)||M2e(e)||I2e(e)||A2e()}function A2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I2e(e,t){if(e){if(typeof e=="string")return XO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XO(e,t)}}function M2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function x2e(e){if(Array.isArray(e))return XO(e)}function XO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vu(e){return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function D2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H2e(n.key),n)}}function N2e(e,t,r){return t&&FH(e.prototype,t),r&&FH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H2e(e){var t=L2e(e,"string");return Vu(t)==="symbol"?t:String(t)}function L2e(e,t){if(Vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j2e=function(){function e(t,r){D2e(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return N2e(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Se(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&I(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&I(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return Ye(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(I(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||Vu(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(Se(r[0],r[2],function(w){var S=n.translateTrimmedRow(w);a.push(n.getDataObject(S))}),Se(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var p=this.getChild(c,this.countChildren(c)-1),g=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];I(o,function(l){a.push(i.getDataObject(l))}),I(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(BH(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(BH(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const B2e=j2e;function md(e){return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function VH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V2e(n.key),n)}}function F2e(e,t,r){return t&&VH(e.prototype,t),r&&VH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V2e(e){var t=W2e(e,"string");return md(t)==="symbol"?t:String(t)}function W2e(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var z2e=F2e(function e(t,r){U2e(this,e),this.hot=r,this.plugin=t});const qP=z2e;function Wu(e){return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}function G2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K2e(n.key),n)}}function Y2e(e,t,r){return t&&WH(e.prototype,t),r&&WH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K2e(e){var t=q2e(e,"string");return Wu(t)==="symbol"?t:String(t)}function q2e(e,t){if(Wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZO(e,t)}function Z2e(e){var t=eUe();return function(){var n=gm(e),o;if(t){var i=gm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Q2e(this,o)}}function Q2e(e,t){if(t&&(Wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J2e(e)}function J2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gm(e){return gm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gm(e)}var tUe=function(e){X2e(r,e);var t=Z2e(r);function r(n,o){var i;return G2e(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return Y2e(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(I(c,function(p){p&&u.removeChild(p)}),re(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",Se(0,l-1,function(){var p=h.createElement("SPAN");re(p,r.CSS_CLASSES.emptyIndicator),u.appendChild(p)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");re(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):re(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(qP);const QU=tUe;function Uu(e){return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function UH(e){return iUe(e)||oUe(e)||nUe(e)||rUe()}function rUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nUe(e,t){if(e){if(typeof e=="string")return QO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QO(e,t)}}function oUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iUe(e){if(Array.isArray(e))return QO(e)}function QO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sUe(n.key),n)}}function lUe(e,t,r){return t&&zH(e.prototype,t),r&&zH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sUe(e){var t=uUe(e,"string");return Uu(t)==="symbol"?t:String(t)}function uUe(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JO(e,t)}function cUe(e){var t=vUe();return function(){var n=bm(e),o;if(t){var i=bm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hUe(this,o)}}function hUe(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dUe(e)}function dUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bm(e){return bm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bm(e)}var yUe=function(e){fUe(r,e);var t=cUe(r);function r(n,o){var i;return aUe(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),I(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){Se(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return lUe(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&I(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];I(o,function(u){s.push.apply(s,UH(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return I(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);I(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return I(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);I(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&I(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];I(o,function(u){s.push.apply(s,UH(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];I(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];I(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){I(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){I(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&I(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);Ne(o.target,QU.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),Mn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(qP);const pUe=yUe;function zu(e){return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function mUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bUe(n.key),n)}}function gUe(e,t,r){return t&&GH(e.prototype,t),r&&GH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bUe(e){var t=wUe(e,"string");return zu(t)==="symbol"?t:String(t)}function wUe(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eR(e,t)}function eR(e,t){return eR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eR(e,t)}function CUe(e){var t=OUe();return function(){var n=wm(e),o;if(t){var i=wm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _Ue(this,o)}}function _Ue(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JU(e)}function JU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wm(e){return wm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wm(e)}var YH=new WeakMap,RUe=function(e){SUe(r,e);var t=CUe(r);function r(n,o){var i;return mUe(this,r),i=t.call(this,n,o),YH.set(JU(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return gUe(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(B0)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(F0)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return Se(0,o.items.length-1,function(l){if(l===0)return I(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=YH.get(this);return Se(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(qP);const EUe=RUe;function gd(e){return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}var KH;function qH(e){return $Ue(e)||kUe(e)||TUe(e)||PUe()}function PUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TUe(e,t){if(e){if(typeof e=="string")return tR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tR(e,t)}}function kUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Ue(e){if(Array.isArray(e))return tR(e)}function tR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function IUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xUe(n.key),n)}}function MUe(e,t,r){return t&&XH(e.prototype,t),r&&XH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xUe(e){var t=DUe(e,"string");return gd(t)==="symbol"?t:String(t)}function DUe(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NUe=function(){function e(t){IUe(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return MUe(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(g){if(!f)return!1;var w=a.dataManager.translateTrimmedRow(g);return f=a.shouldAllowMoving(w,u),w}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),p=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,p),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return mt(i)&&(dt(ct(KH||(KH=AUe([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,qH(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,qH(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function Gu(e){return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}function HUe(e){return FUe(e)||BUe(e)||jUe(e)||LUe()}function LUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jUe(e,t){if(e){if(typeof e=="string")return rR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rR(e,t)}}function BUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FUe(e){if(Array.isArray(e))return rR(e)}function rR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UUe(n.key),n)}}function WUe(e,t,r){return t&&ZH(e.prototype,t),r&&ZH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UUe(e){var t=zUe(e,"string");return Gu(t)==="symbol"?t:String(t)}function zUe(e,t){if(Gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function va(){return typeof Reflect<"u"&&Reflect.get?va=Reflect.get.bind():va=function(t,r,n){var o=GUe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},va.apply(this,arguments)}function GUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function YUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nR(e,t)}function nR(e,t){return nR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nR(e,t)}function KUe(e){var t=XUe();return function(){var n=Co(e),o;if(t){var i=Co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qUe(this,o)}}function qUe(e,t){if(t&&(Gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ez(e)}function ez(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Co(e)}var hS="nestedRows",ZUe=300,Gn=new WeakMap,QUe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",JUe=function(e){YUe(r,e);var t=KUe(r);function r(n){var o;return VUe(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,Gn.set(ez(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return WUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[hS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new ev),this.dataManager=new B2e(this,this.hot),this.collapsingUI=new pUe(this,this.hot),this.headersUI=new QU(this,this.hot),this.contextMenuUI=new EUe(this,this.hot),this.rowMoveController=new NUe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),va(Co(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),va(Co(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),va(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=Gn.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=Gn.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=Gn.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=Gn.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=Gn.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=Gn.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=Gn.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,HUe(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=Gn.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){va(Co(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!fye(o)){ME(QUe),this.hot.getSettings()[hS]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return hS}},{key:"PLUGIN_PRIORITY",get:function(){return ZUe}}]),r}(ut);function bd(e){return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function eze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rze(n.key),n)}}function tze(e,t,r){return t&&QH(e.prototype,t),r&&QH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rze(e){var t=nze(e,"string");return bd(t)==="symbol"?t:String(t)}function nze(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oze=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;eze(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return tze(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;I(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const ize=oze;function Yu(e){return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function aze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sze(n.key),n)}}function lze(e,t,r){return t&&JH(e.prototype,t),r&&JH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sze(e){var t=uze(e,"string");return Yu(t)==="symbol"?t:String(t)}function uze(e,t){if(Yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=fze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function fze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function cze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oR(e,t)}function oR(e,t){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oR(e,t)}function hze(e){var t=yze();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dze(this,o)}}function dze(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vze(e)}function vze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}me.getSingleton().register("persistentStateSave");me.getSingleton().register("persistentStateLoad");me.getSingleton().register("persistentStateReset");var eL="persistentState",pze=0,mze=function(e){cze(r,e);var t=hze(r);function r(n){var o;return aze(this,r),o=t.call(this,n),o.storage=void 0,o}return lze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[eL]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new ize(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),ya(_o(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,ya(_o(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ya(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){ya(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return eL}},{key:"PLUGIN_PRIORITY",get:function(){return pze}}]),r}(ut);function Ku(e){return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function gze(e){return Cze(e)||Sze(e)||wze(e)||bze()}function bze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wze(e,t){if(e){if(typeof e=="string")return iR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iR(e,t)}}function Sze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cze(e){if(Array.isArray(e))return iR(e)}function iR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rze(n.key),n)}}function Oze(e,t,r){return t&&tL(e.prototype,t),r&&tL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rze(e){var t=Eze(e,"string");return Ku(t)==="symbol"?t:String(t)}function Eze(e,t){if(Ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,r,n){var o=Pze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function Pze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function Tze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aR(e,t)}function aR(e,t){return aR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aR(e,t)}function kze(e){var t=Ize();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $ze(this,o)}}function $ze(e,t){if(t&&(Ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Aze(e)}function Aze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ize(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}var dS="search",Mze=190,xze="htSearchResult",Dze=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},Nze=function(t,r,n){return mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||mt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},Hze=function(e){Tze(r,e);var t=kze(r);function r(n){var o;return _ze(this,r),o=t.call(this,n),o.callback=Dze,o.queryMethod=Nze,o.searchResultClass=xze,o}return Oze(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[dS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[dS];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),pa(Oo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),pa(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pa(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return Se(0,s-1,function(h){Se(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),p=i.hot.getCellMeta(h,d),g=p.search.callback||a,w=p.search.queryMethod||l,S=w(o,v,p);if(S){var _={row:h,col:d,data:v};f.push(_)}g&&g(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ue(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,gze(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){pa(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return dS}},{key:"PLUGIN_PRIORITY",get:function(){return Mze}}]),r}(ut);function qu(e){return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function Lze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bze(n.key),n)}}function jze(e,t,r){return t&&rL(e.prototype,t),r&&rL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bze(e){var t=Fze(e,"string");return qu(t)==="symbol"?t:String(t)}function Fze(e,t){if(qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gl(){return typeof Reflect<"u"&&Reflect.get?Gl=Reflect.get.bind():Gl=function(t,r,n){var o=Vze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Gl.apply(this,arguments)}function Vze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yi(e),e!==null););return e}function Wze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lR(e,t)}function lR(e,t){return lR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lR(e,t)}function Uze(e){var t=Yze();return function(){var n=yi(e),o;if(t){var i=yi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zze(this,o)}}function zze(e,t){if(t&&(qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gze(e)}function Gze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yi(e){return yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yi(e)}var Kze="touchScroll",qze=200,Xze=function(e){Wze(r,e);var t=Uze(r);function r(n){var o;return Lze(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return jze(r,[{key:"isEnabled",value:function(){return yB()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),Gl(yi(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Gl(yi(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Gl(yi(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,I(this.clones,function(o){re(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,I(this.clones,function(i){He(i,"hide-tween"),re(i,"show-tween")}),this.hot._registerTimeout(function(){I(o.clones,function(i){He(i,"show-tween")})},400),I(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return Kze}},{key:"PLUGIN_PRIORITY",get:function(){return qze}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(ut);function Xu(e){return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function Zze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jze(n.key),n)}}function Qze(e,t,r){return t&&nL(e.prototype,t),r&&nL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jze(e){var t=eGe(e,"string");return Xu(t)==="symbol"?t:String(t)}function eGe(e,t){if(Xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=tGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function tGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function rGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sR(e,t)}function sR(e,t){return sR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sR(e,t)}function nGe(e){var t=aGe();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oGe(this,o)}}function oGe(e,t){if(t&&(Xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iGe(e)}function iGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}var py="trimRows",lGe=330,sGe=function(e){rGe(r,e);var t=nGe(r);function r(n){var o;return Zze(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return Qze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[py]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new ev),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),ma(Ro(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[py];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),I(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),ma(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),ma(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){I(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(I(o,function(c){s[c]=!1}),l=ir(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[py];Array.isArray(i)&&this.hot.batchExecution(function(){I(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){ma(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return py}},{key:"PLUGIN_PRIORITY",get:function(){return lGe}}]),r}(ut);function Zu(e){return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function tz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uGe(n.key),n)}}function rz(e,t,r){return t&&oL(e.prototype,t),r&&oL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uGe(e){var t=fGe(e,"string");return Zu(t)==="symbol"?t:String(t)}function fGe(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uR(e,t)}function oz(e){var t=dGe();return function(){var n=Sm(e),o;if(t){var i=Sm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cGe(this,o)}}function cGe(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hGe(e)}function hGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sm(e){return Sm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sm(e)}function vGe(e){return mGe(e)||pGe(e)||az(e)||yGe()}function yGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mGe(e){if(Array.isArray(e))return fR(e)}function iz(e,t){return wGe(e)||bGe(e,t)||az(e,t)||gGe()}function gGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function az(e,t){if(e){if(typeof e=="string")return fR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fR(e,t)}}function fR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bGe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wGe(e){if(Array.isArray(e))return e}var lz="undoRedo",SGe="undoRedo";function ve(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=iz(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push(vGe(h)),c},[]);I(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ve.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ve.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=yr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ve.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ve.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];Se(s.length-1,function(p){var g=[],w=s[p];Se(u,u+(n-1),function(S){g.push(w[e.toPhysicalColumn(S)])}),f.push(g)}),Se(n-1,function(p){h.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&Se(n-1,function(p){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ve.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ve.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ve.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ve.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ve.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ve.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ve.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ve.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=yr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ve.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=yr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ve.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ve.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ve.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ve.prototype.isEnabled=function(){return this.enabled};ve.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,OGe(e),this.registerShortcuts(),e.addHook("afterChange",sz)}};ve.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,RGe(e),this.unregisterShortcuts(),e.removeHook("afterChange",sz)}};ve.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ve.Action=function(){};ve.Action.prototype.undo=function(){};ve.Action.prototype.redo=function(){};ve.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Si(ve.ChangeAction,ve.Action);ve.ChangeAction.prototype.undo=function(e,t){for(var r=yr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=iz(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ve.ChangeAction.prototype.redo=function(e,t){for(var r=yr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ve.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Si(ve.CreateRowAction,ve.Action);ve.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ve.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ve.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Si(ve.RemoveRowAction,ve.Action);ve.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ve.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ve.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Si(ve.CreateColumnAction,ve.Action);ve.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ve.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ve.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Si(ve.RemoveColumnAction,ve.Action);ve.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(We(this.data[s],i));var u=We(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),I(e.getSourceDataArray(),function(c,h){I(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(o[0],o.length),typeof this.headers<"u"&&I(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ve.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ve.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ve.CellAlignmentAction.prototype.undo=function(e,t){var r=this;I(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ve.CellAlignmentAction.prototype.redo=function(e,t){qo(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ve.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Si(ve.FiltersAction,ve.Action);ve.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ve.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var CGe=function(e){nz(r,e);var t=oz(r);function r(n,o){var i;tz(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return rz(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ve.Action);ve.MergeCellsAction=CGe;var _Ge=function(e){nz(r,e);var t=oz(r);function r(n,o){var i;return tz(this,r),i=t.call(this),i.cellRange=o,i}return rz(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ve.Action);ve.UnmergeCellsAction=_Ge;ve.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Si(ve.RowMoveAction,ve.Action);ve.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ve.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ve.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ve.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:lz};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ve.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(lz)};function sz(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function OGe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function RGe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var uv=me.getSingleton();uv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});uv.register("beforeUndo");uv.register("afterUndo");uv.register("beforeRedo");uv.register("afterRedo");ve.PLUGIN_KEY=SGe;ve.SETTING_KEYS=!0;function EGe(){nt(HEe),nt(s0e),nt(E0e),nt(bPe),nt(LPe),nt(S2),nt(fke),nt(Wke),nt(D2),nt(U1e),nt(mAe),nt(TAe),nt(Y2),nt(IIe),nt(THe),nt(lLe),nt(ILe),nt(nje),nt(Eje),nt(vBe),nt(RBe),nt(dFe),nt(OFe),nt(CVe),nt(WVe),nt(rWe),nt($2e),nt(JUe),nt(mze),nt(Hze),nt(Xze),nt(sGe),nt(ve)}URe();hRe();EGe();const $Ge=e=>hz(UW,{...e,licenseKey:"non-commercial-and-evaluation"});export{$Ge as default};
