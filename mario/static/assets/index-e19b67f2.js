var Le=Object.defineProperty;var $e=(n,t,r)=>t in n?Le(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r;var F=(n,t,r)=>($e(n,typeof t!="symbol"?t+"":t,r),r);import{j as V,r as f,W as R,k as w,w as oe,$ as p,u as S,a as de,b as C,P as ue,C as u,F as T,y as j,m as De,d as he,c as Ne,X as Pe,S as Ie,A as _e,N as Ee,E as je,e as B,J as K,f as _,Z as x,Q as H,K as b,L as P,g as W,R as z,h as Oe,i as qe,x as me,l as Fe,n as ke,o as Me,p as Ae,q as Xe,s as Q,U as O,Y as pe,G as N,t as Y,v as ge,z as ne,B as Ue,D as ie,H as se,T as Ve,I as Be,M as Ke,O as He,V as We,_ as ze}from"./vendor-949d89c7.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();const D=V.Fragment,e=V.jsx,s=V.jsxs;class Qe extends Error{constructor(r,a){const i=r.status||r.status===0?r.status:"",l=r.statusText||"",o=`${i} ${l}`.trim(),c=o?`status code ${o}`:"an unknown error";super(`Request failed with ${c}`);F(this,"response");F(this,"request");this.name="HTTPError",this.response=r,this.request=a}}const Ye=n=>{const t=new URLSearchParams;return Object.entries(n).forEach(([r,a])=>{a!==void 0&&t.set(r,a)}),t};class Ge{constructor(t={}){F(this,"config");var r;this.config=t,this.config.baseUrl=(r=this.config.baseUrl)==null?void 0:r.replace(/\/+$/,"")}async fetch(t){let r,a;if(typeof t=="string")r=t;else{const{url:o,params:c,json:d,...h}=t;if(r=o,a=h,d&&(a.body=JSON.stringify(d),a.headers={"Content-Type":"application/json"}),c){const g=Ye(c);r+=`?${g}`}}this.config.baseUrl&&(r=this.config.baseUrl+r);const i=new Request(r,a),l=await fetch(i);if(!l.ok)throw new Qe(l,i);return l.headers.get("Content-Type")==="application/json"?await l.json():await l.text()}async fetchForceMethod(t,r){return typeof t=="string"?this.fetch({url:t,method:r}):this.fetch({...t,method:r})}async get(t){return this.fetchForceMethod(t,"get")}async post(t){return this.fetchForceMethod(t,"post")}async put(t){return this.fetchForceMethod(t,"put")}async patch(t){return this.fetchForceMethod(t,"patch")}async delete(t){return this.fetchForceMethod(t,"delete")}}const Je="/api",G={}.VITE_API_BASE_URL||Je,L=new Ge({baseUrl:G}),Ze=async()=>{const n=await L.get("/pipelines");return n.forEach(t=>{t.triggers.forEach(r=>{r.next_fire_time=new Date(r.next_fire_time)})}),n},J=async n=>{const t=await L.get(`/pipelines/${n}`);return t.triggers.forEach(r=>{r.next_fire_time=new Date(r.next_fire_time)}),t},et=async n=>await L.get(`/pipelines/${n}/input-schema`),fe=async(n,t)=>{const r={pipeline_id:n,trigger_id:t},a=await L.get({url:"/runs",params:r});return a.forEach(i=>{i.start_time=new Date(i.start_time)}),a},tt=async n=>{const t=await L.get(`/runs/${n}`);return t.start_time=new Date(t.start_time),t},rt=async n=>(await L.get(`/runs/${n}/logs`)).split(`
`).map((r,a)=>{const i=JSON.parse(r);return i.id=a,i.timestamp=new Date(i.timestamp),i}),nt=async(n,t)=>await L.get(`/runs/${n}/data/${t}`),U=n=>`${G}/pipelines/${n}/run`,it=n=>({async mutationFn(t){L.post({url:`/pipelines/${n}/run`,json:t})}}),k=(n,t,r=!0)=>`${r?G:""}/pipelines/${n}/triggers/${t}/run`,st=async(n,t)=>await L.post(k(n,t,!1)),A=({children:n,footer:t,isOpen:r,maxHeight:a,maxWidth:i="600px",minWidth:l="350px",subtitle:o,title:c,onClose:d})=>{const h=f.createRef();return f.useEffect(()=>{var y,v;r?(y=h.current)==null||y.showModal():(v=h.current)==null||v.close()},[r]),e("dialog",{ref:h,style:{padding:0,background:"transparent",overflow:"visible",maxHeight:a,maxWidth:i,minWidth:l},onClick:y=>{var m;var v=h.current.getBoundingClientRect(),q=v.top<=y.clientY&&y.clientY<=v.top+v.height&&v.left<=y.clientX&&y.clientX<=v.left+v.width;q||(d?d():(m=h.current)==null||m.close())},children:s(R,{children:[c&&e(w,{children:c}),o&&e(oe,{children:o}),e("div",{className:(c||o)&&"mt-6",children:n}),t&&e(p,{justifyContent:"justify-end",spaceX:"space-x-6",marginTop:"mt-6",children:t})]})})},at=n=>{const t=i=>{if(!n.definitions)return;const l=i.split("/").pop();return n.definitions[l]},r=n.properties;if(!r)return e(u,{marginTop:"mt-4",children:"This pipeline has no input"});const a=Object.entries(r).map(([i,l])=>{var y,v,q;if(typeof l=="boolean")return;let o=l,c;if(l.allOf){const m=l.allOf[0];if(c=(y=l.default)==null?void 0:y.toString(),m.$ref){const $=t(m.$ref);$&&(o=$)}}else if(l.$ref){const m=t(l.$ref);m&&(o=m)}else c=(v=o.default)==null?void 0:v.toString();const d=o.title||i,h=(o.enum?"enum":Array.isArray(o.type)?o.type[0]:o.type)||"string",g=(q=n.required)==null?void 0:q.includes(i);if(["number","integer"].includes(h)){const m=o.minimum||o.exclusiveMinimum,$=o.maximum||o.exclusiveMaximum;if(m!==void 0&&$!==void 0){const X=f.createRef(),Re=h==="number"?($-m)/10:1;return s(T,{children:[e(u,{children:d}),e("input",{name:i,type:"range",min:m,max:$,step:Re,defaultValue:c,required:g,onInput:Se=>X.current&&(X.current.value=Se.target.value),className:"w-full mt-2 cursor-ew-resize appearance-none h-2 bg-slate-200 border border-slate-400 rounded"}),s(p,{alignItems:"items-baseline",spaceX:"space-x-4",children:[s("div",{className:"ml-1",children:[e("div",{className:"tr-border-r border-slate-400 h-2 w-1"}),e(u,{children:m})]}),e(u,{children:e(j,{children:e("output",{ref:X,className:"px-2 py-1 rounded bg-slate-200 block truncate text-center",children:c})})}),s("div",{className:"mr-1",children:[e("div",{className:"tr-border-r border-slate-400 h-2 w-1"}),e(u,{children:$})]})]})]},i)}else return s(T,{children:[e(u,{children:d}),e("input",{name:i,type:"number",min:m,max:$,defaultValue:c,className:"tr-border-gray-300 tr-rounded-md tr-border tr-shadow-sm tr-pl-4 tr-pr-4 tr-pt-2 tr-pb-2 tr-text-sm tr-font-medium invalid:border-rose-500 mt-2",style:{textAlign:"end",width:"100%"},required:g})]},i)}else return h==="enum"?s("div",{children:[e(u,{children:d}),s("select",{name:i,defaultValue:c||"",className:"tr-border-gray-300 tr-rounded-md tr-border tr-shadow-sm tr-pl-4 tr-pr-4 tr-pt-2 tr-pb-2 tr-text-sm tr-font-medium tr-w-full invalid:border-rose-500 mt-2",required:g,children:[e("option",{disabled:!0,value:"",children:"Select..."}),o.enum.map(m=>e("option",{value:m==null?void 0:m.toString(),children:m==null?void 0:m.toString()},m==null?void 0:m.toString()))]})]},i):s("div",{children:[s(u,{children:[d," ",g&&"*"]}),e(De,{name:i,placeholder:d,defaultValue:c,marginTop:"mt-2"})]},i)});return e(T,{spaceY:"space-y-4",children:a})},Z=({pipeline:n})=>{const[t,r]=f.useState(!1),a=S({queryKey:["pipeline-input",n.id],queryFn:()=>et(n.id),enabled:t}),i=de(it(n.id));return s(D,{children:[e(C,{color:"indigo",variant:"secondary",size:"xs",icon:ue,onClick:()=>r(!0),children:"Run pipeline"}),e(A,{isOpen:t,title:`Run ${n.name} manually`,onClose:()=>r(!1),children:s("form",{method:"dialog",onSubmit:l=>{const o=Object.fromEntries(new FormData(l.target).entries());i.mutateAsync(o)},children:[a.isLoading?"Loading...":e("div",{style:{width:350},children:at(a.data)}),s(p,{justifyContent:"justify-end",spaceX:"space-x-6",marginTop:"mt-6",children:[e(C,{variant:"secondary",color:"indigo",onClick:()=>{r(!1)},children:"Close"}),e(C,{color:"indigo",type:"submit",children:"Run"})]})]})})]})},ee={completed:"emerald",failed:"rose",cancelled:"slate",running:"blue",notrun:"slate",warning:"amber"},ye={completed:Ne,failed:Pe,cancelled:Ie,running:_e,notrun:Ee,warning:je},te=n=>he(n).format("D MMM YYYY HH:mm:ss (Z[Z])"),ct=n=>he(n).format("HH:mm:ss.SSS"),xe=({pipeline:n})=>s(R,{marginTop:"mt-5",children:[e(w,{children:"Triggers"}),s(B,{children:[e(K,{children:s(_,{children:[e(x,{children:"Name"}),e(x,{children:"Interval"}),e(x,{children:"Next fire time"}),e(x,{children:"Latest Status"})]})}),e(H,{children:n.triggers.map(t=>s(_,{children:[e(b,{children:e(P,{to:`/pipelines/${n.id}/triggers/${t.id}`,children:t.name})}),e(b,{children:e(u,{children:t.interval})}),e(b,{children:t.paused?e(W,{text:"Disabled",color:"amber",tooltip:"Re-enable the trigger setting paused=False",size:"xs"}):t.next_fire_time?te(t.next_fire_time):"-"}),e(b,{children:"-"})]},t.id))})]})]}),lt=()=>{const n=S({queryKey:["pipelines"],queryFn:Ze,initialData:[]});if(n.isLoading)return e("div",{children:"Loading..."});if(n.error)return e("div",{children:"An error has occurred"});const t=n.data;return e(D,{children:t.map(r=>s(z.Fragment,{children:[s(p,{children:[e(p,{children:s(p,{justifyContent:"justify-start",alignItems:"items-baseline",spaceX:"space-x-2",children:[e(w,{children:e(P,{to:`/pipelines/${r.id}`,className:"hover:text-indigo-500 transition-colors",children:r.name})}),e(u,{children:e("span",{className:"tr-block tr-truncate tr-max-w-lg",children:r.description})})]})}),e(Z,{pipeline:r})]}),e(xe,{pipeline:r})]},r.id))})};function ot(){return s("main",{className:"bg-slate-50 p-6 sm:p-10 min-h-screen",children:[e(w,{children:"Mario Pype"}),e(u,{children:"All your pipelines."}),e(T,{marginTop:"mt-6",children:e(lt,{})})]})}const be=({content:n})=>{const[t,r]=f.useState(!1),a=f.useRef();return e(C,{variant:"light",color:"indigo",size:"sm",icon:t?Oe:qe,onClick:()=>{navigator.clipboard.writeText(n),r(!0),a.current=setTimeout(()=>r(!1),3e3)}})},E=()=>e(u,{children:"/"}),re=({pipeline:n,trigger:t,run:r})=>{if(r&&!t)throw new Error;return e("div",{className:"breadcrumbs",children:s(p,{spaceX:"space-x-2",justifyContent:"justify-start",children:[e(u,{children:e(P,{to:"/",children:"Pipelines"})}),e(E,{}),e(u,{children:t?e(P,{to:`/pipelines/${n.id}`,children:n.name}):n.name}),t&&s(D,{children:[e(E,{}),e(u,{children:"Triggers"}),e(E,{}),e(u,{children:r?e(P,{to:`/pipelines/${n.id}/triggers/${t.id}`,children:t.name}):t.name})]}),r&&t&&s(D,{children:[e(E,{}),e(u,{children:"Runs"}),e(E,{}),s(u,{children:["#",r.id]})]})]})})},ae=n=>(n/1e3).toFixed(1)+" s",ve=({runs:n})=>{const t=n.filter(a=>a.status==="completed").reverse(),r=t.reduce((a,i)=>a+i.duration,0)/t.length||0;return s(R,{children:[e(p,{alignItems:"items-start",children:e(u,{children:"Duration"})}),e(p,{justifyContent:"justify-start",alignItems:"items-baseline",spaceX:"space-x-3",truncate:!0,children:e(me,{children:ae(r)})}),e(Fe,{data:t,dataKey:"id",categories:["duration"],colors:["indigo"],valueFormatter:ae,marginTop:"mt-6",yAxisWidth:"w-10",height:"h-28",showLegend:!1,autoMinValue:!0})]})},Te=({status:n})=>e(W,{text:n,color:ee[n],icon:ye[n]}),dt=({startTime:n})=>{const[t,r]=f.useState(Date.now()-n.getTime());return f.useEffect(()=>{const a=setInterval(()=>{r(Date.now()-n.getTime())},500);return()=>{clearInterval(a)}}),e("span",{children:(t/1e3).toFixed(2)})},I=typeof window<"u"?new WebSocket("ws://localhost:8000/api/ws"):void 0,we=({pipelineId:n,runs:t,triggerId:r})=>{const[a,i]=f.useState(t),l=ke(),o=f.useCallback(c=>{const{data:d}=JSON.parse(c.data);if(d.run.start_time=new Date(d.run.start_time),d.run.status==="running")i([d.run,...a]);else{let h=[...a];const g=h.findIndex(y=>y.id===d.run.id);g>=0?h[g]=d.run:h=[d.run,...h],i(h),l.invalidateQueries({queryKey:["runs",n,r]})}},[n,l,a,r]);return f.useEffect(()=>(I==null||I.addEventListener("message",o),()=>{I==null||I.removeEventListener("message",o)}),[o]),f.useEffect(()=>{t.length&&i(t)},[t]),s(R,{marginTop:"mt-5",children:[e(w,{children:"Runs"}),s(B,{children:[e(K,{children:s(_,{children:[e(x,{textAlignment:"text-right",children:"#"}),e(x,{children:"Status"}),!r&&e(x,{children:"Trigger"}),e(x,{children:"Started at"}),e(x,{textAlignment:"text-right",children:"Duration"})]})}),e(H,{children:a.map(c=>s(_,{children:[e(b,{textAlignment:"text-right",children:e(P,{to:`/pipelines/${n}/triggers/${c.trigger_id}/runs/${c.id}`,className:"hover:text-indigo-500 hover:border-b-indigo-500 border-b border-b-transparent transition-colors",children:c.id})}),e(b,{children:e(Te,{status:c.status})}),!r&&e(b,{children:e(P,{to:`/pipelines/${n}/triggers/${c.trigger_id}`,className:"hover:text-indigo-500 hover:border-b-indigo-500 border-b border-b-transparent transition-colors",title:"View trigger details",children:c.trigger_id})}),e(b,{children:e(u,{children:te(c.start_time)})}),s(b,{textAlignment:"text-right",children:[c.status!=="running"?(c.duration/1e3).toFixed(2):e(dt,{startTime:c.start_time})," ","s"]})]},c.id))})]})]})},Ce=({runs:n,subject:t})=>{var o,c;const a=n.filter(d=>d.status==="completed").length/n.length*100||0,i=(o=n[0])==null?void 0:o.start_time,l=(c=n[n.length-1])==null?void 0:c.start_time;return s(R,{children:[e(p,{children:s(w,{children:[t," health"]})}),n.length?s(D,{children:[s(p,{marginTop:"mt-4",children:[e(u,{children:"Successful runs"}),s(u,{children:[a.toFixed(1)," %"]})]}),e(Me,{marginTop:"mt-2",children:n.map(d=>e(Ae,{color:ee[d.status],tooltip:`#${d.id} ${d.status}`},d.id))})]}):e(u,{textAlignment:"text-center",marginTop:"mt-8",children:s(Xe,{children:["This ",t.toLowerCase()," has no runs yet"]})}),s(p,{marginTop:"mt-2",children:[e(u,{children:i&&i.toDateString()}),e(u,{children:l&&l.toDateString()})]})]})},ut=()=>{const t=Q().pipelineId,r=S({queryKey:["pipeline",t],queryFn:()=>J(t),initialData:{id:"",name:"",description:"",tasks:[],triggers:[]},enabled:!!t}),a=S({queryKey:["runs",t,void 0],queryFn:()=>fe(t),initialData:[]});if(a.isLoading||r.isLoading)return e("div",{children:"Loading..."});if(a.error||r.error)return e("div",{children:"An error has occurred"});const i=r.data;return s("main",{className:"bg-slate-50 p-6 sm:p-10 min-h-screen",children:[s(p,{alignItems:"items-start",children:[s(T,{children:[s(p,{justifyContent:"justify-start",spaceX:"space-x-2",children:[s(w,{children:["Pipeline ",i.name]}),i.description&&s(u,{truncate:!0,children:["Â· ",i.description]})]}),e(re,{pipeline:i})]}),e(Z,{pipeline:i})]}),s(O,{numColsMd:2,numColsLg:3,gapX:"gap-x-6",gapY:"gap-y-6",marginTop:"mt-6",children:[e(R,{children:s("div",{className:"tr-flex tr-flex-col tr-h-full",children:[e(w,{children:"Tasks"}),e(pe,{children:i.tasks.map(l=>e(N,{children:s(T,{children:[e(u,{children:e(j,{children:l.name})}),l.description&&e(u,{truncate:!0,children:l.description})]})},l.id))}),e("div",{style:{flexGrow:1}}),s(N,{children:[s(p,{justifyContent:"justify-start",children:[e(u,{children:"Run URL"}),e(Y,{size:"sm",color:"slate",icon:ge,tooltip:"URL to run the pipeline programmatically via an HTTP POST request"})]}),s(p,{justifyContent:"justify-end",children:[e("div",{className:"bg-slate-100 tr-border-slate-300 rounded tr-border text-slate-500 text-xs truncate px-1 mr-2",style:{maxWidth:200},title:U(t),children:U(t)}),e(be,{content:U(t)})]})]})]})}),e(Ce,{subject:"Pipeline",runs:[...a.data].reverse()}),e(ve,{runs:a.data})]}),s(O,{numCols:1,numColsSm:1,numColsMd:1,numColsLg:2,gapX:"gap-x-6",gapY:"gap-y-6",marginTop:"mt-6",children:[e(ne,{children:e(xe,{pipeline:i})}),e(ne,{children:e(we,{runs:a.data,pipelineId:t})})]})]})},ht=({trigger:n})=>{const[t,r]=f.useState(!1);return s(D,{children:[e(C,{color:"indigo",variant:"light",size:"sm",icon:Ue,onClick:()=>r(!0),children:"Show params"}),e(A,{isOpen:t,title:"Trigger params",subtitle:n.name,footer:e(C,{variant:"primary",color:"indigo",onClick:()=>{r(!1)},children:"Close"}),onClose:()=>r(!1),children:e("pre",{className:"p-3 tr-bg-slate-100 rounded-md",children:JSON.stringify(n.params,null,2)})})]})},M={id:"_manual",name:"Manual",description:"Special trigger that identifies pipelines run manually by the user"},mt=()=>{const n=Q(),t=n.pipelineId,r=n.triggerId,a=S({queryKey:["pipeline",t],queryFn:()=>J(t),initialData:{id:"",name:"",description:"",tasks:[],triggers:[]},enabled:!!t}),i=S({queryKey:["runs",r,t],queryFn:()=>fe(t,r),initialData:[],enabled:!!r}),l=de({mutationFn:()=>st(t,r)});if(i.isLoading||a.isLoading)return e("div",{children:"Loading..."});if(i.error||a.error)return e("div",{children:"An error has occurred"});const o=a.data,c=r===M.id,d=c?M:o.triggers.find(g=>g.id===r);if(!d)return e("div",{children:"Trigger not found"});const h=c?e(Z,{pipeline:o}):e(C,{size:"xs",color:"indigo",icon:ue,onClick:()=>{l.mutateAsync()},children:"Run trigger"});return s("main",{className:"bg-slate-50 p-6 sm:p-10 min-h-screen",children:[s(p,{alignItems:"items-start",children:[s(T,{children:[s(w,{children:["Trigger ",d.name]}),e(re,{pipeline:o,trigger:d})]}),h]}),s(O,{numColsMd:2,numColsLg:3,gapX:"gap-x-6",gapY:"gap-y-6",marginTop:"mt-6",children:[e(R,{children:s("div",{className:"tr-flex tr-flex-col tr-h-full",children:[e(w,{children:d.name}),e(oe,{children:d.description}),e("div",{style:{flexGrow:1}}),s(N,{children:[e(u,{children:"Schedule"}),e(u,{children:e(j,{children:d.interval})})]}),s(N,{children:[e(u,{children:"Next run"}),e(u,{children:e(j,{children:d.next_fire_time?te(d.next_fire_time):"-"})})]}),s(N,{children:[e(u,{children:"Params"}),d.params?e(ht,{trigger:d}):e(u,{children:e("em",{children:"No params"})})]}),s(N,{children:[s(p,{justifyContent:"justify-start",children:[e(u,{children:"Run URL"}),e(Y,{size:"sm",color:"slate",icon:ge,tooltip:"URL to run the trigger programmatically via an HTTP POST request"})]}),s(p,{justifyContent:"justify-end",children:[e("div",{className:"bg-slate-100 tr-border-slate-300 rounded tr-border text-slate-500 text-sm truncate px-1 mr-2",style:{maxWidth:200},title:k(t,r),children:k(t,r)}),e(be,{content:k(t,r)})]})]})]})}),e(Ce,{subject:"Trigger",runs:[...i.data].reverse()}),e(ve,{runs:i.data})]}),e(T,{marginTop:"mt-6",children:e(we,{runs:i.data,pipelineId:t,triggerId:r})})]})},pt=({logEntry:n})=>{const[t,r]=f.useState(!1);return s(p,{marginTop:"mt-1",children:[e(C,{color:"rose",variant:"secondary",size:"xs",onClick:()=>r(!0),children:"Traceback info"}),e(A,{isOpen:t,title:"Traceback info",footer:e(C,{variant:"primary",color:"indigo",onClick:()=>{r(!1)},children:"Close"}),maxWidth:"80%",onClose:()=>r(!1),children:e("div",{className:"flex flex-col",children:e("div",{style:{minWidth:350,maxWidth:"100%",overflow:"auto",flexGrow:1,maxHeight:"70vh"},className:"p-3 my-3 tr-bg-slate-100 rounded-md whitespace-pre font-mono",children:n.exc_info})})})]})},ce={DEBUG:"slate",INFO:"sky",WARNING:"amber",ERROR:"rose"},gt=({pipeline:n,runId:t})=>{const[r,a]=f.useState({levels:[],tasks:[]}),i=S({queryKey:["logs",t],queryFn:()=>rt(t),enabled:!!t,initialData:[]}),l=f.useCallback(c=>{a(d=>({...d,...c}))},[]);if(i.isLoading)return e("div",{children:"Loading..."});if(i.isError)return e("div",{children:"Error loading logs"});const o=i.data.filter(c=>(r.levels.length===0||r.levels.includes(c.level))&&(r.tasks.length===0||r.tasks.includes(c.task)));return s(D,{children:[s(O,{numColsMd:3,gapX:"gap-x-6",gapY:"gap-y-6",children:[s(T,{children:[e(u,{children:"Tasks"}),e(ie,{marginTop:"mt-1",onValueChange:c=>{l({tasks:c})},children:n.tasks.map(c=>e(se,{text:c.name,value:c.id},c.id))})]}),s(T,{children:[e(u,{children:"Log level"}),e(ie,{marginTop:"mt-1",onValueChange:c=>{l({levels:c})},children:Object.keys(ce).map(c=>e(se,{text:c,value:c},c))})]})]}),e("div",{className:"logs-table",children:s(B,{marginTop:"mt-6",children:[e(K,{children:s(_,{children:[e(x,{children:"Time"}),e(x,{children:"Level"}),e(x,{children:"Task"}),e(x,{children:"Message"})]})}),e(H,{children:o.map((c,d)=>{const h=d!==0?c.timestamp.getTime()-o[d-1].timestamp.getTime():-1;return s(_,{children:[s(b,{children:[e("span",{className:"font-mono text-xs text-slate-500",children:ct(c.timestamp)}),h>=0&&s("span",{className:"font-mono text-xs text-slate-500 ml-2",children:["+",h," ms"]})]}),e(b,{children:e(W,{text:c.level,size:"xs",color:ce[c.level]})}),e(b,{children:c.task}),s(b,{children:[e(u,{children:c.message}),c.exc_info&&e(pt,{logEntry:c})]})]},c.id)})})]})})]})},ft="modulepreload",yt=function(n){return"/"+n},le={},xt=function(t,r,a){if(!r||r.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(r.map(l=>{if(l=yt(l),l in le)return;le[l]=!0;const o=l.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(!!a)for(let g=i.length-1;g>=0;g--){const y=i[g];if(y.href===l&&(!o||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=o?"stylesheet":ft,o||(h.as="script",h.crossOrigin=""),h.href=l,document.head.appendChild(h),o)return new Promise((g,y)=>{h.addEventListener("load",g),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>t())},bt=z.lazy(()=>xt(()=>import("./HandsonTable-94ba3f3a.js"),["assets/HandsonTable-94ba3f3a.js","assets/vendor-949d89c7.js","assets/HandsonTable-a8e02e84.css"])),vt=({runId:n,taskId:t,open:r,onClose:a})=>{const i=S({queryKey:["getRunData",{runId:n,taskId:t}],queryFn:()=>nt(n,t),enabled:r});return e(D,{children:s(A,{title:t,subtitle:"View data",isOpen:r,maxWidth:"90%",minWidth:"90%",footer:e(C,{variant:"secondary",color:"indigo",onClick:()=>a(),children:"Close"}),onClose:a,children:[!i.isLoading&&!i.isError&&e(f.Suspense,{fallback:e("div",{children:"Loading..."}),children:e(bt,{data:i.data,rowHeaders:!0,colHeaders:Object.keys(i.data[0]),height:"70vh",width:"100%",licenseKey:"non-commercial-and-evaluation"})}),i.isError&&(i.error.response.status===404?e(u,{children:"The task has no data"}):s(u,{color:"rose",children:["Error fetching task data: ",i.error.message]}))]})})},Tt=({pipeline:n,run:t})=>{const[r,a]=f.useState();return s(R,{children:[e(vt,{runId:t.id,taskId:r||"",open:!!r,onClose:()=>a(void 0)}),e(w,{children:"Tasks"}),e(pe,{children:n.tasks.map(i=>s(N,{spaceX:"space-x-4",children:[e(Y,{variant:"light",icon:ye[t.status],color:ee[t.status]}),s(T,{truncate:!0,children:[e(u,{truncate:!0,children:e(j,{children:i.name})}),i.description&&e(u,{truncate:!0,children:i.description})]}),t.status==="completed"&&e(C,{variant:"light",color:"indigo",size:"xs",icon:Ve,onClick:()=>a(i.id),children:"Data"})]},i.id))})]})},wt=()=>{const n=Q(),t=n.pipelineId,r=n.triggerId,a=parseInt(n.runId),i=S({queryKey:["pipeline",t],queryFn:()=>J(t),initialData:{id:"",name:"",description:"",tasks:[],triggers:[]},enabled:!!t}),l=S({queryKey:["run",t,r,a],queryFn:()=>tt(a),enabled:!!(t&&r&&a)}),o=i.data,d=r===M.id?M:o.triggers.find(g=>g.id===r),h=l.data;return h?d?s("main",{className:"bg-slate-50 p-6 sm:p-10 min-h-screen",children:[s(w,{children:["Run #",a]}),e(re,{pipeline:o,trigger:d,run:h}),s(O,{numColsMd:3,gapX:"gap-x-6",gapY:"gap-y-6",marginTop:"mt-6",children:[e(Tt,{pipeline:o,run:h}),s(R,{children:[s(p,{alignItems:"items-start",children:[e(u,{children:"Duration"}),e(Te,{status:h.status})]}),e(p,{justifyContent:"justify-start",alignItems:"items-baseline",spaceX:"space-x-3",truncate:!0,children:s(me,{children:[(h.duration/1e3).toFixed(1),"s"]})})]})]}),e(T,{marginTop:"mt-6",children:e(R,{children:e(gt,{pipeline:o,runId:a})})})]}):e("div",{children:"Trigger not found"}):e("div",{children:"Run not found"})},Ct=Object.assign({"./pages/index.tsx":ot,"./pages/pipelines/[pipelineId]/index.tsx":ut,"./pages/pipelines/[pipelineId]/triggers/[triggerId]/index.tsx":mt,"./pages/pipelines/[pipelineId]/triggers/[triggerId]/runs/[runId]/index.tsx":wt}),Rt=Object.entries(Ct).map(([n,t])=>({path:n.slice(7).replace(/index\.tsx$/,"").split("/").map(a=>a.replace(/\[(.+)\]/,":$1")).join("/"),element:e(t,{})})),St=()=>{const n=Be(Rt);return e(Ke,{router:n})},Lt=new He({defaultOptions:{queries:{retry:!1}}});function $t(){return e(We,{client:Lt,children:e(St,{})})}ze.createRoot(document.getElementById("root")).render(e(z.StrictMode,{children:e($t,{})}));export{e as j};
